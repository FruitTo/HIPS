alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 ( msg:"SQL sp_start_job - program execution"; flow:to_server,established; content:"s|00|p|00|_|00|s|00|t|00|a|00|r|00|t|00|_|00|j|00|o|00|b|00|",fast_pattern,nocase; metadata:ruleset community; classtype:attempted-user; sid:673; rev:9; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 ( msg:"SQL sp_start_job - program execution"; flow:to_server,established; content:"s|00|p|00|_|00|s|00|t|00|a|00|r|00|t|00|_|00|j|00|o|00|b|00|",depth 32,offset 32,nocase; metadata:ruleset community; classtype:attempted-user; sid:676; rev:9; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 ( msg:"SQL sp_password password change"; flow:to_server,established; content:"s|00|p|00|_|00|p|00|a|00|s|00|s|00|w|00|o|00|r|00|d|00|",fast_pattern,nocase; metadata:ruleset community; classtype:attempted-user; sid:677; rev:10; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 ( msg:"SQL sp_delete_alert log file deletion"; flow:to_server,established; content:"s|00|p|00|_|00|d|00|e|00|l|00|e|00|t|00|e|00|_|00|a|00|l|00|e|00|",fast_pattern,nocase; metadata:ruleset community; classtype:attempted-user; sid:678; rev:10; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 ( msg:"SQL sp_adduser database user creation"; flow:to_server,established; content:"s|00|p|00|_|00|a|00|d|00|d|00|u|00|s|00|e|00|r|00|",depth 32,offset 32,nocase; metadata:ruleset community; classtype:attempted-user; sid:679; rev:9; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 ( msg:"SQL xp_cmdshell program execution"; flow:to_server,established; content:"x|00|p|00|_|00|c|00|m|00|d|00|s|00|h|00|e|00|l|00|l|00|",offset 32,nocase; metadata:ruleset community; reference:bugtraq,5309; classtype:attempted-user; sid:681; rev:10; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 ( msg:"SQL sp_password - password change"; flow:to_server,established; content:"s|00|p|00|_|00|p|00|a|00|s|00|s|00|w|00|o|00|r|00|d|00|",fast_pattern,nocase; metadata:ruleset community; classtype:attempted-user; sid:683; rev:9; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 ( msg:"SQL sp_delete_alert log file deletion"; flow:to_server,established; content:"s|00|p|00|_|00|d|00|e|00|l|00|e|00|t|00|e|00|_|00|a|00|l|00|e|00|r|00|t|00|",fast_pattern,nocase; metadata:ruleset community; classtype:attempted-user; sid:684; rev:9; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 ( msg:"SQL sp_adduser - database user creation"; flow:to_server,established; content:"s|00|p|00|_|00|a|00|d|00|d|00|u|00|s|00|e|00|r|00|",fast_pattern,nocase; metadata:ruleset community; classtype:attempted-user; sid:685; rev:9; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 ( msg:"SERVER-MSSQL xp_reg* - registry access"; flow:to_server,established; content:"x|00|p|00|_|00|r|00|e|00|g|00|",fast_pattern,nocase; metadata:ruleset community; reference:bugtraq,5205; reference:cve,2002-0642; reference:nessus,10642; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-034; classtype:attempted-user; sid:686; rev:17; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 ( msg:"SQL xp_cmdshell - program execution"; flow:to_server,established; content:"x|00|p|00|_|00|c|00|m|00|d|00|s|00|h|00|e|00|l|00|l|00|",fast_pattern,nocase; metadata:ruleset community; reference:bugtraq,5309; classtype:attempted-user; sid:687; rev:10; )
alert tcp $SQL_SERVERS 1433 -> $EXTERNAL_NET any ( msg:"SQL sa login failed"; flow:to_client,established; content:"Login failed for user 'sa'",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,4797; reference:cve,2000-1209; reference:nessus,10673; classtype:unsuccessful-user; sid:688; rev:18; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 ( msg:"SERVER-MSSQL xp_reg* registry access"; flow:to_server,established; content:"x|00|p|00|_|00|r|00|e|00|g|00|",depth 32,offset 32,nocase; metadata:ruleset community; reference:bugtraq,5205; reference:cve,2002-0642; reference:nessus,10642; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-034; classtype:attempted-user; sid:689; rev:16; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 ( msg:"INDICATOR-SHELLCODE shellcode attempt"; flow:to_server,established; content:"9 |D0 00 92 01 C2 00|R|00|U|00|9 |EC 00|"; metadata:ruleset community; classtype:shellcode-detect; sid:691; rev:9; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 ( msg:"INDICATOR-SHELLCODE shellcode attempt"; flow:to_server,established; content:"9 |D0 00 92 01 C2 00|R|00|U|00|9 |EC 00|"; metadata:ruleset community; classtype:shellcode-detect; sid:692; rev:10; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 ( msg:"INDICATOR-SHELLCODE shellcode attempt"; flow:to_server,established; content:"H|00|%|00|x|00|w|00 90 00 90 00 90 00 90 00 90 00|3|00 C0 00|P|00|h|00|.|00|"; metadata:ruleset community; classtype:shellcode-detect; sid:693; rev:9; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 ( msg:"INDICATOR-SHELLCODE shellcode attempt"; flow:to_server,established; content:"H|00|%|00|x|00|w|00 90 00 90 00 90 00 90 00 90 00|3|00 C0 00|P|00|h|00|.|00|"; metadata:ruleset community; classtype:attempted-user; sid:694; rev:10; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 ( msg:"SERVER-MSSQL xp_sprintf possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|p|00|r|00|i|00|n|00|t|00|f|00|",offset 32,nocase; metadata:ruleset community; reference:bugtraq,1204; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-060; classtype:attempted-user; sid:695; rev:14; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 ( msg:"SERVER-MSSQL xp_sprintf possible buffer overflow"; flow:to_server,established; content:"x|00|p|00|_|00|s|00|p|00|r|00|i|00|n|00|t|00|f|00|",fast_pattern,nocase; metadata:ruleset community; reference:bugtraq,1204; reference:bugtraq,3733; reference:cve,2001-0542; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-060; classtype:attempted-user; sid:704; rev:16; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 139 ( msg:"SERVER-MSSQL raiserror possible buffer overflow"; flow:to_server,established; content:"r|00|a|00|i|00|s|00|e|00|r|00|r|00|o|00|r|00|",offset 32,nocase; metadata:ruleset community; reference:bugtraq,3733; reference:cve,2001-0542; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-060; classtype:attempted-user; sid:1386; rev:15; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 ( msg:"SQL raiserror possible buffer overflow"; flow:to_server,established; content:"r|00|a|00|i|00|s|00|e|00|r|00|r|00|o|00|r|00|",fast_pattern,nocase; metadata:ruleset community; reference:bugtraq,3733; reference:cve,2001-0542; reference:nessus,11217; classtype:attempted-user; sid:1387; rev:13; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 445 ( msg:"SQL xp_cmdshell program execution 445"; flow:to_server,established; content:"x|00|p|00|_|00|c|00|m|00|d|00|s|00|h|00|e|00|l|00|l|00|",fast_pattern,nocase; metadata:ruleset community; reference:bugtraq,5309; classtype:attempted-user; sid:1759; rev:10; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 ( msg:"SERVER-MYSQL root login attempt"; flow:to_server,established; content:"|0A 00 00 01 85 04 00 00 80|root|00|",fast_pattern,nocase; metadata:ruleset community; service:mysql; classtype:protocol-command-decode; sid:1775; rev:9; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 ( msg:"SERVER-MYSQL show databases attempt"; flow:to_server,established; content:"|0F 00 00 00 03|show databases",fast_pattern,nocase; metadata:ruleset community; service:mysql; classtype:protocol-command-decode; sid:1776; rev:9; )
alert udp $EXTERNAL_NET any -> $SQL_SERVERS any ( msg:"SERVER-MSSQL probe response overflow attempt"; flow:to_server; content:"|05|",depth 1; byte_test:2,>,512,1; content:"|3B|",distance 0; isdataat:512,relative; content:!"|3B|",within 512; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,9407; reference:cve,2003-0903; reference:nessus,11990; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-003; classtype:attempted-user; sid:2329; rev:15; )
alert tcp $SQL_SERVERS 1433 -> $EXTERNAL_NET any ( msg:"SQL sa brute force failed login attempt"; flow:to_client,established,no_stream; content:"Login failed for user 'sa'",fast_pattern,nocase; detection_filter:track by_src,count 5,seconds 2; metadata:ruleset community; reference:bugtraq,4797; reference:cve,2000-1209; reference:nessus,10673; reference:url,attack.mitre.org/techniques/T1110; classtype:unsuccessful-user; sid:3152; rev:11; )
alert tcp $SQL_SERVERS 1433 -> $EXTERNAL_NET any ( msg:"SQL sa brute force failed login unicode attempt"; flow:to_client,established,no_stream; content:"L|00|o|00|g|00|i|00|n|00| |00|f|00|a|00|i|00|l|00|e|00|d|00| |00|f|00|o|00|r|00| |00|u|00|s|00|e|00|r|00| |00|'|00|s|00|a|00|'|00|"; detection_filter:track by_src,count 5,seconds 2; metadata:ruleset community; reference:bugtraq,4797; reference:cve,2000-1209; reference:nessus,10673; reference:url,attack.mitre.org/techniques/T1110; classtype:unsuccessful-user; sid:3273; rev:10; )
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 ( msg:"SERVER-MYSQL 4.0 root login attempt"; flow:to_server,established; content:"|01|",depth 1,offset 3; content:"root|00|",within 5,distance 5,nocase; metadata:ruleset community; service:mysql; classtype:protocol-command-decode; sid:3456; rev:9; )