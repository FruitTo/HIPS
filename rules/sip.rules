alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP inbound INVITE message"; flow:to_server; content:"INVITE",fast_pattern,nocase; sip_method:invite; metadata:policy max-detect-ips drop,ruleset community; service:sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:11968; rev:8; )
alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP Possible SIP OPTIONS service information gathering attempt"; flow:to_server; sip_method:options; content:"SIP/2.0",fast_pattern,nocase; detection_filter:track by_src,count 100,seconds 25; metadata:policy max-detect-ips drop,ruleset community; service:sip; reference:url,blog.sipvicious.org/2008/02/detecting-sip-attacks-with-snort.html; classtype:attempted-recon; sid:27899; rev:4; )
alert udp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any ( msg:"PROTOCOL-VOIP Excessive number of SIP 4xx responses potential user or password guessing attempt"; flow:to_client; sip_stat_code:4; content:"SIP/2.0",fast_pattern,nocase; detection_filter:track by_src,count 100,seconds 25; metadata:policy max-detect-ips drop,ruleset community; service:sip; reference:url,blog.sipvicious.org/2008/02/detecting-sip-attacks-with-snort.html; classtype:attempted-recon; sid:27900; rev:4; )
alert udp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any ( msg:"PROTOCOL-VOIP Ghost call attack attempt"; flow:to_client; sip_stat_code:180; content:"SIP/2.0",fast_pattern,nocase; detection_filter:track by_src,count 100,seconds 25; metadata:policy max-detect-ips drop,ruleset community; service:sip; reference:url,blog.sipvicious.org/2008/02/detecting-sip-attacks-with-snort.html; classtype:attempted-recon; sid:27901; rev:4; )
alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP Possible SIP OPTIONS service information gathering attempt"; flow:to_server,established,only_stream; sip_method:options; content:"SIP/2.0",fast_pattern,nocase; detection_filter:track by_src,count 100,seconds 25; metadata:policy max-detect-ips drop,ruleset community; service:sip; reference:url,blog.sipvicious.org/2008/02/detecting-sip-attacks-with-snort.html; classtype:attempted-recon; sid:27902; rev:3; )
alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any ( msg:"PROTOCOL-VOIP Ghost call attack attempt"; flow:to_client,established,only_stream; sip_stat_code:180; content:"SIP/2.0",fast_pattern,nocase; detection_filter:track by_src,count 100,seconds 25; metadata:policy max-detect-ips drop,ruleset community; service:sip; reference:url,blog.sipvicious.org/2008/02/detecting-sip-attacks-with-snort.html; classtype:attempted-recon; sid:27903; rev:3; )
alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any ( msg:"PROTOCOL-VOIP Excessive number of SIP 4xx responses potential user or password guessing attempt"; flow:to_client,established,only_stream; sip_stat_code:4; content:"SIP/2.0",fast_pattern,nocase; detection_filter:track by_src,count 100,seconds 25; metadata:policy max-detect-ips drop,ruleset community; service:sip; reference:url,blog.sipvicious.org/2008/02/detecting-sip-attacks-with-snort.html; classtype:attempted-recon; sid:27904; rev:3; )
alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"OS-OTHER Bash environment variable injection attempt"; flow:stateless; sip_header; content:"() {"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:sip; reference:cve,2014-6271; reference:cve,2014-6277; reference:cve,2014-6278; reference:cve,2014-7169; classtype:attempted-admin; sid:32041; rev:4; )
alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"OS-OTHER Bash environment variable injection attempt"; flow:to_server,established; sip_header; content:"() {"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:sip; reference:cve,2014-6271; reference:cve,2014-6277; reference:cve,2014-6278; reference:cve,2014-7169; classtype:attempted-admin; sid:32042; rev:4; )