alert tcp $HOME_NET 2589 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR - Dagger_1.4.0"; flow:to_client,established; content:"2|00 00 00 06 00 00 00|Drives|24 00|",depth 16; metadata:ruleset community; classtype:misc-activity; sid:105; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7597 ( msg:"MALWARE-BACKDOOR QAZ Worm Client Login access"; flow:to_server,established; content:"qazwsx.hsq"; metadata:ruleset community; classtype:misc-activity; sid:108; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 12345:12346 ( msg:"MALWARE-BACKDOOR netbus getinfo"; flow:to_server,established; content:"GetInfo|0D|"; metadata:ruleset community; classtype:trojan-activity; sid:110; rev:10; )
alert tcp $HOME_NET 20034 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR NetBus Pro 2.0 connection established"; flow:to_client,established; flowbits:isset,backdoor.netbus_2.connect; content:"BN|10 00 02 00|",depth 6; content:"|05 00|",depth 2,offset 8; metadata:ruleset community; classtype:trojan-activity; sid:115; rev:15; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Infector.1.x"; flow:to_client,established; content:"WHATISIT",depth 9; metadata:impact_flag red,ruleset community; reference:nessus,11157; classtype:misc-activity; sid:117; rev:17; )
alert tcp $HOME_NET 666 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR SatansBackdoor.2.0.Beta"; flow:to_client,established; content:"Remote|3A| ",depth 11,nocase; content:"You are connected to me.|0D 0A|Remote|3A| Ready for commands",distance 0,nocase; metadata:ruleset community; reference:url,www.megasecurity.org/trojans/s/satanzbackdoor/SBD2.0b.html; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=5260; classtype:trojan-activity; sid:118; rev:12; )
alert tcp $HOME_NET 6789 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Doly 2.0 access"; flow:to_client,established; content:"Wtzup Use",depth 32; metadata:ruleset community; classtype:misc-activity; sid:119; rev:11; )
alert tcp $EXTERNAL_NET 1000:1300 -> $HOME_NET 146 ( msg:"MALWARE-BACKDOOR Infector 1.6 Client to Server Connection Request"; flow:to_server,established; content:"FC "; metadata:ruleset community; reference:nessus,11157; classtype:misc-activity; sid:121; rev:14; )
alert tcp $HOME_NET 31785 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR HackAttack 1.20 Connect"; flow:to_client,established; content:"host"; metadata:ruleset community; classtype:misc-activity; sid:141; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP ADMw0rm ftp login attempt"; flow:to_server,established; content:"USER",nocase; content:"w0rm",distance 1,nocase; pcre:"/^USER\s+w0rm/ims"; metadata:ruleset community; service:ftp; classtype:suspicious-login; sid:144; rev:16; )
alert tcp $HOME_NET 30100:30102 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR NetSphere access"; flow:to_client,established; content:"NetSphere"; metadata:ruleset community; classtype:trojan-activity; sid:146; rev:13; )
alert tcp $HOME_NET 6969 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR GateCrasher"; flow:to_client,established; content:"GateCrasher",depth 11,nocase; content:"Server",distance 0,nocase; content:"On-Line...",distance 0,nocase; pcre:"/^GateCrasher\s+v\d+\x2E\d+\x2C\s+Server\s+On-Line\x2E\x2E\x2E/ims"; metadata:policy max-detect-ips drop,ruleset community; reference:url,www.spywareguide.com/product_show.php?id=973; classtype:trojan-activity; sid:147; rev:12; )
alert tcp $HOME_NET 5401:5402 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR BackConstruction 2.1 Connection"; flow:to_client,established; content:"c|3A 5C|"; metadata:ruleset community; classtype:misc-activity; sid:152; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 666 ( msg:"MALWARE-BACKDOOR BackConstruction 2.1 Client FTP Open Request"; flow:to_server,established; content:"FTPON"; metadata:ruleset community; classtype:misc-activity; sid:157; rev:9; )
alert tcp $HOME_NET 666 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR BackConstruction 2.1 Server FTP Open Reply"; flow:to_client,established; content:"FTP Port open"; metadata:ruleset community; classtype:misc-activity; sid:158; rev:10; )
alert udp $EXTERNAL_NET 3344 -> $HOME_NET 3345 ( msg:"MALWARE-BACKDOOR Matrix 2.0 Client connect"; flow:to_server; content:"activate"; metadata:ruleset community; classtype:misc-activity; sid:161; rev:10; )
alert udp $EXTERNAL_NET 3345 -> $HOME_NET 3344 ( msg:"MALWARE-BACKDOOR Matrix 2.0 Server access"; flow:to_server; content:"logged in"; metadata:ruleset community; classtype:misc-activity; sid:162; rev:10; )
alert tcp $HOME_NET 5714 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR WinCrash 1.0 Server Active"; flow:stateless; flags:AS,12; content:"|B4 B4|"; metadata:ruleset community; classtype:misc-activity; sid:163; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"MALWARE-BACKDOOR CDK"; flow:to_server,established; content:"ypi0ca",depth 15,nocase; metadata:ruleset community; classtype:misc-activity; sid:185; rev:10; )
alert udp $HOME_NET 2140 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR DeepThroat 3.1 Server Response"; flow:to_client; content:"Ahhhh My Mouth Is Open"; metadata:ruleset community; reference:nessus,10053; classtype:trojan-activity; sid:195; rev:15; )
alert tcp $HOME_NET 555 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR PhaseZero Server Active on Network"; flow:to_client,established; content:"phAse zero server",depth 17,nocase; metadata:policy max-detect-ips drop,ruleset community; reference:url,www.megasecurity.org/trojans/p/phasezero/PhaseZero1.0b.html; reference:url,www3.ca.com/securityadvisor/pest/pest.aspx?id=4539; classtype:trojan-activity; sid:208; rev:13; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP TFN Probe"; icmp_id:678; itype:8; content:"1234",fast_pattern,nocase; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:221; rev:12; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP tfn2k icmp possible communication"; icmp_id:0; itype:0; content:"AAAAAAAAAA",fast_pattern,nocase; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:222; rev:10; )
alert udp $EXTERNAL_NET any -> $HOME_NET [31335,35555] ( msg:"MALWARE-OTHER Trin00 Daemon to Master PONG message detected"; flow:to_server; content:"PONG",fast_pattern,nocase; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:223; rev:13; )
alert icmp 3.3.3.3/32 any -> $EXTERNAL_NET any ( msg:"PROTOCOL-ICMP Stacheldraht server spoof"; icmp_id:666; itype:0; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:224; rev:10; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PROTOCOL-ICMP Stacheldraht gag server response"; icmp_id:669; itype:0; content:"sicken"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:225; rev:13; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PROTOCOL-ICMP Stacheldraht server response"; icmp_id:667; itype:0; content:"ficken"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:226; rev:13; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Stacheldraht client spoofworks"; icmp_id:1000; itype:0; content:"spoofworks"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:227; rev:13; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP TFN client command BE"; icmp_id:456; icmp_seq:0; itype:0; pcre:"/^[0-9]{1,5}\x00/"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:228; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Stacheldraht client check skillz"; icmp_id:666; itype:0; content:"skillz"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:229; rev:12; )
alert tcp $HOME_NET 20432 -> $EXTERNAL_NET any ( msg:"MALWARE-OTHER shaft client login to handler"; flow:to_client,established; content:"login|3A|",fast_pattern,nocase; metadata:ruleset community; reference:cve,2000-0138; reference:url,security.royans.net/info/posts/bugtraq_ddos3.shtml; classtype:attempted-dos; sid:230; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET 31335 ( msg:"MALWARE-OTHER Trin00 Daemon to Master message detected"; flow:to_server; content:"l44",fast_pattern,nocase; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:231; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET 31335 ( msg:"MALWARE-OTHER Trin00 Daemon to Master *HELLO* message detected"; flow:to_server; content:"*HELLO*"; metadata:ruleset community; reference:cve,2000-0138; reference:url,www.sans.org/newlook/resources/IDFAQ/trinoo.htm; classtype:attempted-dos; sid:232; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 27665 ( msg:"MALWARE-OTHER Trin00 Attacker to Master default startup password"; flow:to_server,established; content:"betaalmostdone"; metadata:ruleset community; reference:cve,2000-0138; reference:url,attack.mitre.org/techniques/T1078; classtype:attempted-dos; sid:233; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 27665 ( msg:"MALWARE-OTHER Trin00 Attacker to Master default password"; flow:to_server,established; content:"gOrave"; metadata:ruleset community; reference:cve,2000-0138; reference:url,attack.mitre.org/techniques/T1078; classtype:attempted-dos; sid:234; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 27665 ( msg:"MALWARE-OTHER Trin00 Attacker to Master default mdie password"; flow:to_server,established; content:"killme"; metadata:ruleset community; reference:cve,2000-0138; reference:url,attack.mitre.org/techniques/T1078; classtype:attempted-dos; sid:235; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Stacheldraht client check gag"; icmp_id:668; itype:0; content:"gesundheit!"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:236; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET 27444 ( msg:"MALWARE-OTHER Trin00 Master to Daemon default password attempt"; flow:to_server; content:"l44adsl"; metadata:ruleset community; reference:cve,2000-0138; reference:url,attack.mitre.org/techniques/T1078; classtype:attempted-dos; sid:237; rev:11; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PROTOCOL-ICMP TFN server response"; icmp_id:123; itype:0; content:"shell bound"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:238; rev:14; )
alert udp $EXTERNAL_NET any -> $HOME_NET 18753 ( msg:"MALWARE-OTHER shaft handler to agent"; flow:to_server; content:"alive tijgu"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:239; rev:10; )
alert udp $EXTERNAL_NET any -> $HOME_NET 20433 ( msg:"MALWARE-OTHER shaft agent to handler"; flow:to_server; content:"alive"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:240; rev:10; )
alert udp $EXTERNAL_NET any -> $HOME_NET 6838 ( msg:"MALWARE-OTHER mstream agent to handler"; flow:to_server; content:"newserver"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:243; rev:8; )
alert udp $EXTERNAL_NET any -> $HOME_NET 10498 ( msg:"MALWARE-OTHER mstream handler to agent"; flow:to_server; content:"stream/"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:244; rev:8; )
alert udp $EXTERNAL_NET any -> $HOME_NET 10498 ( msg:"MALWARE-OTHER mstream handler ping to agent"; flow:to_server; content:"ping"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:245; rev:8; )
alert udp $EXTERNAL_NET any -> $HOME_NET 10498 ( msg:"MALWARE-OTHER mstream agent pong to handler"; flow:to_server; content:"pong"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:246; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 12754 ( msg:"MALWARE-OTHER mstream client to handler"; flow:to_server,established; content:">"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:247; rev:8; )
alert tcp $HOME_NET 12754 -> $EXTERNAL_NET any ( msg:"MALWARE-OTHER mstream handler to client"; flow:to_client,established; content:">"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:248; rev:8; )
alert tcp $HOME_NET 15104 -> $EXTERNAL_NET any ( msg:"MALWARE-OTHER mstream handler to client"; flow:to_client,established; content:">"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:250; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP - TFN client command LE"; icmp_id:51201; icmp_seq:0; itype:0; pcre:"/^[0-9]{1,5}\x00/"; metadata:ruleset community; reference:cve,2000-0138; classtype:attempted-dos; sid:251; rev:11; )
alert udp $EXTERNAL_NET 53 -> $HOME_NET any ( msg:"PROTOCOL-DNS SPOOF query response PTR with TTL of 1 min. and no authority"; flow:to_client; content:"|85 80 00 01 00 01 00 00 00 00|"; content:"|C0 0C 00 0C 00 01 00 00 00|<|00 0F|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:dns; classtype:bad-unknown; sid:253; rev:15; )
alert udp $EXTERNAL_NET 53 -> $HOME_NET any ( msg:"PROTOCOL-DNS SPOOF query response with TTL of 1 min. and no authority"; flow:to_client; content:"|81 80|",depth 4,offset 2,fast_pattern; byte_test:2,>,0,0,relative,big; byte_test:2,>,0,2,relative,big; content:"|00 00 00 00|",within 4,distance 4; content:"|C0 0C 00 01 00 01|",distance 0; byte_test:4,<,61,0,relative,big; byte_test:4,>,0,0,relative,big; metadata:ruleset community; service:dns; classtype:bad-unknown; gid:1; sid:254; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS dns zone transfer via TCP detected"; flow:to_server,established; content:"|00 01 00 00 00 00 00|",depth 8,offset 6; byte_test:1,!&,0xF8,4; content:"|00 00 FC 00 01|",fast_pattern; isdataat:!1,relative; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:cve,1999-0532; reference:nessus,10595; classtype:attempted-recon; sid:255; rev:24; )
alert udp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS named authors attempt"; flow:to_server; content:"|07|authors",offset 12,nocase; content:"|04|bind|00|",offset 12,nocase; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:nessus,10728; classtype:attempted-recon; sid:256; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS named version attempt"; flow:to_server,established; content:"|07|version",offset 12,nocase; content:"|04|bind|00|",offset 12,nocase; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:nessus,10028; classtype:attempted-recon; sid:257; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"SERVER-OTHER Bind Buffer Overflow via NXT records"; flow:to_server,established; content:"../../../",fast_pattern,nocase; metadata:ruleset community; service:dns; reference:bugtraq,788; reference:cve,1999-0833; classtype:attempted-admin; sid:258; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"SERVER-OTHER Bind Buffer Overflow via NXT records named overflow ADM"; flow:to_server,established; content:"thisissometempspaceforthesockinaddrinyeahyeahiknowthisislamebutanywaywhocareshorizongotitworkingsoalliscool",fast_pattern,nocase; metadata:ruleset community; service:dns; reference:bugtraq,788; reference:cve,1999-0833; classtype:attempted-admin; sid:259; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"SERVER-OTHER Bind Buffer Overflow via NXT records named overflow ADMROCKS"; flow:to_server,established; content:"ADMROCKS"; metadata:ruleset community; service:dns; reference:bugtraq,788; reference:cve,1999-0833; reference:url,www.cert.org/advisories/CA-1999-14.html; classtype:attempted-admin; sid:260; rev:19; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"SERVER-OTHER Bind named overflow attempt"; flow:to_server,established; content:"|CD 80 E8 D7 FF FF FF|/bin/sh",fast_pattern,nocase; metadata:ruleset community; service:dns; reference:url,www.cert.org/advisories/CA-1998-05.html; classtype:attempted-admin; sid:261; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"OS-LINUX x86 Linux overflow attempt"; flow:to_server,established; content:"1|C0 B0|?1|DB B3 FF|1|C9 CD 80|1|C0|",fast_pattern,nocase; metadata:ruleset community; service:dns; classtype:attempted-admin; sid:262; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"OS-LINUX x86 Linux overflow attempt"; flow:to_server,established; content:"1|C0 B0 02 CD 80 85 C0|uL|EB|L^|B0|"; metadata:ruleset community; service:dns; classtype:attempted-admin; sid:264; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"OS-LINUX x86 Linux overflow attempt ADMv2"; flow:to_server,established; content:"|89 F7 29 C7 89 F3 89 F9 89 F2 AC|<|FE|",fast_pattern,nocase; metadata:ruleset community; service:dns; classtype:attempted-admin; sid:265; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"OS-OTHER x86 FreeBSD overflow attempt"; flow:to_server,established; content:"|EB|n^|C6 06 9A|1|C9 89|N|01 C6|F|05|"; metadata:ruleset community; service:dns; classtype:attempted-admin; sid:266; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"OS-SOLARIS EXPLOIT sparc overflow attempt"; flow:to_server,established; content:"|90 1A C0 0F 90 02| |08 92 02| |0F D0 23 BF F8|",fast_pattern,nocase; metadata:ruleset community; service:dns; classtype:attempted-admin; sid:267; rev:13; )
alert udp any 19 <> any 7 ( msg:"SERVER-OTHER UDP echo+chargen bomb"; flow:to_server; metadata:policy max-detect-ips drop,ruleset community; reference:cve,1999-0103; reference:cve,1999-0635; classtype:attempted-dos; sid:271; rev:12; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"OS-WINDOWS Microsoft WIndows IGMP dos attack"; fragbits:M+; ip_proto:2; metadata:ruleset community; reference:bugtraq,514; reference:cve,1999-0918; reference:url,technet.microsoft.com/en-us/security/bulletin/MS99-034; classtype:attempted-dos; sid:272; rev:16; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP ath"; itype:8; content:"+++ath",fast_pattern,nocase; metadata:ruleset community; reference:cve,1999-1228; classtype:attempted-dos; sid:274; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7070 ( msg:"SERVER-OTHER RealNetworks Audio Server denial of service attempt"; flow:to_server,established; content:"|FF F4 FF FD 06|",fast_pattern,nocase; metadata:ruleset community; reference:cve,1999-0271; reference:nessus,10183; classtype:attempted-dos; sid:276; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7070 ( msg:"SERVER-OTHER RealNetworks Server template.html"; flow:to_server,established; content:"/viewsource/template.html?",fast_pattern,nocase; metadata:ruleset community; reference:bugtraq,1288; reference:cve,2000-0474; reference:nessus,10461; classtype:attempted-dos; sid:277; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 ( msg:"SERVER-OTHER RealNetworks Server template.html"; flow:to_server,established; content:"/viewsource/template.html?",fast_pattern,nocase; metadata:ruleset community; reference:bugtraq,1288; reference:cve,2000-0474; classtype:attempted-dos; sid:278; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET 161 ( msg:"SERVER-OTHER Bay/Nortel Nautica Marlin"; flow:to_server; dsize:0; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,1009; reference:cve,2000-0221; classtype:attempted-dos; sid:279; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET 9 ( msg:"SERVER-OTHER Ascend Route"; flow:to_server; content:"NAMENAME",depth 50,offset 25; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,714; reference:cve,1999-0060; classtype:attempted-dos; sid:281; rev:13; )
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any ( msg:"BROWSER-OTHER Netscape 4.7 client overflow"; flow:to_client,established; content:"3|C9 B1 10|?|E9 06|Q<|FA|G3|C0|P|F7 D0|P"; metadata:ruleset community; reference:bugtraq,822; reference:cve,1999-1189; reference:cve,2000-1187; classtype:attempted-user; sid:283; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP EXPLOIT x86 BSD overflow"; flow:to_server,established; content:"^|0E|1|C0 B0 3B 8D|~|0E 89 FA 89 F9|",fast_pattern,nocase; metadata:ruleset community; service:pop3; reference:bugtraq,133; reference:cve,1999-0006; reference:nessus,10196; classtype:attempted-admin; sid:286; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP EXPLOIT x86 BSD overflow"; flow:to_server,established; content:"h]^|FF D5 FF D4 FF F5 8B F5 90|f1",fast_pattern,nocase; metadata:ruleset community; service:pop3; classtype:attempted-admin; sid:287; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP EXPLOIT x86 Linux overflow"; flow:to_server,established; content:"|D8|@|CD 80 E8 D9 FF FF FF|/bin/sh",fast_pattern,nocase; metadata:ruleset community; service:pop3; classtype:attempted-admin; sid:288; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP EXPLOIT x86 SCO overflow"; flow:to_server,established; content:"V|0E|1|C0 B0 3B 8D|~|12 89 F9 89 F9|",fast_pattern,nocase; metadata:ruleset community; service:pop3; reference:bugtraq,133; reference:bugtraq,156; reference:cve,1999-0006; classtype:attempted-admin; sid:289; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP EXPLOIT qpopper overflow"; flow:to_server,established; content:"|E8 D9 FF FF FF|/bin/sh",fast_pattern,nocase; metadata:ruleset community; service:pop3; reference:bugtraq,830; reference:cve,1999-0822; reference:nessus,10184; classtype:attempted-admin; sid:290; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"OS-LINUX x86 Linux samba overflow"; flow:to_server,established; content:"|EB|/_|EB|J^|89 FB 89|>|89 F2|"; metadata:ruleset community; reference:bugtraq,1816; reference:bugtraq,536; reference:cve,1999-0182; reference:cve,1999-0811; classtype:attempted-admin; sid:292; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 2766 ( msg:"OS-SOLARIS Oracle Solaris npls x86 overflow"; flow:to_server,established; content:"|EB 23|^3|C0 88|F|FA 89|F|F5 89|6"; metadata:ruleset community; reference:bugtraq,2319; reference:cve,1999-1588; classtype:attempted-admin; sid:300; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 515 ( msg:"SERVER-OTHER LPRng overflow"; flow:to_server,established; content:"C|07 89|[|08 8D|K|08 89|C|0C B0 0B CD 80|1|C0 FE C0 CD 80 E8 94 FF FF FF|/bin/sh|0A|"; metadata:ruleset community; reference:bugtraq,1712; reference:cve,2000-0917; classtype:attempted-admin; sid:301; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 515 ( msg:"OS-LINUX Redhat 7.0 lprd overflow"; flow:to_server,established; content:"XXXX%.172u%300|24|n"; metadata:ruleset community; reference:bugtraq,1712; reference:cve,2000-0917; classtype:attempted-admin; sid:302; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"SERVER-OTHER Bind Buffer Overflow named tsig overflow attempt"; flow:to_server,established; content:"|AB CD 09 80 00 00 00 01 00 00 00 00 00 00 01 00 01|    |02|a"; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:bugtraq,2302; reference:cve,2001-0010; reference:nessus,10605; classtype:attempted-admin; sid:303; rev:24; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6373 ( msg:"SERVER-OTHER SCO calserver overflow"; flow:to_server,established; content:"|EB 7F|]U|FE|M|98 FE|M|9B|"; metadata:ruleset community; reference:bugtraq,2353; reference:cve,2000-0306; classtype:attempted-admin; sid:304; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 ( msg:"SERVER-OTHER delegate proxy overflow"; flow:to_server,established; isdataat:1000; content:"whois|3A|//",nocase; metadata:ruleset community; reference:bugtraq,808; reference:cve,2000-0165; classtype:attempted-admin; sid:305; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9090 ( msg:"SERVER-OTHER VQServer admin"; flow:to_server,established; content:"GET / HTTP/1.1",nocase; metadata:ruleset community; reference:bugtraq,1610; reference:cve,2000-0766; reference:nessus,10354; reference:url,www.vqsoft.com/vq/server/docs/other/control.html; classtype:attempted-admin; sid:306; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6666:7000 ( msg:"SERVER-OTHER CHAT IRC topic overflow"; flow:to_client,established; content:"|EB|K[S2|E4 83 C3 0B|K|88 23 B8|Pw"; metadata:ruleset community; reference:bugtraq,573; reference:cve,1999-0672; classtype:attempted-user; sid:307; rev:12; )
alert tcp $EXTERNAL_NET 21 -> $HOME_NET any ( msg:"SERVER-OTHER NextFTP client overflow"; flow:to_client,established; content:"|B4| |B4|!|8B CC 83 E9 04 8B 19|3|C9|f|B9 10|"; metadata:ruleset community; service:ftp; reference:bugtraq,572; reference:cve,1999-0671; classtype:attempted-user; sid:308; rev:14; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 ( msg:"BROWSER-OTHER Netscape 4.7 unsucessful overflow"; flow:to_server,established; content:"3|C9 B1 10|?|E9 06|Q<|FA|G3|C0|P|F7 D0|P"; metadata:ruleset community; reference:bugtraq,822; reference:cve,1999-1189; reference:cve,2000-1187; classtype:unsuccessful-user; sid:311; rev:15; )
alert udp $EXTERNAL_NET any -> $HOME_NET 518 ( msg:"OS-LINUX ntalkd x86 Linux overflow"; flow:to_server; content:"|01 03 00 00 00 00 00 01 00 02 02 E8|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,210; classtype:attempted-admin; sid:313; rev:10; )
alert udp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"SERVER-OTHER Bind Buffer Overflow named tsig overflow attempt"; flow:to_server; content:"|80 00 07 00 00 00 00 00 01|?|00 01 02|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:bugtraq,2302; reference:cve,2001-0010; classtype:attempted-admin; sid:314; rev:23; )
alert udp $EXTERNAL_NET any -> $HOME_NET 635 ( msg:"OS-LINUX x86 Linux mountd overflow"; flow:to_server; content:"^|B0 02 89 06 FE C8 89|F|04 B0 06 89|F"; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,121; reference:cve,1999-0002; classtype:attempted-admin; sid:315; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET 635 ( msg:"OS-LINUX x86 Linux mountd overflow"; flow:to_server; content:"|EB|V^VVV1|D2 88|V|0B 88|V|1E|"; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,121; reference:cve,1999-0002; classtype:attempted-admin; sid:316; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET 635 ( msg:"OS-LINUX x86 Linux mountd overflow"; flow:to_server; content:"|EB|@^1|C0|@|89|F|04 89 C3|@|89 06|"; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,121; reference:cve,1999-0002; classtype:attempted-admin; sid:317; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"PROTOCOL-FINGER cmd_rootsh backdoor attempt"; flow:to_server,established; content:"cmd_rootsh"; metadata:ruleset community; reference:nessus,10070; reference:url,www.sans.org/y2k/TFN_toolkit.htm; reference:url,www.sans.org/y2k/fingerd.htm; classtype:attempted-admin; sid:320; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"PROTOCOL-FINGER account enumeration attempt"; flow:to_server,established; content:"a b c d e f",nocase; metadata:ruleset community; reference:nessus,10788; classtype:attempted-recon; sid:321; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"PROTOCOL-FINGER search query"; flow:to_server,established; content:"search"; metadata:ruleset community; reference:cve,1999-0259; classtype:attempted-recon; sid:322; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"PROTOCOL-FINGER root query"; flow:to_server,established; content:"root"; metadata:ruleset community; classtype:attempted-recon; sid:323; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"PROTOCOL-FINGER null request"; flow:to_server,established; content:"|00|"; metadata:ruleset community; reference:cve,1999-0612; classtype:attempted-recon; sid:324; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"PROTOCOL-FINGER remote command execution attempt"; flow:to_server,established; content:"|3B|"; metadata:ruleset community; reference:bugtraq,974; reference:cve,1999-0150; classtype:attempted-user; sid:326; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"PROTOCOL-FINGER remote command pipe execution attempt"; flow:to_server,established; content:"|7C|"; metadata:ruleset community; reference:bugtraq,2220; reference:cve,1999-0152; classtype:attempted-user; sid:327; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"PROTOCOL-FINGER bomb attempt"; flow:to_server,established; content:"@@"; metadata:ruleset community; reference:cve,1999-0106; classtype:attempted-dos; sid:328; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"PROTOCOL-FINGER redirection attempt"; flow:to_server,established; content:"@"; metadata:ruleset community; reference:cve,1999-0105; reference:nessus,10073; classtype:attempted-recon; sid:330; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"PROTOCOL-FINGER cybercop query"; flow:to_server,established; content:"|0A|     ",depth 10; metadata:ruleset community; reference:cve,1999-0612; classtype:attempted-recon; sid:331; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"PROTOCOL-FINGER 0 query"; flow:to_server,established; content:"0"; metadata:ruleset community; reference:cve,1999-0197; reference:nessus,10069; classtype:attempted-recon; sid:332; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"PROTOCOL-FINGER . query"; flow:to_server,established; content:"."; metadata:ruleset community; reference:cve,1999-0198; reference:nessus,10072; classtype:attempted-recon; sid:333; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP .forward"; flow:to_server,established; content:".forward"; metadata:ruleset community; service:ftp; classtype:suspicious-filename-detect; sid:334; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP .rhosts"; flow:to_server,established; content:".rhosts"; metadata:policy max-detect-ips drop,ruleset community; service:ftp; classtype:suspicious-filename-detect; sid:335; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP CWD ~root attempt"; flow:to_server,established; content:"CWD",nocase; content:"~root",distance 1,nocase; pcre:"/^CWD\s+~root/ims"; metadata:ruleset community; service:ftp; reference:cve,1999-0082; classtype:bad-unknown; sid:336; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP CEL overflow attempt"; flow:to_server,established; content:"CEL",nocase; isdataat:100,relative; pcre:"/^CEL(?!\n)\s[^\n]{100}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,679; reference:cve,1999-0789; reference:nessus,10009; classtype:attempted-admin; sid:337; rev:21; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP adm scan"; flow:to_server,established; content:"PASS ddd@|0A|",fast_pattern,nocase; metadata:ruleset community; service:ftp; classtype:suspicious-login; sid:353; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP iss scan"; flow:to_server,established; content:"pass -iss@iss",fast_pattern,nocase; metadata:ruleset community; service:ftp; classtype:suspicious-login; sid:354; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP pass wh00t"; flow:to_server,established; content:"pass wh00t",fast_pattern,nocase; metadata:ruleset community; service:ftp; classtype:suspicious-login; sid:355; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP passwd retrieval attempt"; flow:to_server,established; content:"RETR",nocase; content:"passwd"; metadata:ruleset community; service:ftp; classtype:suspicious-filename-detect; sid:356; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP piss scan"; flow:to_server,established; content:"pass -cklaus",fast_pattern,nocase; metadata:ruleset community; service:ftp; reference:url,www.mines.edu/fs_home/dlarue/cc/baby-doe.html; classtype:suspicious-login; sid:357; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP saint scan"; flow:to_server,established; content:"pass -saint",fast_pattern,nocase; metadata:ruleset community; service:ftp; classtype:suspicious-login; sid:358; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP satan scan"; flow:to_server,established; content:"pass -satan",fast_pattern,nocase; metadata:ruleset community; service:ftp; classtype:suspicious-login; sid:359; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP serv-u directory traversal"; flow:to_server,established; content:".%20.",fast_pattern,nocase; metadata:ruleset community; service:ftp; reference:bugtraq,2052; reference:cve,2001-0054; reference:nessus,10565; classtype:bad-unknown; sid:360; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP SITE EXEC attempt"; flow:to_server,established; content:"SITE",nocase; content:"EXEC",distance 0,nocase; pcre:"/^SITE\s+EXEC/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,2241; reference:cve,1999-0080; reference:cve,1999-0955; classtype:bad-unknown; sid:361; rev:22; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP tar parameters"; flow:to_server,established; content:" --use-compress-program ",fast_pattern,nocase; metadata:ruleset community; service:ftp; reference:bugtraq,2240; reference:cve,1999-0202; reference:cve,1999-0997; classtype:bad-unknown; sid:362; rev:20; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP IRDP router advertisement"; itype:9; metadata:ruleset community; reference:bugtraq,578; reference:cve,1999-0875; classtype:misc-activity; sid:363; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP IRDP router selection"; itype:10; metadata:ruleset community; reference:bugtraq,578; reference:cve,1999-0875; classtype:misc-activity; sid:364; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING undefined code"; icode:>0; itype:8; metadata:ruleset community; classtype:misc-activity; sid:365; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING Unix"; itype:8; content:"|10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F|",depth 32; metadata:ruleset community; classtype:misc-activity; sid:366; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING BSDtype"; itype:8; content:"|08 09 0A 0B 0C 0D 0E 0F 10 11 12 13 14 15 16 17|",depth 32; metadata:ruleset community; classtype:misc-activity; sid:368; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING BayRS Router"; itype:8; content:"|01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F|",depth 32; metadata:ruleset community; classtype:misc-activity; sid:369; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING BeOS4.x"; itype:8; content:"|00 00 00 00 00 00 00 00 00 00 00 00 08 09 0A 0B|",depth 32; metadata:ruleset community; classtype:misc-activity; sid:370; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING Cisco Type.x"; itype:8; content:"|AB CD AB CD AB CD AB CD AB CD AB CD AB CD AB CD|",depth 32; metadata:ruleset community; classtype:misc-activity; sid:371; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING Delphi-Piette Windows"; itype:8; content:"Pinging from Del",depth 32; metadata:ruleset community; classtype:misc-activity; sid:372; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING Flowpoint2200 or Network Management Software"; itype:8; content:"|01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 10|",depth 32; metadata:ruleset community; classtype:misc-activity; sid:373; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING IP NetMonitor Macintosh"; itype:8; content:"|A9| Sustainable So",depth 32; metadata:ruleset community; classtype:misc-activity; sid:374; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING LINUX/*BSD"; dsize:8; id:13170; itype:8; metadata:ruleset community; classtype:misc-activity; sid:375; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING Microsoft Windows"; itype:8; content:"0123456789abcdefghijklmnop",depth 32; metadata:ruleset community; classtype:misc-activity; sid:376; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING Network Toolbox 3 Windows"; itype:8; content:"================",depth 32; metadata:ruleset community; classtype:misc-activity; sid:377; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING Ping-O-MeterWindows"; itype:8; content:"OMeterObeseArmad",depth 32; metadata:ruleset community; classtype:misc-activity; sid:378; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING Pinger Windows"; itype:8; content:"Data|00 00 00 00 00 00 00 00 00 00 00 00|",depth 32; metadata:ruleset community; classtype:misc-activity; sid:379; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING Seer Windows"; itype:8; content:"|88 04|              ",depth 32; metadata:ruleset community; classtype:misc-activity; sid:380; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING Oracle Solaris"; dsize:8; itype:8; metadata:ruleset community; classtype:misc-activity; sid:381; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING Windows"; itype:8; content:"abcdefghijklmnop",depth 16; metadata:ruleset community; classtype:misc-activity; sid:382; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING"; icode:0; itype:8; metadata:ruleset community; classtype:misc-activity; sid:384; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP traceroute"; itype:8; ttl:1; metadata:ruleset community; classtype:attempted-recon; sid:385; rev:8; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PROTOCOL-ICMP Address Mask Reply"; icode:0; itype:18; metadata:ruleset community; classtype:misc-activity; sid:386; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Address Mask Reply undefined code"; icode:>0; itype:18; metadata:ruleset community; classtype:misc-activity; sid:387; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Address Mask Request"; icode:0; itype:17; metadata:ruleset community; classtype:misc-activity; sid:388; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Address Mask Request undefined code"; icode:>0; itype:17; metadata:ruleset community; classtype:misc-activity; sid:389; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Alternate Host Address"; icode:0; itype:6; metadata:ruleset community; classtype:misc-activity; sid:390; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Alternate Host Address undefined code"; icode:>0; itype:6; metadata:ruleset community; classtype:misc-activity; sid:391; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Datagram Conversion Error"; icode:0; itype:31; metadata:ruleset community; classtype:misc-activity; sid:392; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Datagram Conversion Error undefined code"; icode:>0; itype:31; metadata:ruleset community; classtype:misc-activity; sid:393; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Destination Unreachable Destination Host Unknown"; icode:7; itype:3; metadata:ruleset community; classtype:misc-activity; sid:394; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Destination Unreachable Destination Network Unknown"; icode:6; itype:3; metadata:ruleset community; classtype:misc-activity; sid:395; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Destination Unreachable Fragmentation Needed and DF bit was set"; icode:4; itype:3; metadata:policy max-detect-ips drop,ruleset community; reference:cve,2004-0790; reference:cve,2005-0068; reference:cve,2015-7759; classtype:misc-activity; sid:396; rev:12; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Destination Unreachable Host Precedence Violation"; icode:14; itype:3; metadata:ruleset community; classtype:misc-activity; sid:397; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Destination Unreachable Host Unreachable for Type of Service"; icode:12; itype:3; metadata:ruleset community; classtype:misc-activity; sid:398; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Destination Unreachable Host Unreachable"; icode:1; itype:3; metadata:ruleset community; classtype:misc-activity; sid:399; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Destination Unreachable Network Unreachable for Type of Service"; icode:11; itype:3; metadata:ruleset community; classtype:misc-activity; sid:400; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Destination Unreachable Network Unreachable"; icode:0; itype:3; metadata:ruleset community; classtype:misc-activity; sid:401; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP destination unreachable port unreachable packet detected"; icode:3; itype:3; metadata:policy max-detect-ips drop,ruleset community; reference:cve,2004-0790; reference:cve,2005-0068; classtype:misc-activity; sid:402; rev:16; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Destination Unreachable Precedence Cutoff in effect"; icode:15; itype:3; metadata:ruleset community; classtype:misc-activity; sid:403; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Destination Unreachable Protocol Unreachable"; icode:2; itype:3; metadata:policy max-detect-ips drop,ruleset community; reference:cve,2004-0790; reference:cve,2005-0068; classtype:misc-activity; sid:404; rev:14; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Destination Unreachable Source Host Isolated"; icode:8; itype:3; metadata:ruleset community; classtype:misc-activity; sid:405; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Destination Unreachable Source Route Failed"; icode:5; itype:3; metadata:ruleset community; classtype:misc-activity; sid:406; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Destination Unreachable cndefined code"; icode:>15; itype:3; metadata:ruleset community; classtype:misc-activity; sid:407; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Echo Reply"; icode:0; itype:0; metadata:ruleset community; classtype:misc-activity; sid:408; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Echo Reply undefined code"; icode:>0; itype:0; metadata:ruleset community; classtype:misc-activity; sid:409; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Fragment Reassembly Time Exceeded"; icode:1; itype:11; metadata:ruleset community; classtype:misc-activity; sid:410; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP IPV6 I-Am-Here"; icode:0; itype:34; metadata:ruleset community; classtype:misc-activity; sid:411; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP IPV6 I-Am-Here undefined code"; icode:>0; itype:34; metadata:ruleset community; classtype:misc-activity; sid:412; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP IPV6 Where-Are-You"; icode:0; itype:33; metadata:ruleset community; classtype:misc-activity; sid:413; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP IPV6 Where-Are-You undefined code"; icode:>0; itype:33; metadata:ruleset community; classtype:misc-activity; sid:414; rev:10; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PROTOCOL-ICMP Information Reply"; icode:0; itype:16; metadata:ruleset community; classtype:misc-activity; sid:415; rev:8; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PROTOCOL-ICMP Information Reply undefined code"; icode:>0; itype:16; metadata:ruleset community; classtype:misc-activity; sid:416; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Information Request"; icode:0; itype:15; metadata:ruleset community; classtype:misc-activity; sid:417; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Information Request undefined code"; icode:>0; itype:15; metadata:ruleset community; classtype:misc-activity; sid:418; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Mobile Host Redirect"; icode:0; itype:32; metadata:ruleset community; classtype:misc-activity; sid:419; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Mobile Host Redirect undefined code"; icode:>0; itype:32; metadata:ruleset community; classtype:misc-activity; sid:420; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Mobile Registration Reply"; icode:0; itype:36; metadata:ruleset community; classtype:misc-activity; sid:421; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Mobile Registration Reply undefined code"; icode:>0; itype:36; metadata:ruleset community; classtype:misc-activity; sid:422; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Mobile Registration Request"; icode:0; itype:35; metadata:ruleset community; classtype:misc-activity; sid:423; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Mobile Registration Request undefined code"; icode:>0; itype:35; metadata:ruleset community; classtype:misc-activity; sid:424; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Parameter Problem Bad Length"; icode:2; itype:12; metadata:ruleset community; classtype:misc-activity; sid:425; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Parameter Problem Missing a Required Option"; icode:1; itype:12; metadata:ruleset community; classtype:misc-activity; sid:426; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Parameter Problem Unspecified Error"; icode:0; itype:12; metadata:ruleset community; classtype:misc-activity; sid:427; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Parameter Problem undefined Code"; icode:>2; itype:12; metadata:ruleset community; classtype:misc-activity; sid:428; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Photuris Reserved"; icode:0; itype:40; metadata:ruleset community; classtype:misc-activity; sid:429; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Photuris Unknown Security Parameters Index"; icode:1; itype:40; metadata:ruleset community; classtype:misc-activity; sid:430; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Photuris Valid Security Parameters, But Authentication Failed"; icode:2; itype:40; metadata:ruleset community; classtype:misc-activity; sid:431; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Photuris Valid Security Parameters, But Decryption Failed"; icode:3; itype:40; metadata:ruleset community; classtype:misc-activity; sid:432; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Photuris undefined code!"; icode:>3; itype:40; metadata:ruleset community; classtype:misc-activity; sid:433; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Redirect for TOS and Host"; icode:3; itype:5; metadata:ruleset community; reference:cve,1999-0265; classtype:misc-activity; sid:436; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Redirect for TOS and Network"; icode:2; itype:5; metadata:ruleset community; reference:cve,1999-0265; classtype:misc-activity; sid:437; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Redirect undefined code"; icode:>3; itype:5; metadata:ruleset community; reference:cve,1999-0265; classtype:misc-activity; sid:438; rev:13; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Reserved for Security Type 19"; icode:0; itype:19; metadata:ruleset community; classtype:misc-activity; sid:439; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Reserved for Security Type 19 undefined code"; icode:>0; itype:19; metadata:ruleset community; classtype:misc-activity; sid:440; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Router Advertisement"; icode:0; itype:9; metadata:ruleset community; classtype:misc-activity; sid:441; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Router Selection"; icode:0; itype:10; metadata:ruleset community; classtype:misc-activity; sid:443; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP SKIP"; icode:0; itype:39; metadata:ruleset community; classtype:misc-activity; sid:445; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP SKIP undefined code"; icode:>0; itype:39; metadata:ruleset community; classtype:misc-activity; sid:446; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Source Quench undefined code"; icode:>0; itype:4; metadata:ruleset community; classtype:misc-activity; sid:448; rev:10; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PROTOCOL-ICMP Time-To-Live Exceeded in Transit"; icode:0; itype:11; metadata:ruleset community; classtype:misc-activity; sid:449; rev:9; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PROTOCOL-ICMP Time-To-Live Exceeded in Transit undefined code"; icode:>1; itype:11; metadata:ruleset community; classtype:misc-activity; sid:450; rev:11; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Timestamp Reply"; icode:0; itype:14; metadata:ruleset community; classtype:misc-activity; sid:451; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Timestamp Reply undefined code"; icode:>0; itype:14; metadata:ruleset community; classtype:misc-activity; sid:452; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Timestamp Request"; icode:0; itype:13; metadata:ruleset community; classtype:misc-activity; sid:453; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Timestamp Request undefined code"; icode:>0; itype:13; metadata:ruleset community; classtype:misc-activity; sid:454; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Traceroute"; icode:0; itype:30; metadata:ruleset community; classtype:misc-activity; sid:456; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Traceroute undefined code"; icode:>0; itype:30; metadata:ruleset community; classtype:misc-activity; sid:457; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP unassigned type 1"; icode:0; itype:1; metadata:ruleset community; classtype:misc-activity; sid:458; rev:12; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP unassigned type 1 undefined code"; itype:1; metadata:ruleset community; classtype:misc-activity; sid:459; rev:12; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP unassigned type 2"; icode:0; itype:2; metadata:ruleset community; classtype:misc-activity; sid:460; rev:12; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP unassigned type 2 undefined code"; itype:2; metadata:ruleset community; classtype:misc-activity; sid:461; rev:12; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP unassigned type 7"; icode:0; itype:7; metadata:ruleset community; classtype:misc-activity; sid:462; rev:12; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP unassigned type 7 undefined code"; itype:7; metadata:ruleset community; reference:cve,1999-0454; classtype:misc-activity; sid:463; rev:14; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP ISS Pinger"; itype:8; content:"ISSPNGRQ",depth 32; metadata:ruleset community; classtype:attempted-recon; sid:465; rev:8; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP L3retriever Ping"; icode:0; itype:8; content:"ABCDEFGHIJKLMNOPQRSTUVWABCDEFGHI",depth 32; metadata:ruleset community; classtype:attempted-recon; sid:466; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP Nemesis v1.1 Echo"; dsize:20; icmp_id:0; icmp_seq:0; itype:8; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|",fast_pattern,nocase; metadata:ruleset community; classtype:attempted-recon; sid:467; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP superscan echo"; dsize:8; itype:8; content:"|00 00 00 00 00 00 00 00|",fast_pattern,nocase; metadata:ruleset community; classtype:attempted-recon; sid:474; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP webtrends scanner"; icode:0; itype:8; content:"|00 00 00 00|EEEEEEEEEEEE",fast_pattern,nocase; metadata:ruleset community; classtype:attempted-recon; sid:476; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING speedera"; itype:8; content:"89|3A 3B|<=>?",depth 100; metadata:ruleset community; classtype:misc-activity; sid:480; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP TJPingPro1.1Build 2 Windows"; itype:8; content:"TJPingPro by Jim",depth 32; metadata:ruleset community; classtype:misc-activity; sid:481; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING WhatsupGold Windows"; itype:8; content:"WhatsUp - A Netw",depth 32; metadata:ruleset community; classtype:misc-activity; sid:482; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING CyberKit 2.2 Windows"; itype:8; content:"|AA AA AA AA AA AA AA AA AA AA AA AA AA AA AA AA|",depth 32; metadata:ruleset community; classtype:misc-activity; sid:483; rev:10; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP PING Sniffer Pro/NetXRay network scan"; itype:8; content:"Cinco Network, Inc.",depth 32; metadata:ruleset community; classtype:misc-activity; sid:484; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP no password"; flow:to_server,established; content:"PASS",fast_pattern,nocase; pcre:"/^PASS\s*\n/ims"; metadata:policy max-detect-ips drop,ruleset community; service:ftp; classtype:unknown; sid:489; rev:19; )
alert tcp $HOME_NET 21 -> $EXTERNAL_NET any ( msg:"PROTOCOL-FTP Bad login"; flow:to_client,established; content:"530 ",fast_pattern,nocase; pcre:"/^530\s+(Login|User)/ims"; metadata:ruleset community; service:ftp; classtype:bad-unknown; sid:491; rev:15; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"APP-DETECT psyBNC access"; flow:to_client,established; content:"Welcome!psyBNC@lam3rz.de",fast_pattern,nocase; metadata:ruleset community; classtype:bad-unknown; sid:493; rev:11; )
alert ip any any -> any any ( msg:"INDICATOR-COMPROMISE id check returned root"; content:"uid=0|28|root|29|"; metadata:ruleset community; classtype:bad-unknown; sid:498; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1417 ( msg:"SERVER-OTHER Insecure TIMBUKTU Password"; flow:to_server,established; content:"|05 00|>",depth 16; metadata:ruleset community; classtype:bad-unknown; sid:505; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 5631 ( msg:"PUA-OTHER PCAnywhere Attempted Administrator Login"; flow:to_server,established; content:"ADMINISTRATOR"; metadata:ruleset community; classtype:attempted-admin; sid:507; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 70 ( msg:"SERVER-OTHER gopher proxy"; flow:to_server,established; content:"ftp|3A|",fast_pattern,nocase; content:"@/"; metadata:ruleset community; classtype:bad-unknown; sid:508; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9000:9002 ( msg:"POLICY-OTHER HP JetDirect LCD modification attempt"; flow:to_server,established; content:"@PJL RDYMSG DISPLAY ="; metadata:ruleset community; reference:bugtraq,2245; classtype:misc-activity; sid:510; rev:12; )
alert tcp $HOME_NET 5631:5632 -> $EXTERNAL_NET any ( msg:"PUA-OTHER PCAnywhere Failed Login"; flow:to_client,established; content:"Invalid login",depth 16; metadata:ruleset community; classtype:unsuccessful-user; sid:512; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 27374 ( msg:"SERVER-OTHER ramen worm"; flow:to_server,established; content:"GET ",depth 8,nocase; metadata:ruleset community; classtype:bad-unknown; sid:514; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET 161 ( msg:"PROTOCOL-SNMP NT UserList"; flow:to_server; content:"+|06 10|@|14 D1 02 19|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:nessus,10546; classtype:attempted-recon; sid:516; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET 177 ( msg:"X11 xdmcp query"; flow:to_server; content:"|00 01 00 03 00 01 00|",fast_pattern,nocase; metadata:ruleset community; classtype:attempted-recon; sid:517; rev:7; )
alert udp $EXTERNAL_NET any -> $HOME_NET 69 ( msg:"PROTOCOL-TFTP Put"; flow:to_server; content:"|00 02|",depth 2; metadata:policy max-detect-ips drop,ruleset community; reference:cve,1999-0183; reference:url,github.com/rapid7/metasploit-framework/blob/unstable/unstable-modules/auxiliary/d20tftpbd.rb; classtype:bad-unknown; sid:518; rev:16; )
alert udp $EXTERNAL_NET any -> $HOME_NET 69 ( msg:"PROTOCOL-TFTP parent directory"; flow:to_server; content:"..",offset 2; metadata:policy max-detect-ips drop,ruleset community; reference:cve,1999-0183; reference:cve,2002-1209; reference:cve,2007-0888; reference:cve,2011-4722; classtype:bad-unknown; gid:1; sid:519; rev:16; )
alert udp $EXTERNAL_NET any -> $HOME_NET 69 ( msg:"PROTOCOL-TFTP root directory"; flow:to_server; content:"|00 01|/",depth 3; metadata:policy max-detect-ips drop,ruleset community; reference:cve,1999-0183; classtype:bad-unknown; sid:520; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] ( msg:"NETBIOS DCERPC NCACN-IP-TCP srvsvc NetrShareEnum null policy handle attempt"; flow:to_server,established; dce_iface:uuid 4b324fc8-1670-01d3-1278-5a47bf6ee188; dce_opnum:"15"; dce_stub_data; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,relative,dce,align; content:"|00 00 00 00|",within 4,distance 8; metadata:ruleset community; classtype:protocol-command-decode; sid:529; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"OS-WINDOWS NT NULL session"; flow:to_server,established; content:"|00 00 00 00|W|00|i|00|n|00|d|00|o|00|w|00|s|00| |00|N|00|T|00| |00|1|00|3|00|8|00|1"; metadata:ruleset community; reference:bugtraq,1163; reference:cve,2000-0347; classtype:attempted-recon; sid:530; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB CD.."; flow:to_server,established; content:"|5C|../|00 00 00|"; metadata:ruleset community; classtype:attempted-recon; sid:534; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB CD..."; flow:to_server,established; content:"|5C|...|00 00 00|"; metadata:ruleset community; classtype:attempted-recon; sid:535; rev:9; )
alert tcp $HOME_NET any <> $EXTERNAL_NET 1863 ( msg:"POLICY-SOCIAL Microsoft MSN message"; flow:established; content:"MSG ",depth 4; content:"Content-Type|3A|",nocase; content:"text/plain",distance 1; metadata:ruleset community; classtype:policy-violation; sid:540; rev:17; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"POLICY-SOCIAL ICQ access"; flow:to_server,established; content:"User-Agent|3A|ICQ",fast_pattern,nocase; metadata:ruleset community; classtype:policy-violation; sid:541; rev:15; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 ( msg:"POLICY-SOCIAL IRC nick change"; flow:to_server,established; isdataat:!139; content:"NICK ",fast_pattern,nocase; metadata:ruleset community; classtype:policy-violation; sid:542; rev:21; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"INDICATOR-COMPROMISE FTP 'STOR 1MB' possible warez site"; flow:to_server,established; content:"STOR",nocase; content:"1MB",distance 1,nocase; metadata:ruleset community; service:ftp; classtype:misc-activity; sid:543; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"INDICATOR-COMPROMISE FTP 'RETR 1MB' possible warez site"; flow:to_server,established; content:"RETR",nocase; content:"1MB",distance 1,nocase; metadata:ruleset community; service:ftp; classtype:misc-activity; sid:544; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"INDICATOR-COMPROMISE FTP 'CWD / ' possible warez site"; flow:to_server,established; content:"CWD",nocase; content:"/ ",distance 1; metadata:ruleset community; service:ftp; classtype:misc-activity; sid:545; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"INDICATOR-COMPROMISE FTP 'CWD  ' possible warez site"; flow:to_server,established; content:"CWD  ",depth 5,nocase; metadata:ruleset community; service:ftp; classtype:misc-activity; sid:546; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"INDICATOR-COMPROMISE FTP 'MKD  ' possible warez site"; flow:to_server,established; content:"MKD  ",depth 5,nocase; metadata:ruleset community; service:ftp; classtype:misc-activity; sid:547; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"INDICATOR-COMPROMISE FTP 'MKD .' possible warez site"; flow:to_server,established; content:"MKD .",depth 5,nocase; metadata:ruleset community; service:ftp; classtype:misc-activity; sid:548; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"POLICY-OTHER FTP anonymous login attempt"; flow:to_server,established; content:"USER",fast_pattern,nocase; pcre:"/^USER\s+(anonymous|ftp)[^\w]*[\r\n]/ims"; metadata:ruleset community; service:ftp; classtype:misc-activity; sid:553; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"INDICATOR-COMPROMISE FTP 'MKD / ' possible warez site"; flow:to_server,established; content:"MKD",nocase; content:"/ ",distance 1; metadata:ruleset community; service:ftp; classtype:misc-activity; sid:554; rev:10; )
alert tcp $HOME_NET 23 -> $EXTERNAL_NET any ( msg:"POLICY-OTHER WinGate telnet server response"; flow:to_client,established; content:"WinGate>"; metadata:ruleset community; reference:cve,1999-0657; classtype:misc-activity; sid:555; rev:13; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PUA-P2P Outbound GNUTella client request"; flow:to_server,established; content:"GNUTELLA CONNECT",depth 40; metadata:ruleset community; classtype:policy-violation; sid:556; rev:10; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PUA-P2P GNUTella client request"; flow:to_server,established; content:"GNUTELLA OK",depth 40; metadata:ruleset community; classtype:policy-violation; sid:557; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"APP-DETECT VNC server response"; flow:established; content:"RFB 0",depth 5; content:".0",depth 2,offset 7; metadata:ruleset community; classtype:misc-activity; sid:560; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET 5632 ( msg:"APP-DETECT PCAnywhere server response"; content:"ST",depth 2; metadata:ruleset community; classtype:misc-activity; sid:566; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9100 ( msg:"POLICY-OTHER HP JetDirect LCD modification attempt"; flow:to_server,established; content:"@PJL RDYMSG DISPLAY ="; metadata:ruleset community; reference:bugtraq,2245; classtype:misc-activity; sid:568; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC snmpXdmi overflow attempt TCP"; flow:to_server,established; content:"|00 01 87 99|",depth 4,offset 16; content:"|00 00 01 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,1024,20,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,2417; reference:cve,2001-0236; reference:nessus,10659; reference:url,www.cert.org/advisories/CA-2001-05.html; classtype:attempted-admin; sid:569; rev:25; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC mountd TCP export request"; flow:to_server,established; content:"|00 01 86 A5|",depth 4,offset 16; content:"|00 00 00 05|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; classtype:attempted-recon; sid:574; rev:14; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap admind request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 F7|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:575; rev:17; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap amountd request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 87 03|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,205; reference:bugtraq,235; reference:bugtraq,450; reference:bugtraq,614; reference:cve,1999-0088; reference:cve,1999-0210; reference:cve,1999-0493; reference:cve,1999-0704; classtype:rpc-portmap-decode; sid:576; rev:17; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap bootparam request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 BA|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:577; rev:23; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap cmsd request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 E4|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:578; rev:17; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap mountd request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 A5|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:579; rev:17; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap nisd request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 87 CC|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:cve,1999-0008; classtype:rpc-portmap-decode; sid:580; rev:21; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap pcnfsd request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 02|I|F1|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,205; reference:bugtraq,4816; reference:cve,1999-0078; reference:cve,1999-0353; reference:cve,2002-0910; classtype:rpc-portmap-decode; sid:581; rev:18; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap rexd request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 B1|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:582; rev:17; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap rstatd request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 A1|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:583; rev:18; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap rusers request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 A2|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:cve,1999-0626; classtype:rpc-portmap-decode; sid:584; rev:20; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC Solaris UDP portmap sadmin port query request attempt"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 87 88|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,8615; reference:cve,2003-0722; classtype:rpc-portmap-decode; sid:585; rev:18; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap selection_svc request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 AF|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,8; reference:cve,1999-0209; classtype:rpc-portmap-decode; sid:586; rev:18; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap status request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 B8|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:587; rev:17; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap ttdbserv request UDP"; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 F3|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,122; reference:bugtraq,3382; reference:cve,1999-0003; reference:cve,1999-0687; reference:cve,1999-1075; reference:cve,2001-0717; reference:url,www.cert.org/advisories/CA-2001-05.html; classtype:rpc-portmap-decode; sid:588; rev:27; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap yppasswd request UDP"; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 A9|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:589; rev:16; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap ypserv request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 A4|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,5914; reference:bugtraq,6016; reference:cve,2000-1042; reference:cve,2000-1043; reference:cve,2002-1232; classtype:rpc-portmap-decode; sid:590; rev:22; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap ypupdated request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 BC|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:sunrpc; reference:bugtraq,1749; reference:cve,1999-0208; classtype:rpc-portmap-decode; sid:591; rev:22; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap snmpXdmi request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 87 99|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,2417; reference:cve,2001-0236; reference:nessus,10659; reference:url,www.cert.org/advisories/CA-2001-05.html; classtype:rpc-portmap-decode; sid:593; rev:31; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap espd request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 05 F7|u",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; reference:bugtraq,2714; reference:cve,2001-0331; classtype:rpc-portmap-decode; sid:595; rev:22; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap listing TCP 111"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 04|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:598; rev:23; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 32771 ( msg:"PROTOCOL-RPC portmap listing TCP 32771"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 04|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; classtype:rpc-portmap-decode; sid:599; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 513 ( msg:"PROTOCOL-SERVICES rlogin LinuxNIS"; flow:to_server,established; content:"|3A 3A 3A 3A 3A 3A 3A 3A 00 3A 3A 3A 3A 3A 3A 3A 3A|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; classtype:bad-unknown; sid:601; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 513 ( msg:"PROTOCOL-SERVICES rlogin bin"; flow:to_server,established; content:"bin|00|bin|00|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; classtype:attempted-user; sid:602; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 513 ( msg:"PROTOCOL-SERVICES rlogin echo++"; flow:to_server,established; content:"echo |22| + + |22|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; classtype:bad-unknown; sid:603; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 513 ( msg:"PROTOCOL-SERVICES Unix rlogin froot parameter root access attempt"; flow:to_server,established; content:"-froot|00|",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,458; reference:cve,1999-0113; classtype:attempted-admin; sid:604; rev:15; )
alert tcp $HOME_NET 513 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SERVICES rlogin login failure"; flow:to_client,established; content:"login incorrect",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; classtype:unsuccessful-user; sid:605; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 513 ( msg:"PROTOCOL-SERVICES rlogin root"; flow:to_server,established; content:"root|00|root|00|",depth 10; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; classtype:attempted-admin; sid:606; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 514 ( msg:"PROTOCOL-SERVICES rsh bin"; flow:to_server,established; content:"bin|00|bin|00|",fast_pattern,nocase; metadata:ruleset community; classtype:attempted-user; sid:607; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 514 ( msg:"PROTOCOL-SERVICES rsh echo + +"; flow:to_server,established; content:"echo |22|+ +|22|",fast_pattern,nocase; metadata:ruleset community; classtype:attempted-user; sid:608; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 514 ( msg:"PROTOCOL-SERVICES rsh froot"; flow:to_server,established; content:"-froot|00|",fast_pattern,nocase; metadata:ruleset community; classtype:attempted-admin; sid:609; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 514 ( msg:"PROTOCOL-SERVICES rsh root"; flow:to_server,established; content:"|00|root|00|",fast_pattern,nocase; pcre:"/^(\d{1,5})?\x00?[^\x00]+?\x00root\x00/i"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,57221; reference:cve,2012-6392; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20130109-lms; classtype:attempted-admin; sid:610; rev:17; )
alert tcp $HOME_NET 513 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SERVICES rlogin login failure"; flow:to_client,established; content:"|01|rlogind|3A| Permission denied.",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; classtype:unsuccessful-user; sid:611; rev:14; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC rusers query UDP"; content:"|00 01 86 A2|",depth 4,offset 12; content:"|00 00 00 02|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:cve,1999-0626; classtype:attempted-recon; sid:612; rev:12; )
alert tcp $EXTERNAL_NET 10101 -> $HOME_NET any ( msg:"INDICATOR-SCAN myscan"; flow:stateless; ack:0; flags:S; ttl:>220; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:attempted-recon; sid:613; rev:11; )
alert tcp $EXTERNAL_NET 31790 -> $HOME_NET 31789 ( msg:"MALWARE-BACKDOOR hack-a-tack attempt"; flow:stateless; flags:A+; content:"A",depth 1; metadata:ruleset community; classtype:attempted-recon; sid:614; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 113 ( msg:"INDICATOR-SCAN ident version request"; flow:to_server,established; content:"VERSION|0A|",depth 16; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:attempted-recon; sid:616; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 80 ( msg:"INDICATOR-SCAN cybercop os probe"; flow:stateless; isdataat:!0; flags:12FS; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:attempted-recon; sid:619; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SCAN ipEye SYN scan"; flow:stateless; flags:S; seq:1958810375; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:attempted-recon; sid:622; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SCAN cybercop os PA12 attempt"; flow:stateless; flags:12AP; content:"AAAAAAAAAAAAAAAA",depth 16; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:attempted-recon; sid:626; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SCAN cybercop os SFU12 probe"; flow:stateless; ack:0; flags:12FSU; content:"AAAAAAAAAAAAAAAA",depth 16; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:attempted-recon; sid:627; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SCAN synscan portscan"; flow:stateless; flags:FS; id:39426; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:attempted-recon; sid:630; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET 10080:10081 ( msg:"INDICATOR-SCAN Amanda client-version request"; flow:to_server; content:"Amanda",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:attempted-recon; sid:634; rev:10; )
alert udp $EXTERNAL_NET any -> $HOME_NET 49 ( msg:"INDICATOR-SCAN XTACACS logout"; flow:to_server; content:"|80 07 00 00 07 00 00 04 00 00 00 00 00|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:bad-unknown; sid:635; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET 7 ( msg:"INDICATOR-SCAN cybercop udp bomb"; flow:to_server; content:"cybercop",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:bad-unknown; sid:636; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SCAN Webtrends Scanner UDP Probe"; flow:to_server; content:"|0A|help|0A|quite|0A|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; reference:url,www.netiq.com/products/vsm/default.asp; classtype:attempted-recon; sid:637; rev:13; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE SGI NOOP"; content:"|03 E0 F8|%|03 E0 F8|%|03 E0 F8|%|03 E0 F8|%",fast_pattern,nocase; metadata:ruleset community; classtype:shellcode-detect; sid:638; rev:11; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE SGI NOOP"; content:"|24 0F 12|4|24 0F 12|4|24 0F 12|4|24 0F 12|4",fast_pattern,nocase; metadata:ruleset community; classtype:shellcode-detect; sid:639; rev:11; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE AIX NOOP"; content:"O|FF FB 82|O|FF FB 82|O|FF FB 82|O|FF FB 82|",fast_pattern,nocase; metadata:ruleset community; classtype:shellcode-detect; sid:640; rev:11; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE Digital UNIX NOOP"; content:"G|FF 04 1F|G|FF 04 1F|G|FF 04 1F|G|FF 04 1F|",fast_pattern,nocase; metadata:ruleset community; classtype:shellcode-detect; sid:641; rev:12; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE HP-UX NOOP"; content:"|08|!|02 80 08|!|02 80 08|!|02 80 08|!|02 80|",fast_pattern,nocase; metadata:ruleset community; classtype:shellcode-detect; sid:642; rev:12; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE HP-UX NOOP"; content:"|0B|9|02 80 0B|9|02 80 0B|9|02 80 0B|9|02 80|",fast_pattern,nocase; metadata:ruleset community; classtype:shellcode-detect; sid:643; rev:13; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE sparc NOOP"; content:"|13 C0 1C A6 13 C0 1C A6 13 C0 1C A6 13 C0 1C A6|",fast_pattern,nocase; metadata:ruleset community; classtype:shellcode-detect; sid:644; rev:11; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE sparc NOOP"; content:"|80 1C|@|11 80 1C|@|11 80 1C|@|11 80 1C|@|11|",fast_pattern,nocase; metadata:ruleset community; classtype:shellcode-detect; sid:645; rev:11; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE sparc NOOP"; content:"|A6 1C C0 13 A6 1C C0 13 A6 1C C0 13 A6 1C C0 13|",fast_pattern,nocase; metadata:ruleset community; classtype:shellcode-detect; sid:646; rev:11; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE Oracle sparc setuid 0"; content:"|82 10| |17 91 D0| |08|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; classtype:system-call-detect; sid:647; rev:15; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE x86 NOOP"; content:"|90 90 90 90 90 90 90 90 90 90 90 90 90 90|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; classtype:shellcode-detect; sid:648; rev:18; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE x86 setgid 0"; content:"|B0 B5 CD 80|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; classtype:system-call-detect; sid:649; rev:15; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE x86 setuid 0"; content:"|B0 17 CD 80|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; classtype:system-call-detect; sid:650; rev:15; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE Linux shellcode"; content:"|90 90 90 E8 C0 FF FF FF|/bin/sh",fast_pattern,nocase; metadata:ruleset community; classtype:shellcode-detect; sid:652; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 457 ( msg:"SERVER-WEBAPP Netscape Unixware overflow"; flow:to_server,established; content:"|EB|_|9A FF FF FF FF 07 FF C3|^1|C0 89|F|9D|"; metadata:ruleset community; reference:bugtraq,908; reference:cve,1999-0744; classtype:attempted-recon; sid:1132; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 2301 ( msg:"SERVER-WEBAPP Compaq Insight directory traversal"; flow:to_server,established; content:"../"; metadata:ruleset community; service:http; reference:bugtraq,282; reference:cve,1999-0771; classtype:web-application-attack; sid:1199; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6000 ( msg:"X11 MIT Magic Cookie detected"; flow:established; content:"MIT-MAGIC-COOKIE-1",fast_pattern,nocase; metadata:ruleset community; classtype:attempted-user; sid:1225; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6000 ( msg:"X11 xopen"; flow:established; content:"l|00 0B 00 00 00 00 00 00 00 00 00|",fast_pattern,fast_pattern_offset 0,fast_pattern_length 10; metadata:policy max-detect-ips drop,ruleset community; classtype:unknown; sid:1226; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP CWD ..."; flow:to_server,established; content:"CWD",nocase; content:"...",distance 0; pcre:"/^CWD\s[^\n]*?\.\.\./ims"; metadata:ruleset community; service:ftp; reference:bugtraq,9237; classtype:bad-unknown; sid:1229; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1812 ( msg:"SERVER-WEBAPP VirusWall catinfo access"; flow:to_server,established; content:"/catinfo",nocase; metadata:ruleset community; service:http; reference:bugtraq,2579; reference:bugtraq,2808; reference:cve,2001-0432; reference:nessus,10650; classtype:attempted-recon; sid:1232; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"OS-WINDOWS RFParalyze Attempt"; flow:to_server,established; content:"BEAVIS"; content:"yep yep"; metadata:ruleset community; reference:bugtraq,1163; reference:cve,2000-0347; reference:nessus,10392; classtype:attempted-recon; sid:1239; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 2224 ( msg:"SERVER-OTHER MDBMS overflow"; flow:to_server,established; content:"|01|1|DB CD 80 E8|[|FF FF FF|",fast_pattern,nocase; metadata:ruleset community; reference:bugtraq,1252; reference:cve,2000-0446; reference:nessus,10422; classtype:attempted-admin; sid:1240; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 135:139 ( msg:"SERVER-OTHER Winnuke attack"; flow:stateless; flags:U+; metadata:ruleset community; reference:bugtraq,2010; reference:cve,1999-0153; classtype:attempted-dos; sid:1257; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 4242 ( msg:"SERVER-OTHER AIX pdnsd overflow"; flow:to_server,established; isdataat:1000; content:"|7F FF FB|x|7F FF FB|x|7F FF FB|x|7F FF FB|x"; content:"@|8A FF C8|@|82 FF D8 3B|6|FE 03 3B|v|FE 02|"; metadata:ruleset community; reference:bugtraq,3237; reference:bugtraq,590; reference:cve,1999-0745; classtype:attempted-user; sid:1261; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap admind request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 F7|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1262; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap amountd request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 87 03|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; reference:bugtraq,205; reference:bugtraq,235; reference:bugtraq,450; reference:bugtraq,614; reference:cve,1999-0088; reference:cve,1999-0210; reference:cve,1999-0493; reference:cve,1999-0704; classtype:rpc-portmap-decode; sid:1263; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap bootparam request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 BA|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1264; rev:21; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap cmsd request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 E4|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1265; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap nisd request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 87 CC|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1267; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap pcnfsd request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 02|I|F1|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; reference:bugtraq,205; reference:bugtraq,4816; reference:cve,1999-0078; reference:cve,1999-0353; reference:cve,2002-0910; classtype:rpc-portmap-decode; sid:1268; rev:19; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap rexd request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 B1|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1269; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap rstatd request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 A1|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1270; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap rusers request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 A2|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; reference:cve,1999-0626; classtype:rpc-portmap-decode; sid:1271; rev:21; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap sadmind request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 87 88|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1272; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap selection_svc request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 AF|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; reference:bugtraq,205; reference:cve,1999-0209; classtype:rpc-portmap-decode; sid:1273; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap ttdbserv request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 F3|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; reference:bugtraq,122; reference:bugtraq,3382; reference:cve,1999-0003; reference:cve,1999-0687; reference:cve,1999-1075; reference:cve,2001-0717; reference:url,www.cert.org/advisories/CA-2001-05.html; classtype:rpc-portmap-decode; sid:1274; rev:26; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap yppasswd request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 A9|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1275; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap ypserv request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 A4|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; reference:bugtraq,5914; reference:bugtraq,6016; reference:cve,2000-1042; reference:cve,2000-1043; reference:cve,2002-1232; classtype:rpc-portmap-decode; sid:1276; rev:21; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap ypupdated request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 BC|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:sunrpc; reference:bugtraq,1749; reference:bugtraq,28383; reference:cve,1999-0208; classtype:rpc-portmap-decode; sid:1277; rev:23; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap snmpXdmi request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 87 99|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,2417; reference:cve,2001-0236; reference:nessus,10659; reference:url,www.cert.org/advisories/CA-2001-05.html; classtype:rpc-portmap-decode; sid:1279; rev:28; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap listing UDP 111"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 04|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1280; rev:18; )
alert udp $EXTERNAL_NET any -> $HOME_NET 32771 ( msg:"PROTOCOL-RPC portmap listing UDP 32771"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 04|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; classtype:rpc-portmap-decode; sid:1281; rev:15; )
alert udp any any -> any 69 ( msg:"PROTOCOL-TFTP GET Admin.dll"; flow:to_server; content:"|00 01|",depth 2; content:"admin.dll",offset 2,nocase; metadata:policy max-detect-ips drop,ruleset community; reference:url,www.cert.org/advisories/CA-2001-26.html; classtype:successful-admin; sid:1289; rev:11; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE directory listing"; flow:established; content:"Volume Serial Number"; metadata:ruleset community; classtype:bad-unknown; sid:1292; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"INDICATOR-COMPROMISE nimda RICHED20.DLL"; flow:to_server,established; content:"R|00|I|00|C|00|H|00|E|00|D|00|2|00|0|00|.|00|D|00|L|00|L",nocase; metadata:ruleset community; reference:url,www.f-secure.com/v-descs/nimda.shtml; classtype:bad-unknown; sid:1295; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 4321 ( msg:"SERVER-OTHER rwhoisd format string attempt"; flow:to_server,established; content:"-soa %p"; metadata:ruleset community; reference:bugtraq,3474; reference:cve,2001-0838; reference:nessus,10790; classtype:misc-attack; sid:1323; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP wu-ftp bad file completion attempt"; flow:to_server,established; content:"~"; content:"[",distance 0; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:bugtraq,3581; reference:bugtraq,3707; reference:cve,2001-0550; reference:cve,2001-0886; reference:nessus,10821; classtype:misc-attack; sid:1377; rev:24; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP wu-ftp bad file completion attempt"; flow:to_server,established; content:"~"; content:"{",distance 0; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:bugtraq,3581; reference:bugtraq,3707; reference:cve,2001-0550; reference:cve,2001-0886; reference:nessus,10821; classtype:misc-attack; sid:1378; rev:24; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP STAT overflow attempt"; flow:to_server,established; content:"STAT",nocase; isdataat:190,relative; pcre:"/^STAT(?!\n)\s[^\n]{190}/im"; metadata:ruleset community; service:ftp; reference:bugtraq,3507; reference:bugtraq,8542; reference:cve,2001-0325; reference:cve,2001-1021; reference:cve,2003-0772; reference:cve,2011-0762; reference:url,labs.defcom.com/adv/2001/def-2001-31.txt; classtype:attempted-admin; sid:1379; rev:23; )
alert tcp any any -> any 6666:7000 ( msg:"SERVER-OTHER CHAT IRC Ettercap parse overflow attempt"; flow:to_server,established; content:"PRIVMSG",fast_pattern,nocase; content:"nickserv",nocase; content:"IDENTIFY",nocase; isdataat:100,relative; pcre:"/^PRIVMSG\s+nickserv\s+IDENTIFY\s[^\n]{100}/ims"; metadata:ruleset community; reference:url,www.bugtraq.org/dev/GOBBLES-12.txt; classtype:misc-attack; sid:1382; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1900 ( msg:"OS-WINDOWS Microsoft Windows UPnP malformed advertisement"; flow:to_server,no_stream; content:"NOTIFY * ",fast_pattern,nocase; content:"LOCATION|3A|",nocase; detection_filter:track by_dst,count 10,seconds 1; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,3723; reference:cve,2001-0876; reference:cve,2001-0877; reference:nessus,10829; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-059; classtype:misc-attack; sid:1384; rev:21; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"OS-WINDOWS Microsoft Windows UPnP Location overflow attempt"; content:"Location",fast_pattern,nocase; pcre:"/^Location\s*\x3a\s*\w+\x3a\/\/([^\n]*\x3a)?[^\n]{128}/ims"; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,3723; reference:cve,2001-0876; reference:cve,2007-2386; reference:nessus,10829; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-059; classtype:misc-attack; sid:1388; rev:23; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE x86 inc ebx NOOP"; content:"CCCCCCCCCCCCCCCCCCCCCCCC"; metadata:policy max-detect-ips drop,ruleset community; classtype:shellcode-detect; sid:1390; rev:17; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SHELLCODE x86 inc ecx NOOP"; content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"; metadata:ruleset community; classtype:shellcode-detect; sid:1394; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6112 ( msg:"SERVER-OTHER CDE dtspcd exploit attempt"; flow:to_server,established; content:"1",depth 1,offset 10; content:!"000",depth 3,offset 11; metadata:ruleset community; reference:bugtraq,3517; reference:cve,2001-0803; reference:nessus,10833; reference:url,www.cert.org/advisories/CA-2002-01.html; classtype:misc-attack; sid:1398; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3372 ( msg:"SERVER-OTHER MSDTC attempt"; flow:to_server,established; isdataat:1023; metadata:ruleset community; reference:bugtraq,4006; reference:cve,2002-0224; reference:nessus,10939; classtype:attempted-dos; sid:1408; rev:17; )
alert udp $EXTERNAL_NET any -> $HOME_NET 161:162 ( msg:"PROTOCOL-SNMP community string buffer overflow attempt"; flow:to_server; content:"|02 01 00 04 82 01 00|",offset 4; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:cve,2002-0012; reference:cve,2002-0013; reference:url,www.cert.org/advisories/CA-2002-03.html; classtype:misc-attack; sid:1409; rev:21; )
alert udp $EXTERNAL_NET any -> $HOME_NET 161 ( msg:"PROTOCOL-SNMP public access udp"; flow:to_server; content:"|06|public"; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,2112; reference:bugtraq,4088; reference:bugtraq,4089; reference:cve,1999-0517; reference:cve,2002-0012; reference:cve,2002-0013; reference:cve,2022-20918; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-fmcsfr-snmp-access-6gqgtJ4S; classtype:attempted-recon; gid:1; sid:1411; rev:21; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 161 ( msg:"PROTOCOL-SNMP public access tcp"; flow:to_server,established; content:"public"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:snmp; reference:bugtraq,2112; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,7212; reference:cve,1999-0517; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1412; rev:22; )
alert udp $EXTERNAL_NET any -> $HOME_NET 161 ( msg:"PROTOCOL-SNMP private access udp"; flow:to_server; content:"private"; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:bugtraq,7212; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1413; rev:19; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 161 ( msg:"PROTOCOL-SNMP private access tcp"; flow:to_server,established; content:"private"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1414; rev:20; )
alert udp any any -> 255.255.255.255 161 ( msg:"PROTOCOL-SNMP Broadcast request"; flow:to_server; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1415; rev:18; )
alert udp any any -> 255.255.255.255 162 ( msg:"PROTOCOL-SNMP broadcast trap"; flow:to_server; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1416; rev:18; )
alert udp $EXTERNAL_NET any -> $HOME_NET 161 ( msg:"PROTOCOL-SNMP request udp"; flow:to_server; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1417; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 161 ( msg:"PROTOCOL-SNMP request tcp"; flow:stateless; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1418; rev:19; )
alert udp $EXTERNAL_NET any -> $HOME_NET 162 ( msg:"PROTOCOL-SNMP trap udp"; flow:to_server; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1419; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 162 ( msg:"PROTOCOL-SNMP trap tcp"; flow:stateless; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1420; rev:19; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 705 ( msg:"PROTOCOL-SNMP AgentX/tcp request"; flow:stateless; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1421; rev:19; )
alert udp $EXTERNAL_NET any -> $HOME_NET 161:162 ( msg:"PROTOCOL-SNMP community string buffer overflow attempt with evasion"; flow:to_server; content:" |04 82 01 00|",depth 5,offset 7; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:cve,2002-0012; reference:cve,2002-0013; reference:url,www.cert.org/advisories/CA-2002-03.html; classtype:misc-attack; sid:1422; rev:21; )
alert udp $EXTERNAL_NET any -> $HOME_NET 161 ( msg:"PROTOCOL-SNMP PROTOS test-suite-req-app attempt"; content:"0&|02 01 00 04 06|public|A0 19 02 01 00 02 01 00 02 01 00|0|0E|0|0C 06 08|+|06 01 02 01 01 05 00 05 00|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c06/snmpv1/index.html; classtype:misc-attack; sid:1426; rev:14; )
alert udp $EXTERNAL_NET any -> $HOME_NET 162 ( msg:"PROTOCOL-SNMP PROTOS test-suite-trap-app attempt"; content:"08|02 01 00 04 06|public|A4|+|06|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c06/snmpv1/index.html; classtype:misc-attack; sid:1427; rev:13; )
alert tcp $HOME_NET any -> 64.245.58.0/23 any ( msg:"POLICY-MULTIMEDIA audio galaxy keepalive"; flow:established; content:"E_|00 03 05|",depth 5; metadata:ruleset community; classtype:misc-activity; sid:1428; rev:8; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PUA-P2P GNUTella client request"; flow:to_server,established; content:"GNUTELLA",depth 8; metadata:ruleset community; classtype:policy-violation; sid:1432; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS named authors attempt"; flow:to_server,established; content:"|07|authors",offset 12,nocase; content:"|04|bind|00|",offset 12,nocase; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:nessus,10728; classtype:attempted-recon; sid:1435; rev:16; )
alert udp any any -> any 69 ( msg:"PROTOCOL-TFTP GET nc.exe"; flow:to_server; content:"|00 01|",depth 2; content:"nc.exe",offset 2,nocase; metadata:policy max-detect-ips drop,ruleset community; classtype:successful-admin; sid:1441; rev:11; )
alert udp any any -> any 69 ( msg:"PROTOCOL-TFTP GET shadow"; flow:to_server; content:"|00 01|",depth 2; content:"shadow",offset 2,nocase; metadata:policy max-detect-ips drop,ruleset community; classtype:successful-admin; sid:1442; rev:11; )
alert udp any any -> any 69 ( msg:"PROTOCOL-TFTP GET passwd"; flow:to_server; content:"|00 01|",depth 2; content:"passwd",offset 2,nocase; metadata:policy max-detect-ips drop,ruleset community; reference:cve,2021-1437; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-aironet-info-disc-BfWqghj; classtype:successful-admin; sid:1443; rev:12; )
alert udp $EXTERNAL_NET any -> $HOME_NET 69 ( msg:"PROTOCOL-TFTP Get"; flow:to_server; content:"|00 01|",depth 2; metadata:policy max-detect-ips drop,ruleset community; classtype:bad-unknown; sid:1444; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"INDICATOR-COMPROMISE FTP file_id.diz access possible warez site"; flow:to_server,established; content:"RETR",nocase; content:"file_id.diz",distance 1,nocase; metadata:ruleset community; service:ftp; classtype:suspicious-filename-detect; sid:1445; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 ( msg:"POLICY-OTHER Microsoft Windows Terminal server RDP attempt"; flow:to_server,established; content:"|03 00 00 0B 06 E0 00 00 00 00 00|",depth 11; metadata:ruleset community; service:rdp; reference:bugtraq,3099; reference:cve,2001-0540; reference:cve,2001-0663; reference:nessus,10940; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-040; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-052; classtype:protocol-command-decode; sid:1447; rev:20; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 ( msg:"POLICY-OTHER Microsoft Windows Terminal server request attempt"; flow:to_server,established; content:"|03 00 00|",depth 3; content:"|E0 00 00 00 00 00|",depth 6,offset 5; metadata:ruleset community; service:rdp; reference:bugtraq,3099; reference:cve,2001-0540; reference:cve,2001-0663; reference:nessus,10940; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-040; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-052; classtype:protocol-command-decode; sid:1448; rev:20; )
alert tcp $HOME_NET any <> $EXTERNAL_NET 6666:7000 ( msg:"POLICY-SOCIAL IRC message"; flow:established; isdataat:!139; content:"PRIVMSG "; metadata:ruleset community; classtype:policy-violation; sid:1463; rev:16; )
alert tcp $HOME_NET 8002 -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE oracle one hour install"; flow:to_client,established; content:"Oracle Applications One-Hour Install"; metadata:ruleset community; reference:nessus,10737; classtype:bad-unknown; sid:1464; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8888 ( msg:"SERVER-WEBAPP SiteScope Service access"; flow:to_server,established; content:"/SiteScope/cgi/go.exe/SiteScope"; metadata:ruleset community; service:http; reference:nessus,10778; classtype:web-application-activity; sid:1499; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET 7001 ( msg:"POLICY-OTHER AFS access"; flow:to_server; content:"|00 00 03 E7 00 00 00 00 00 00 00|e|00 00 00 00 00 00 00 00 0D 05 00 00 00 00 00 00 00|",fast_pattern,nocase; metadata:ruleset community; reference:nessus,10441; classtype:misc-activity; sid:1504; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8000 ( msg:"SERVER-WEBAPP nstelemetry.adp access"; flow:to_server,established; content:"/nstelemetry.adp"; metadata:ruleset community; service:http; reference:nessus,10753; classtype:web-application-activity; sid:1518; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP SITE overflow attempt"; flow:to_server,established; content:"SITE",nocase; isdataat:100,relative; pcre:"/^SITE(?!\n)\s[^\n]{100}/ims"; metadata:ruleset community; service:ftp; reference:cve,1999-0838; reference:cve,2001-0755; reference:cve,2001-0770; classtype:attempted-admin; sid:1529; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 119 ( msg:"PROTOCOL-NNTP AUTHINFO USER overflow attempt"; flow:to_server,established; content:"AUTHINFO",nocase; content:"USER",distance 0,nocase; isdataat:200,relative; pcre:"/^AUTHINFO\s+USER\s[^\n]{200}/ims"; metadata:ruleset community; reference:bugtraq,1156; reference:cve,2000-0341; reference:nessus,10388; classtype:attempted-admin; sid:1538; rev:22; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"PROTOCOL-FINGER version query"; flow:to_server,established; content:"version"; metadata:ruleset community; classtype:attempted-recon; sid:1541; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 ( msg:"SERVER-WEBAPP Delegate whois overflow attempt"; flow:to_server,established; content:"whois|3A|//",nocase; metadata:ruleset community; service:http; reference:cve,2000-0165; reference:nessus,10054; classtype:web-application-activity; sid:1558; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP SITE CHOWN overflow attempt"; flow:to_server,established; content:"SITE",nocase; content:"CHOWN",distance 0,nocase; isdataat:100,relative; pcre:"/^SITE\s+CHOWN\s[^\n]{100}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,2120; reference:cve,2001-0065; reference:nessus,10579; classtype:attempted-admin; sid:1562; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 4080 ( msg:"SERVER-WEBAPP iChat directory traversal attempt"; flow:to_server,established; content:"/../../"; metadata:ruleset community; service:http; reference:cve,1999-0897; classtype:web-application-activity; sid:1604; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6004 ( msg:"SERVER-OTHER iParty DOS attempt"; flow:to_server,established; content:"|FF FF FF FF FF FF|"; metadata:ruleset community; reference:bugtraq,6844; reference:cve,1999-1566; reference:nessus,10111; classtype:misc-attack; sid:1605; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS named version attempt"; flow:to_server; content:"|07|version",offset 12,nocase; content:"|04|bind|00|",offset 12,nocase; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:nessus,10028; classtype:attempted-recon; sid:1616; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP CMD overflow attempt"; flow:to_server,established; content:"CMD",nocase; isdataat:200,relative; pcre:"/^CMD(?!\n)\s[^\n]{200}/ims"; metadata:ruleset community; service:ftp; classtype:attempted-admin; sid:1621; rev:20; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP RNFR ././ attempt"; flow:to_server,established; content:"RNFR ",fast_pattern,nocase; content:" ././"; metadata:ruleset community; service:ftp; reference:cve,1999-0081; classtype:misc-attack; sid:1622; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP invalid MODE"; flow:to_server,established; content:"MODE",fast_pattern,nocase; pcre:"/^MODE\s+[^ABSC]{1}/ims"; metadata:ruleset community; service:ftp; reference:url,www.faqs.org/rfcs/rfc959.html; classtype:protocol-command-decode; sid:1623; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP PWD overflow attempt"; flow:to_server,established; content:"PWD",nocase; isdataat:190,relative; pcre:"/^PWD\s.{190}/ims"; metadata:ruleset community; service:ftp; classtype:protocol-command-decode; sid:1624; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP SYST overflow attempt"; flow:to_server,established; content:"SYST",nocase; isdataat:100,relative; pcre:"/^SYST(?!\n)\s[^\n]{100}/ims"; metadata:ruleset community; service:ftp; reference:url,www.faqs.org/rfcs/rfc959.html; classtype:protocol-command-decode; sid:1625; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP PASS overflow attempt"; flow:to_server,established; content:"PASS",nocase; isdataat:50,relative; pcre:"/^PASS\s[^\n]{50}/ims"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:pop3; reference:bugtraq,21645; reference:bugtraq,791; reference:cve,1999-1511; reference:cve,2006-6605; reference:nessus,10325; classtype:attempted-admin; sid:1634; rev:25; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP APOP overflow attempt"; flow:to_server,established; content:"APOP",nocase; isdataat:256,relative; pcre:"/^APOP\s[^\n]{256}/ims"; metadata:ruleset community; service:pop3; reference:bugtraq,1652; reference:cve,2000-0840; reference:cve,2000-0841; reference:nessus,10559; classtype:attempted-admin; sid:1635; rev:19; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 32000 ( msg:"SERVER-OTHER Xtramail Username overflow attempt"; flow:to_server,established; content:"Username|3A|",nocase; isdataat:100,relative; pcre:"/^Username\:[^\n]{100}/ims"; metadata:ruleset community; reference:bugtraq,791; reference:cve,1999-1511; reference:nessus,10323; classtype:attempted-admin; sid:1636; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 22 ( msg:"INDICATOR-SCAN SSH Version map attempt"; flow:to_server,established; content:"Version_Mapper",fast_pattern,nocase; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:network-scan; sid:1638; rev:10; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 ( msg:"POLICY-SOCIAL IRC DCC file transfer request"; flow:to_server,established; content:"PRIVMSG ",nocase; content:" |3A|.DCC SEND",distance 0,fast_pattern,nocase; metadata:ruleset community; classtype:policy-violation; sid:1639; rev:13; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 ( msg:"POLICY-SOCIAL IRC DCC chat request"; flow:to_server,established; content:"PRIVMSG ",nocase; content:" |3A|.DCC CHAT chat",distance 0,fast_pattern,nocase; metadata:ruleset community; classtype:policy-violation; sid:1640; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6789:6790 ( msg:"SERVER-OTHER DB2 dos attempt"; flow:to_server,established; isdataat:0; isdataat:!1; metadata:ruleset community; reference:bugtraq,3010; reference:cve,2001-1143; reference:nessus,10871; classtype:denial-of-service; sid:1641; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP CWD ~ attempt"; flow:to_server,established; content:"CWD",fast_pattern,nocase; pcre:"/^CWD\s+~/ims"; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:bugtraq,2601; reference:bugtraq,9215; reference:cve,2001-0421; classtype:denial-of-service; sid:1672; rev:22; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 ( msg:"POLICY-SOCIAL IRC channel join"; flow:to_server,established; isdataat:!139; content:"JOIN "; pcre:"/(&|#|\+|!)/R"; metadata:ruleset community; classtype:policy-violation; sid:1729; rev:16; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap rwalld request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 A8|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,205; reference:cve,1999-0181; classtype:rpc-portmap-decode; sid:1732; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap rwalld request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 A8|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; reference:bugtraq,205; reference:cve,1999-0181; classtype:rpc-portmap-decode; sid:1733; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP USER overflow attempt"; flow:to_server,established; content:"USER",nocase; isdataat:100,relative; pcre:"/^USER(?!\n)\s[^\n]{100}/ims"; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:bugtraq,10078; reference:bugtraq,10720; reference:bugtraq,1227; reference:bugtraq,1504; reference:bugtraq,15352; reference:bugtraq,1690; reference:bugtraq,22044; reference:bugtraq,22045; reference:bugtraq,4638; reference:bugtraq,49750; reference:bugtraq,7307; reference:bugtraq,8376; reference:cve,1999-1510; reference:cve,1999-1514; reference:cve,1999-1519; reference:cve,1999-1539; reference:cve,2000-0479; reference:cve,2000-0656; reference:cve,2000-0761; reference:cve,2000-0943; reference:cve,2000-1194; reference:cve,2001-0256; reference:cve,2001-0794; reference:cve,2001-0826; reference:cve,2002-0126; reference:cve,2002-1522; reference:cve,2003-0271; reference:cve,2004-0286; reference:cve,2004-0695; reference:cve,2005-3683; classtype:attempted-admin; sid:1734; rev:50; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap cachefsd request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 87 8B|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,4674; reference:cve,2002-0033; reference:cve,2002-0084; reference:nessus,10951; classtype:rpc-portmap-decode; sid:1746; rev:20; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap cachefsd request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 87 8B|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; reference:bugtraq,4674; reference:cve,2002-0033; reference:cve,2002-0084; reference:nessus,10951; classtype:rpc-portmap-decode; sid:1747; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 32772:34000 ( msg:"SERVER-OTHER cachefsd buffer overflow attempt"; flow:to_server,established; isdataat:720; content:"|00 01 87 86 00 00 00 01 00 00 00 05|",fast_pattern,nocase; metadata:ruleset community; reference:bugtraq,4631; reference:cve,2002-0084; reference:nessus,10951; classtype:misc-attack; sid:1751; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP partial body buffer overflow attempt"; flow:to_server,established; content:"PARTIAL",nocase; content:"BODY[",distance 0,nocase; isdataat:1024,relative; pcre:"/\sPARTIAL.*?BODY\[[^\]]{1024}/ims"; metadata:ruleset community; service:imap; reference:bugtraq,4713; reference:cve,2002-0379; reference:nessus,10966; classtype:misc-attack; sid:1755; rev:24; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500 ( msg:"POLICY-OTHER IPSec PGPNet connection attempt"; flow:to_server; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 10 02 00 00 00 00 00 00 00 00 88 0D 00 00 5C 00 00 00 01 00 00 00 01 00 00 00|P|01 01 00 02 03 00 00 24 01 01 00 00 80 01 00 06 80 02 00 02 80 03 00 03 80 04 00 05 80 0B 00 01 00 0C 00 04 00 01|Q|80 00 00 00 24 02 01 00 00 80 01 00 05 80 02 00 01 80 03 00 03 80 04 00 02 80 0B 00 01 00 0C 00 04 00 01|Q|80 00 00 00 10|",fast_pattern,nocase; metadata:ruleset community; classtype:protocol-command-decode; sid:1771; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP EXPLOIT STAT asterisk dos attempt"; flow:to_server,established; content:"STAT",fast_pattern,nocase; pcre:"/^STAT\s+[^\n]*\x2a/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,4482; reference:cve,2002-0073; reference:nessus,10934; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-018; classtype:attempted-dos; sid:1777; rev:19; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP EXPLOIT STAT ? dos attempt"; flow:to_server,established; content:"STAT",fast_pattern,nocase; pcre:"/^STAT\s+[^\n]*\x3f/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,4482; reference:cve,2002-0073; reference:nessus,10934; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-018; classtype:attempted-dos; sid:1778; rev:18; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 ( msg:"POLICY-SOCIAL IRC dns request"; flow:to_server,established; content:"USERHOST "; metadata:ruleset community; classtype:policy-violation; sid:1789; rev:12; )
alert tcp $EXTERNAL_NET 6666:7000 -> $HOME_NET any ( msg:"POLICY-SOCIAL IRC dns response"; flow:to_client,established; content:"|3A|"; content:" 302 "; content:"=+",fast_pattern,nocase; metadata:ruleset community; classtype:policy-violation; sid:1790; rev:11; )
alert tcp $EXTERNAL_NET 119 -> $HOME_NET any ( msg:"PROTOCOL-NNTP return code buffer overflow attempt"; flow:to_client,established; content:"200"; isdataat:256,relative; pcre:"/^200\s[^\n]{256}/ims"; metadata:ruleset community; reference:bugtraq,4900; reference:cve,2002-0909; classtype:protocol-command-decode; sid:1792; rev:16; )
alert tcp $HOME_NET 22 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER successful gobbles ssh exploit GOBBLE"; flow:to_client,established; content:"*GOBBLE*"; metadata:ruleset community; reference:bugtraq,5093; reference:cve,2002-0390; reference:cve,2002-0640; classtype:successful-admin; sid:1810; rev:19; )
alert tcp $HOME_NET 22 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER successful gobbles ssh exploit uname"; flow:to_client,established; content:"uname"; metadata:ruleset community; reference:bugtraq,5093; reference:cve,2002-0390; reference:cve,2002-0640; reference:nessus,11031; classtype:misc-attack; sid:1811; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 22 ( msg:"SERVER-OTHER gobbles SSH exploit attempt"; flow:to_server,established; content:"GOBBLES"; metadata:ruleset community; reference:bugtraq,5093; reference:cve,2002-0639; reference:nessus,11031; classtype:misc-attack; sid:1812; rev:13; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP digital island bandwidth query"; content:"mailto|3A|ops@digisle.com",depth 22; metadata:ruleset community; classtype:misc-activity; sid:1813; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 2533 ( msg:"SERVER-OTHER Alcatel PABX 4400 connection attempt"; flow:to_server,established; content:"|00 01|C",depth 3; metadata:ruleset community; reference:nessus,11019; classtype:misc-activity; sid:1819; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 515 ( msg:"SERVER-OTHER LPD dvips remote command execution attempt"; flow:to_server,established; content:"psfile=|22|`"; metadata:ruleset community; reference:bugtraq,3241; reference:cve,2001-1002; reference:nessus,11023; classtype:system-call-detect; sid:1821; rev:10; )
alert tcp $EXTERNAL_NET 80 -> $HOME_NET any ( msg:"POLICY-SOCIAL ICQ forced user addition"; flow:to_client,established; content:"Content-Type|3A| application/x-icq",fast_pattern,nocase; content:"[ICQ User]"; metadata:ruleset community; reference:bugtraq,3226; reference:cve,2001-1305; classtype:policy-violation; sid:1832; rev:13; )
alert tcp $EXTERNAL_NET 22 -> $HOME_NET any ( msg:"SERVER-OTHER SSH server banner overflow"; flow:to_client,established; content:"SSH-",nocase; isdataat:200,relative; pcre:"/^SSH-\s?[^\n]{200}/ims"; metadata:ruleset community; reference:bugtraq,5287; reference:cve,2002-1059; reference:nessus,15822; classtype:misc-attack; sid:1838; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP login buffer overflow attempt"; flow:to_server,established; content:"LOGIN",nocase; isdataat:100,relative; pcre:"/\sLOGIN\s[^\n]{100}/i"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:imap; reference:bugtraq,13727; reference:bugtraq,21110; reference:bugtraq,502; reference:cve,1999-0005; reference:cve,1999-1557; reference:cve,2004-1011; reference:cve,2005-1255; reference:cve,2006-5961; reference:cve,2007-1373; reference:cve,2007-2795; reference:cve,2007-3925; reference:nessus,10123; reference:nessus,10125; classtype:attempted-user; sid:1842; rev:35; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 33270 ( msg:"MALWARE-BACKDOOR trinity connection attempt"; flow:to_server,established; content:"!@|23|",depth 3; metadata:ruleset community; reference:cve,2000-0138; reference:nessus,10501; classtype:attempted-admin; sid:1843; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP authenticate overflow attempt"; flow:to_server,established; content:"AUTHENTICATE",nocase; isdataat:100,relative; pcre:"/\sAUTHENTICATE\s[^\n]{100}/ims"; metadata:ruleset community; service:imap; reference:bugtraq,12995; reference:bugtraq,130; reference:cve,1999-0005; reference:cve,1999-0042; reference:nessus,10292; classtype:misc-attack; sid:1844; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP list literal overflow attempt"; flow:to_server,established; content:"LIST",fast_pattern,nocase; pcre:"/\sLIST\s[^\n]*?\s\{/ims"; byte_test:5,>,256,0,relative,string,dec; metadata:ruleset community; service:imap; reference:bugtraq,1110; reference:cve,2000-0284; reference:nessus,10374; classtype:misc-attack; sid:1845; rev:24; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 5800:5802 ( msg:"POLICY-MULTIMEDIA vncviewer Java applet download attempt"; flow:to_server,established; content:"/vncviewer.jar"; metadata:ruleset community; reference:nessus,10758; classtype:misc-activity; sid:1846; rev:7; )
alert udp $EXTERNAL_NET any -> $HOME_NET 35555 ( msg:"MALWARE-BACKDOOR win-trin00 connection attempt"; flow:to_server; content:"png []..Ks l44",depth 14; metadata:ruleset community; reference:cve,2000-0138; reference:nessus,10307; classtype:attempted-admin; sid:1853; rev:12; )
alert icmp $EXTERNAL_NET any <> $HOME_NET any ( msg:"PROTOCOL-ICMP Stacheldraht handler->agent niggahbitch"; icmp_id:9015; itype:0; content:"niggahbitch"; metadata:ruleset community; reference:cve,2000-0138; reference:url,staff.washington.edu/dittrich/misc/stacheldraht.analysis; classtype:attempted-dos; sid:1854; rev:13; )
alert icmp $EXTERNAL_NET any <> $HOME_NET any ( msg:"PROTOCOL-ICMP Stacheldraht agent->handler skillz"; icmp_id:6666; itype:0; content:"skillz"; metadata:ruleset community; reference:cve,2000-0138; reference:url,staff.washington.edu/dittrich/misc/stacheldraht.analysis; classtype:attempted-dos; sid:1855; rev:13; )
alert icmp $EXTERNAL_NET any <> $HOME_NET any ( msg:"PROTOCOL-ICMP Stacheldraht handler->agent ficken"; icmp_id:6667; itype:0; content:"ficken"; metadata:ruleset community; reference:cve,2000-0138; reference:url,staff.washington.edu/dittrich/misc/stacheldraht.analysis; classtype:attempted-dos; sid:1856; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9090 ( msg:"SERVER-WEBAPP Oracle JavaServer default password login attempt"; flow:to_server,established; content:"/servlet/admin"; content:"ae9f86d6beaa3f9ecb9a5b7e072a4138"; metadata:ruleset community; service:http; reference:nessus,10995; reference:url,attack.mitre.org/techniques/T1078; classtype:default-login-attempt; sid:1859; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 ( msg:"SERVER-WEBAPP Linksys router default password login attempt"; flow:to_server,established; http_header; content:"Authorization|3A|",nocase; pcre:"/^Authorization\x3a(\s*|\s*\r?\n\s+)Basic\s+OmFkbWlu/ims"; metadata:ruleset community; service:http; reference:nessus,10999; reference:url,attack.mitre.org/techniques/T1078; classtype:default-login-attempt; sid:1860; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 ( msg:"SERVER-WEBAPP Linksys router default username and password login attempt"; flow:to_server,established; content:"YWRtaW46YWRtaW4"; pcre:"/^Authorization\x3a\s*Basic\s+(?-i)YWRtaW46YWRtaW4[=\s]/ims"; metadata:ruleset community; service:http; reference:nessus,10999; reference:url,attack.mitre.org/techniques/T1078; classtype:default-login-attempt; sid:1861; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP SITE NEWER attempt"; flow:to_server,established; content:"SITE",nocase; content:"NEWER",distance 1,nocase; pcre:"/^SITE\s+NEWER/ims"; metadata:ruleset community; service:ftp; reference:cve,1999-0880; reference:nessus,10319; classtype:attempted-dos; sid:1864; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP USER overflow attempt"; flow:to_server,established; content:"USER"; isdataat:50,relative; pcre:"/^USER\s[^\n]{50}/ims"; metadata:policy max-detect-ips drop,ruleset community; service:pop3; reference:bugtraq,11256; reference:bugtraq,19651; reference:bugtraq,789; reference:cve,1999-0494; reference:cve,2002-1781; reference:cve,2006-2502; reference:cve,2006-4364; reference:cve,2007-4646; reference:nessus,10311; reference:url,www.delegate.org/mail-lists/delegate-en/1475; classtype:attempted-admin; gid:1; sid:1866; rev:26; )
alert udp $EXTERNAL_NET any -> $HOME_NET 177 ( msg:"X11 xdmcp info query"; flow:to_server; content:"|00 01 00 02 00 01 00|",fast_pattern,nocase; metadata:ruleset community; reference:nessus,10891; classtype:attempted-recon; sid:1867; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 ( msg:"SERVER-WEBAPP Interactive Story story.pl arbitrary file read attempt"; flow:to_server,established; http_uri; content:"/story.pl"; pkt_data; content:"next=../"; metadata:ruleset community; service:http; reference:bugtraq,3028; reference:cve,2001-0804; reference:nessus,10817; classtype:default-login-attempt; sid:1868; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 ( msg:"SERVER-WEBAPP Interactive Story story.pl access"; flow:to_server,established; http_uri; content:"/story.pl",fast_pattern,nocase; metadata:ruleset community; service:http; reference:bugtraq,3028; reference:cve,2001-0804; reference:nessus,10817; classtype:default-login-attempt; sid:1869; rev:13; )
alert ip $HOME_NET any -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE id check returned userid"; content:"uid=",nocase; content:" gid=",distance 0; pcre:"/uid=\d{1,5}\S+\s+gid=\d{1,5}/ims"; metadata:policy max-detect-ips drop,ruleset community; classtype:bad-unknown; sid:1882; rev:20; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 443 ( msg:"SERVER-OTHER OpenSSL Worm traffic"; flow:to_server,established; content:"TERM=xterm",fast_pattern,nocase; metadata:ruleset community; service:ssl; reference:url,www.cert.org/advisories/CA-2002-27.html; classtype:web-application-attack; sid:1887; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP SITE CPWD overflow attempt"; flow:to_server,established; content:"SITE",nocase; content:"CPWD",distance 0,nocase; isdataat:100,relative; pcre:"/^SITE\s+CPWD\s[^\n]{100}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,5427; reference:cve,2002-0826; classtype:misc-attack; sid:1888; rev:14; )
alert udp $EXTERNAL_NET 2002 -> $HOME_NET 2002 ( msg:"MALWARE-CNC slapper worm admin traffic"; content:"|00 00|E|00 00|E|00 00|@|00|",depth 10; metadata:ruleset community; reference:url,isc.incidents.org/analysis.html?id=167; reference:url,www.cert.org/advisories/CA-2002-27.html; classtype:trojan-activity; sid:1889; rev:10; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1024: ( msg:"PROTOCOL-RPC status GHBN format string attack"; flow:to_server; content:"|00 01 86 B8|",depth 4,offset 12; content:"|00 00 00 02|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"%x %x",within 256; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,1480; reference:cve,2000-0666; reference:nessus,10544; classtype:misc-attack; sid:1890; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: ( msg:"PROTOCOL-RPC status GHBN format string attack"; flow:to_server,established; content:"|00 01 86 B8|",depth 4,offset 16; content:"|00 00 00 02|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"%x %x",within 256; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,1480; reference:cve,2000-0666; reference:nessus,10544; classtype:misc-attack; sid:1891; rev:17; )
alert udp $EXTERNAL_NET any -> $HOME_NET 161 ( msg:"PROTOCOL-SNMP null community string attempt"; content:"|04 01 00|",depth 15,offset 5; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,2112; reference:bugtraq,8974; reference:cve,1999-0517; classtype:misc-attack; sid:1892; rev:14; )
alert udp $EXTERNAL_NET any -> $HOME_NET 161 ( msg:"PROTOCOL-SNMP missing community string attempt"; content:"0",depth 1; content:"|02|",within 6; content:"|04 00|",within 8; pcre:"/^\x30(\x84....|\x82..|[^\x80-\xFF])\x02(\x84\x00\x00\x00\x01.|\x82\x00\x01.|\x01.)\x04\x00/"; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,2112; reference:cve,1999-0517; classtype:misc-attack; sid:1893; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 749 ( msg:"INDICATOR-SHELLCODE kadmind buffer overflow attempt"; flow:to_server,established; content:"|00 C0 05 08 00 C0 05 08 00 C0 05 08 00 C0 05 08|",fast_pattern,nocase; metadata:ruleset community; reference:bugtraq,5731; reference:bugtraq,6024; reference:cve,2002-1226; reference:cve,2002-1235; reference:nessus,15015; reference:url,www.kb.cert.org/vuls/id/875073; classtype:shellcode-detect; sid:1894; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 751 ( msg:"INDICATOR-SHELLCODE kadmind buffer overflow attempt"; flow:to_server,established; content:"|00 C0 05 08 00 C0 05 08 00 C0 05 08 00 C0 05 08|",fast_pattern,nocase; metadata:ruleset community; reference:bugtraq,5731; reference:bugtraq,6024; reference:cve,2002-1226; reference:cve,2002-1235; reference:url,www.kb.cert.org/vuls/id/875073; classtype:shellcode-detect; sid:1895; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 749 ( msg:"INDICATOR-SHELLCODE kadmind buffer overflow attempt"; flow:to_server,established; content:"|FF FF|KADM0.0A|00 00 FB 03|"; metadata:ruleset community; reference:bugtraq,5731; reference:bugtraq,6024; reference:cve,2002-1226; reference:cve,2002-1235; reference:url,www.kb.cert.org/vuls/id/875073; classtype:shellcode-detect; sid:1896; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 751 ( msg:"INDICATOR-SHELLCODE kadmind buffer overflow attempt"; flow:to_server,established; content:"|FF FF|KADM0.0A|00 00 FB 03|"; metadata:ruleset community; reference:bugtraq,5731; reference:bugtraq,6024; reference:cve,2002-1226; reference:cve,2002-1235; reference:url,www.kb.cert.org/vuls/id/875073; classtype:shellcode-detect; sid:1897; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 749 ( msg:"INDICATOR-SHELLCODE kadmind buffer overflow attempt"; flow:to_server,established; content:"/shh//bi"; metadata:ruleset community; reference:bugtraq,5731; reference:bugtraq,6024; reference:cve,2002-1226; reference:cve,2002-1235; reference:url,www.kb.cert.org/vuls/id/875073; classtype:shellcode-detect; sid:1898; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 751 ( msg:"INDICATOR-SHELLCODE kadmind buffer overflow attempt"; flow:to_server,established; content:"/shh//bi"; metadata:ruleset community; reference:bugtraq,5731; reference:bugtraq,6024; reference:cve,2002-1226; reference:cve,2002-1235; reference:url,www.kb.cert.org/vuls/id/875073; classtype:shellcode-detect; sid:1899; rev:12; )
alert tcp $HOME_NET 749 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER successful kadmind buffer overflow attempt"; flow:to_client,established; content:"*GOBBLE*",depth 8; metadata:ruleset community; reference:bugtraq,5731; reference:bugtraq,6024; reference:cve,2002-1226; reference:cve,2002-1235; reference:url,www.kb.cert.org/vuls/id/875073; classtype:successful-admin; sid:1900; rev:15; )
alert tcp $HOME_NET 751 -> $EXTERNAL_NET any ( msg:"SERVER-OTHER successful kadmind buffer overflow attempt"; flow:to_client,established; content:"*GOBBLE*",depth 8; metadata:ruleset community; reference:bugtraq,5731; reference:bugtraq,6024; reference:cve,2002-1226; reference:cve,2002-1235; reference:url,www.kb.cert.org/vuls/id/875073; classtype:successful-admin; sid:1901; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP lsub literal overflow attempt"; flow:to_server,established; content:"LSUB",fast_pattern,nocase; pcre:"/\sLSUB\s[^\n]*?\s\{/ims"; byte_test:5,>,256,0,relative,string,dec; metadata:ruleset community; service:imap; reference:bugtraq,1110; reference:cve,2000-0284; reference:nessus,10374; classtype:misc-attack; sid:1902; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP rename overflow attempt"; flow:to_server,established; content:"RENAME",nocase; isdataat:100,relative; pcre:"/\sRENAME\s[^\n]{100}/ims"; metadata:ruleset community; service:imap; reference:bugtraq,1110; reference:cve,2000-0284; reference:nessus,10374; classtype:misc-attack; sid:1903; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP find overflow attempt"; flow:to_server,established; content:"FIND",nocase; isdataat:100,relative; pcre:"/^\sFIND\s[^\n]{100}/ims"; metadata:ruleset community; service:imap; reference:bugtraq,1110; reference:cve,2000-0284; reference:nessus,10374; classtype:misc-attack; sid:1904; rev:16; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500: ( msg:"PROTOCOL-RPC AMD UDP amqproc_mount plog overflow attempt"; flow:to_server; content:"|00 04 93 F3|",depth 4,offset 12; content:"|00 00 00 07|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,512,0,relative; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,614; reference:cve,1999-0704; classtype:misc-attack; sid:1905; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 500: ( msg:"PROTOCOL-RPC AMD TCP amqproc_mount plog overflow attempt"; flow:to_server,established; content:"|00 04 93 F3|",depth 4,offset 16; content:"|00 00 00 07|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,512,0,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,614; reference:cve,1999-0704; classtype:misc-attack; sid:1906; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC CMSD UDP CMSD_CREATE buffer overflow attempt"; flow:to_server; content:"|00 01 86 E4|",depth 4,offset 12; content:"|00 00 00 15|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,1024,0,relative; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,36615; reference:bugtraq,524; reference:cve,1999-0696; reference:cve,2009-3699; classtype:attempted-admin; sid:1907; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC CMSD TCP CMSD_CREATE buffer overflow attempt"; flow:to_server,established; content:"|00 01 86 E4|",depth 4,offset 16; content:"|00 00 00 15|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,1024,0,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,524; reference:cve,1999-0696; classtype:attempted-admin; sid:1908; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC CMSD TCP CMSD_INSERT buffer overflow attempt"; flow:to_server,established; content:"|00 01 86 E4|",depth 4,offset 16; content:"|00 00 00 06|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_jump:4,0,relative,align; byte_test:4,>,1000,28,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,524; reference:cve,1999-0696; reference:url,www.cert.org/advisories/CA-99-08-cmsd.html; classtype:misc-attack; sid:1909; rev:17; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC CMSD udp CMSD_INSERT buffer overflow attempt"; flow:to_server; content:"|00 01 86 E4|",depth 4,offset 12; content:"|00 00 00 06|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_jump:4,0,relative,align; byte_test:4,>,1000,28,relative; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:cve,1999-0696; reference:url,www.cert.org/advisories/CA-99-08-cmsd.html; classtype:misc-attack; sid:1910; rev:17; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC sadmind UDP NETMGT_PROC_SERVICE CLIENT_DOMAIN overflow attempt"; flow:to_server; content:"|00 01 87 88|",depth 4,offset 12; content:"|00 00 00 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_jump:4,124,relative,align; byte_jump:4,20,relative,align; byte_test:4,>,512,4,relative; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,866; reference:cve,1999-0977; classtype:attempted-admin; sid:1911; rev:20; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC sadmind TCP NETMGT_PROC_SERVICE CLIENT_DOMAIN overflow attempt"; flow:to_server,established; content:"|00 01 87 88|",depth 4,offset 16; content:"|00 00 00 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_jump:4,124,relative,align; byte_jump:4,20,relative,align; byte_test:4,>,512,4,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,0866; reference:bugtraq,866; reference:cve,1999-0977; classtype:attempted-admin; sid:1912; rev:16; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC STATD UDP stat mon_name format string exploit attempt"; flow:to_server; content:"|00 01 86 B8|",depth 4,offset 12; content:"|00 00 00 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,100,0,relative; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,1480; reference:cve,2000-0666; reference:nessus,10544; classtype:attempted-admin; sid:1913; rev:20; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC STATD TCP stat mon_name format string exploit attempt"; flow:to_server,established; content:"|00 01 86 B8|",depth 4,offset 16; content:"|00 00 00 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,100,0,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,1480; reference:cve,2000-0666; reference:nessus,10544; classtype:attempted-admin; sid:1914; rev:18; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC STATD UDP monitor mon_name format string exploit attempt"; flow:to_server; content:"|00 01 86 B8|",depth 4,offset 12; content:"|00 00 00 02|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,100,0,relative; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,1480; reference:cve,2000-0666; reference:nessus,10544; classtype:attempted-admin; sid:1915; rev:19; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC STATD TCP monitor mon_name format string exploit attempt"; flow:to_server,established; content:"|00 01 86 B8|",depth 4,offset 16; content:"|00 00 00 02|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,100,0,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,1480; reference:cve,2000-0666; reference:nessus,10544; classtype:attempted-admin; sid:1916; rev:17; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1900 ( msg:"INDICATOR-SCAN UPnP service discover attempt"; flow:to_server; content:"M-SEARCH ",depth 9; content:"ssdp|3A|discover",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:network-scan; sid:1917; rev:16; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-ICMP SolarWinds IP scan attempt"; icode:0; itype:8; content:"SolarWinds.Net",fast_pattern,nocase; metadata:ruleset community; classtype:network-scan; sid:1918; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP CWD overflow attempt"; flow:to_server,established; content:"CWD",nocase; isdataat:180,relative; pcre:"/^CWD(?!\n)\s[^\n]{180}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,11069; reference:bugtraq,1227; reference:bugtraq,1690; reference:bugtraq,6869; reference:bugtraq,7251; reference:bugtraq,7950; reference:cve,1999-0219; reference:cve,1999-1058; reference:cve,1999-1510; reference:cve,2000-1035; reference:cve,2000-1194; reference:cve,2001-0781; reference:cve,2002-0126; reference:cve,2002-0405; classtype:attempted-admin; sid:1919; rev:31; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP SITE NEWER overflow attempt"; flow:to_server,established; content:"SITE",nocase; content:"NEWER",distance 0,nocase; isdataat:100,relative; pcre:"/^SITE\s+NEWER\s[^\n]{100}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,229; reference:cve,1999-0800; classtype:attempted-admin; sid:1920; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP SITE ZIPCHK overflow attempt"; flow:to_server,established; content:"SITE",nocase; content:"ZIPCHK",distance 1,nocase; isdataat:100,relative; pcre:"/^SITE\s+ZIPCHK\s[^\n]{100}/ims"; metadata:ruleset community; service:ftp; reference:cve,2000-0040; classtype:attempted-admin; sid:1921; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap proxy attempt TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 05|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1922; rev:12; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap proxy attempt UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 05|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1923; rev:14; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC mountd UDP export request"; flow:to_server; content:"|00 01 86 A5|",depth 4,offset 12; content:"|00 00 00 05|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; classtype:attempted-recon; sid:1924; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC mountd TCP exportall request"; flow:to_server,established; content:"|00 01 86 A5|",depth 4,offset 16; content:"|00 00 00 06|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; classtype:attempted-recon; sid:1925; rev:12; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC mountd UDP exportall request"; flow:to_server; content:"|00 01 86 A5|",depth 4,offset 12; content:"|00 00 00 06|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; classtype:attempted-recon; sid:1926; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP authorized_keys"; flow:to_server,established; content:"authorized_keys",fast_pattern,nocase; metadata:ruleset community; service:ftp; classtype:suspicious-filename-detect; sid:1927; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP shadow retrieval attempt"; flow:to_server,established; content:"RETR",nocase; content:"shadow"; pcre:"/^RETR[^\n]*shadow$/ims"; metadata:ruleset community; service:ftp; classtype:suspicious-filename-detect; sid:1928; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP auth literal overflow attempt"; flow:to_server,established; content:"AUTH",fast_pattern,nocase; pcre:"/({(?=\d+}[^\n]*?\sAUTH)|AUTH\s[^\n]*?{(?=\d+}))/ims"; byte_test:5,>,256,0,relative,string,dec; metadata:policy max-detect-ips drop,ruleset community; service:imap; reference:bugtraq,21724; reference:cve,1999-0005; reference:cve,2006-6424; classtype:misc-attack; sid:1930; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP AUTH overflow attempt"; flow:to_server,established; content:"AUTH",nocase; isdataat:50,relative; pcre:"/^AUTH\s[^\n]{50}/ims"; metadata:ruleset community; service:pop3; reference:bugtraq,830; reference:cve,1999-0822; reference:nessus,10184; classtype:attempted-admin; sid:1936; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP LIST overflow attempt"; flow:to_server,established; content:"LIST",nocase; isdataat:10,relative; pcre:"/^LIST\s[^\n]{10}/ims"; metadata:ruleset community; service:pop3; reference:bugtraq,948; reference:cve,2000-0096; reference:nessus,10197; classtype:attempted-admin; sid:1937; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP XTND overflow attempt"; flow:to_server,established; content:"XTND",nocase; isdataat:50,relative; pcre:"/^XTND\s[^\n]{50}/ims"; metadata:ruleset community; service:pop3; classtype:attempted-admin; sid:1938; rev:10; )
alert udp $EXTERNAL_NET any -> $HOME_NET 67 ( msg:"SERVER-OTHER bootp hardware address length overflow"; flow:to_server; content:"|01|",depth 1; byte_test:1,>,6,2; metadata:policy max-detect-ips drop,ruleset community; reference:cve,1999-0798; classtype:misc-activity; sid:1939; rev:10; )
alert udp $EXTERNAL_NET any -> $HOME_NET 67 ( msg:"SERVER-OTHER bootp invalid hardware type"; flow:to_server; content:"|01|",depth 1; byte_test:1,>,7,1; metadata:policy max-detect-ips drop,ruleset community; reference:cve,1999-0798; classtype:misc-activity; sid:1940; rev:9; )
alert udp any any -> any 69 ( msg:"PROTOCOL-TFTP GET filename overflow attempt"; flow:to_server; content:"|00 01|",depth 2; isdataat:100,relative; content:!"|00|",within 100; metadata:policy max-detect-ips drop,ruleset community; service:tftp; reference:bugtraq,20131; reference:bugtraq,22923; reference:bugtraq,36121; reference:bugtraq,5328; reference:cve,2002-0813; reference:cve,2006-4948; reference:cve,2007-1435; reference:cve,2009-2957; reference:cve,2009-2958; reference:nessus,18264; classtype:attempted-admin; sid:1941; rev:24; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP RMDIR overflow attempt"; flow:to_server,established; content:"RMDIR",nocase; isdataat:100,relative; pcre:"/^RMDIR(?!\n)\s[^\n]{100}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,819; classtype:attempted-admin; sid:1942; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8888 ( msg:"SERVER-WEBAPP answerbook2 admin attempt"; flow:to_server,established; content:"/cgi-bin/admin/admin"; metadata:ruleset community; service:http; reference:bugtraq,5383; reference:cve,2000-0696; classtype:web-application-activity; sid:1946; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8888 ( msg:"SERVER-WEBAPP answerbook2 arbitrary command execution attempt"; flow:to_server,established; content:"/ab2/"; content:"|3B|",distance 1; metadata:ruleset community; service:http; reference:bugtraq,1556; reference:cve,2000-0697; classtype:web-application-attack; sid:1947; rev:15; )
alert udp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS dns zone transfer via UDP detected"; flow:to_server; content:"|00 01 00 00 00 00 00|",depth 8,offset 4; byte_test:1,!&,0xF8,2; content:"|00 00 FC 00 01|",fast_pattern; isdataat:!1,relative; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:cve,1999-0532; reference:nessus,10595; classtype:attempted-recon; sid:1948; rev:20; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap SET attempt TCP 111"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 01|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1949; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap SET attempt UDP 111"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 01|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1950; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC mountd TCP mount request"; flow:to_server,established; content:"|00 01 86 A5|",depth 4,offset 16; content:"|00 00 00 01|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:cve,1999-0210; classtype:attempted-recon; sid:1951; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC mountd UDP mount request"; flow:to_server; content:"|00 01 86 A5|",depth 4,offset 12; content:"|00 00 00 01|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; classtype:attempted-recon; sid:1952; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 500: ( msg:"PROTOCOL-RPC AMD TCP pid request"; flow:to_server,established; content:"|00 04 93 F3|",depth 4,offset 16; content:"|00 00 00 09|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; classtype:rpc-portmap-decode; sid:1953; rev:10; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500: ( msg:"PROTOCOL-RPC AMD UDP pid request"; flow:to_server; content:"|00 04 93 F3|",depth 4,offset 12; content:"|00 00 00 09|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; classtype:rpc-portmap-decode; sid:1954; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 500: ( msg:"PROTOCOL-RPC AMD TCP version request"; flow:to_server,established; content:"|00 04 93 F3|",depth 4,offset 16; content:"|00 00 00 08|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; classtype:rpc-portmap-decode; sid:1955; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500: ( msg:"PROTOCOL-RPC AMD UDP version request"; flow:to_server; content:"|00 04 93 F3|",depth 4,offset 12; content:"|00 00 00 08|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,1554; reference:cve,2000-0696; classtype:rpc-portmap-decode; sid:1956; rev:15; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC sadmind UDP PING"; content:"|00 01 87 88|",depth 4,offset 12; content:"|00 00 00 00|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,866; reference:cve,1999-0977; reference:nessus,10229; classtype:protocol-command-decode; sid:1957; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC sadmind TCP PING"; flow:to_server,established; content:"|00 01 87 88|",depth 4,offset 16; content:"|00 00 00 00|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,866; reference:cve,1999-0977; reference:nessus,10229; classtype:protocol-command-decode; sid:1958; rev:15; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap NFS request UDP"; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 A3|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1959; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap NFS request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 A3|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1960; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap RQUOTA request UDP"; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 AB|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1961; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap RQUOTA request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 AB|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1962; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC RQUOTA getquota overflow attempt UDP"; content:"|00 01 86 AB|",depth 4,offset 12; content:"|00 00 00 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,128,0,relative; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,864; reference:cve,1999-0974; classtype:misc-attack; sid:1963; rev:15; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC tooltalk UDP overflow attempt"; flow:to_server; content:"|00 01 86 F3|",depth 4,offset 12; content:"|00 00 00 07|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,128,0,relative; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,122; reference:cve,1999-0003; classtype:attempted-admin; sid:1964; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC tooltalk TCP overflow attempt"; flow:to_server,established; content:"|00 01 86 F3|",depth 4,offset 16; content:"|00 00 00 07|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,128,0,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,122; reference:cve,1999-0003; reference:cve,2001-0717; classtype:attempted-admin; sid:1965; rev:17; )
alert udp $EXTERNAL_NET any -> 255.255.255.255 27155 ( msg:"SERVER-OTHER GlobalSunTech Access Point Information Disclosure attempt"; flow:to_server; content:"gstsearch",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,6100; reference:cve,2002-2137; classtype:misc-activity; sid:1966; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP SITE EXEC format string attempt"; flow:to_server,established; content:"SITE",nocase; content:"EXEC",distance 0,nocase; pcre:"/^SITE\s+EXEC\s[^\n]*?%[^\n]*?%/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,1387; reference:bugtraq,1505; reference:cve,2000-0573; classtype:bad-unknown; sid:1971; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP PASS overflow attempt"; flow:to_server,established; content:"PASS",nocase; isdataat:100,relative; pcre:"/^PASS(?!\n)\s[^\n]{100}/ims"; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:bugtraq,10078; reference:bugtraq,10720; reference:bugtraq,15457; reference:bugtraq,1690; reference:bugtraq,22045; reference:bugtraq,3884; reference:bugtraq,45957; reference:bugtraq,8601; reference:bugtraq,9285; reference:cve,1999-1519; reference:cve,1999-1539; reference:cve,2000-1035; reference:cve,2002-0126; reference:cve,2002-0895; reference:cve,2005-3683; reference:cve,2006-6576; classtype:attempted-admin; sid:1972; rev:32; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP MKD overflow attempt"; flow:to_server,established; content:"MKD",nocase; isdataat:150,relative; pcre:"/^MKD(?!\n)\s[^\n]{150}/ims"; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:bugtraq,11772; reference:bugtraq,15457; reference:bugtraq,39041; reference:bugtraq,612; reference:bugtraq,7278; reference:bugtraq,9872; reference:cve,1999-0911; reference:cve,2004-1135; reference:cve,2005-3683; reference:cve,2009-3023; reference:cve,2010-0625; reference:nessus,12108; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-053; reference:url,www.kb.cert.org/vuls/id/276653; classtype:attempted-admin; sid:1973; rev:31; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP REST overflow attempt"; flow:to_server,established; content:"REST",nocase; isdataat:100,relative; pcre:"/^REST(?!\n)\s[^\n]{100}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,2972; reference:cve,2001-0826; reference:nessus,11755; classtype:attempted-admin; sid:1974; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP DELE overflow attempt"; flow:to_server,established; content:"DELE",nocase; isdataat:100,relative; pcre:"/^DELE(?!\n)\s[^\n]{100}/im"; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:bugtraq,15457; reference:bugtraq,2972; reference:bugtraq,46922; reference:cve,2001-0826; reference:cve,2001-1021; reference:cve,2005-3683; reference:cve,2010-4228; reference:nessus,11755; classtype:attempted-admin; sid:1975; rev:27; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP RMD overflow attempt"; flow:to_server,established; content:"RMD",nocase; isdataat:100,relative; pcre:"/^RMD(?!\n)\s[^\n]{100}/ims"; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:bugtraq,15457; reference:bugtraq,2972; reference:bugtraq,39041; reference:cve,2000-0133; reference:cve,2001-0826; reference:cve,2001-1021; reference:cve,2005-3683; reference:cve,2010-0625; classtype:attempted-admin; sid:1976; rev:23; )
alert udp $EXTERNAL_NET any -> $HOME_NET 2140 ( msg:"MALWARE-BACKDOOR DeepThroat 3.1 Connection"; flow:to_server; content:"00",depth 2; metadata:policy max-detect-ips drop,ruleset community; reference:nessus,10053; classtype:trojan-activity; sid:1980; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET 3150 ( msg:"MALWARE-BACKDOOR DeepThroat 3.1 Connection attempt on port 3150"; flow:to_server; content:"00",depth 2; metadata:ruleset community; reference:nessus,10053; classtype:trojan-activity; sid:1981; rev:12; )
alert udp $HOME_NET 3150 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR DeepThroat 3.1 Server Response on port 3150"; flow:to_client; content:"Ahhhh My Mouth Is Open"; metadata:ruleset community; reference:nessus,10053; classtype:trojan-activity; sid:1982; rev:12; )
alert udp $EXTERNAL_NET any -> $HOME_NET 4120 ( msg:"MALWARE-BACKDOOR DeepThroat 3.1 Connection attempt on port 4120"; flow:to_server; content:"00",depth 2; metadata:ruleset community; reference:nessus,10053; classtype:trojan-activity; sid:1983; rev:11; )
alert udp $HOME_NET 4120 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR DeepThroat 3.1 Server Response on port 4120"; flow:to_client; content:"Ahhhh My Mouth Is Open"; metadata:ruleset community; reference:nessus,10053; classtype:trojan-activity; sid:1984; rev:12; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Doly variant outbound connection attempt"; flow:to_client,established; content:"* Doly trojan v1.5 - Connected.",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:http; reference:url,virustotal.com/en/file/499446edf3dfd200ebf3df2526cd4d101979e626afcd1860193f71829be23922/; classtype:trojan-activity; sid:1985; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 1863 ( msg:"POLICY-SOCIAL Microsoft MSN outbound file transfer request"; flow:established; content:"MSG ",depth 4; content:"Content-Type|3A| application/x-msnmsgrp2p",nocase; content:"INVITE",distance 0,nocase; metadata:ruleset community; classtype:policy-violation; sid:1986; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7100 ( msg:"SERVER-OTHER xfs overflow attempt"; flow:to_server,established; isdataat:512; content:"B|00 02|",depth 3; metadata:ruleset community; reference:bugtraq,6241; reference:cve,2002-1317; reference:nessus,11188; classtype:misc-activity; sid:1987; rev:11; )
alert tcp $EXTERNAL_NET 1863 -> $HOME_NET any ( msg:"POLICY-SOCIAL Microsoft MSN outbound file transfer accept"; flow:established; content:"MSG ",depth 4; content:"Content-Type|3A| application/x-msnmsgrp2p",distance 0,nocase; content:"MSNSLP/1.0 200 OK",distance 0,nocase; metadata:ruleset community; classtype:policy-violation; sid:1988; rev:11; )
alert tcp $EXTERNAL_NET 1863 -> $HOME_NET any ( msg:"POLICY-SOCIAL Microsoft MSN outbound file transfer rejected"; flow:established; content:"MSG ",depth 4; content:"Content-Type|3A| application/x-msnmsgrp2p",distance 0,nocase; content:"MSNSLP/1.0 603 Decline",distance 0,nocase; metadata:ruleset community; classtype:policy-violation; sid:1989; rev:12; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 1863 ( msg:"POLICY-SOCIAL Microsoft MSN user search"; flow:to_server,established; content:"CAL ",depth 4,nocase; metadata:ruleset community; classtype:policy-violation; sid:1990; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 1863 ( msg:"POLICY-SOCIAL Microsoft MSN login attempt"; flow:to_server,established; content:"USR ",depth 4,nocase; content:" TWN ",distance 1,nocase; metadata:ruleset community; classtype:policy-violation; sid:1991; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP LIST directory traversal attempt"; flow:to_server,established; content:"LIST",nocase; content:"..",distance 1; content:"..",distance 1; metadata:ruleset community; service:ftp; reference:bugtraq,2618; reference:cve,2001-0680; reference:cve,2002-1054; reference:nessus,11112; classtype:protocol-command-decode; sid:1992; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP login literal buffer overflow attempt"; flow:to_server,established; pcre:"/\sLOGIN\s[^\n]*?\{\s*(-|[3-9][0-9]{2}|2[6-9][0-9]|25[7-9]|[0-9]{4})/ims"; content:"LOGIN",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:imap; reference:bugtraq,14718; reference:bugtraq,21724; reference:bugtraq,23810; reference:bugtraq,6298; reference:cve,2002-1580; reference:cve,2005-1758; reference:cve,2006-6424; reference:cve,2007-0221; reference:nessus,12532; classtype:misc-attack; sid:1993; rev:24; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1434 ( msg:"SQL Worm propagation attempt"; flow:to_server; content:"|04|",depth 1; content:"|81 F1 03 01 04 9B 81 F1 01|",fast_pattern,nocase; content:"sock"; content:"send"; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,5310; reference:bugtraq,5311; reference:cve,2002-0649; reference:nessus,11214; reference:url,vil.nai.com/vil/content/v_99992.htm; classtype:misc-attack; sid:2003; rev:16; )
alert udp $HOME_NET any -> $EXTERNAL_NET 1434 ( msg:"SQL Worm propagation attempt OUTBOUND"; flow:to_server; content:"|04|",depth 1; content:"|81 F1 03 01 04 9B 81 F1|",fast_pattern,nocase; content:"sock"; content:"send"; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,5310; reference:bugtraq,5311; reference:cve,2002-0649; reference:nessus,11214; reference:url,vil.nai.com/vil/content/v_99992.htm; classtype:misc-attack; sid:2004; rev:15; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap kcms_server request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 87|}",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,6665; reference:cve,2003-0027; reference:url,www.kb.cert.org/vuls/id/850785; classtype:rpc-portmap-decode; sid:2005; rev:22; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap kcms_server request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 87|}",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; reference:bugtraq,6665; reference:cve,2003-0027; reference:url,www.kb.cert.org/vuls/id/850785; classtype:rpc-portmap-decode; sid:2006; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 32771:34000 ( msg:"PROTOCOL-RPC kcms_server directory traversal attempt"; flow:to_server,established; content:"|00 01 87|}",depth 4,offset 16; byte_jump:4,20,relative,align; byte_jump:4,4,relative,align; content:"/../",distance 0; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; reference:bugtraq,6665; reference:cve,2003-0027; reference:url,www.kb.cert.org/vuls/id/850785; classtype:misc-attack; sid:2007; rev:16; )
alert tcp $HOME_NET 2401 -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE CVS invalid user authentication response"; flow:to_client,established; content:"E Fatal error, aborting.",fast_pattern,nocase; content:"|3A| no such user"; metadata:ruleset community; classtype:misc-attack; sid:2008; rev:9; )
alert tcp $HOME_NET 2401 -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE CVS invalid repository response"; flow:to_client,established; content:"error "; content:"|3A| no such repository"; content:"I HATE YOU",fast_pattern,nocase; metadata:ruleset community; classtype:misc-attack; sid:2009; rev:7; )
alert tcp $HOME_NET 2401 -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE CVS double free exploit attempt response"; flow:to_client,established; content:"free|28 29 3A| warning|3A| chunk is already free",fast_pattern,nocase; metadata:ruleset community; reference:bugtraq,6650; reference:cve,2003-0015; reference:nessus,11385; classtype:misc-attack; sid:2010; rev:12; )
alert tcp $HOME_NET 2401 -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE CVS invalid directory response"; flow:to_client,established; content:"E protocol error|3A| invalid directory syntax in",fast_pattern,nocase; metadata:ruleset community; reference:bugtraq,6650; reference:cve,2003-0015; reference:nessus,11385; classtype:misc-attack; sid:2011; rev:12; )
alert tcp $HOME_NET 2401 -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE CVS missing cvsroot response"; flow:to_client,established; content:"E protocol error|3A| Root request missing",fast_pattern,nocase; metadata:ruleset community; classtype:misc-attack; sid:2012; rev:7; )
alert tcp $HOME_NET 2401 -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE CVS invalid module response"; flow:to_client,established; content:"cvs server|3A| cannot find module",fast_pattern,nocase; content:"error"; metadata:ruleset community; classtype:misc-attack; sid:2013; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap UNSET attempt TCP 111"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 02|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; reference:bugtraq,1892; classtype:rpc-portmap-decode; sid:2014; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap UNSET attempt UDP 111"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 02|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,1892; reference:cve,2011-0321; classtype:rpc-portmap-decode; sid:2015; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap status request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 B8|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:2016; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap espd request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 05 F7|u",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,2714; reference:cve,2001-0331; classtype:rpc-portmap-decode; sid:2017; rev:20; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC mountd TCP dump request"; flow:to_server,established; content:"|00 01 86 A5|",depth 4,offset 16; content:"|00 00 00 02|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; classtype:attempted-recon; sid:2018; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC mountd UDP dump request"; flow:to_server; content:"|00 01 86 A5|",depth 4,offset 12; content:"|00 00 00 02|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; classtype:attempted-recon; sid:2019; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC mountd TCP unmount request"; flow:to_server,established; content:"|00 01 86 A5|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; classtype:attempted-recon; sid:2020; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC mountd UDP unmount request"; flow:to_server; content:"|00 01 86 A5|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; classtype:attempted-recon; sid:2021; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC mountd TCP unmountall request"; flow:to_server,established; content:"|00 01 86 A5|",depth 4,offset 16; content:"|00 00 00 04|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; classtype:attempted-recon; sid:2022; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC mountd UDP unmountall request"; flow:to_server; content:"|00 01 86 A5|",depth 4,offset 12; content:"|00 00 00 04|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; classtype:attempted-recon; sid:2023; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC RQUOTA getquota overflow attempt TCP"; flow:to_server,established; content:"|00 01 86 AB|",depth 4,offset 16; content:"|00 00 00 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,128,0,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,864; reference:cve,1999-0974; classtype:misc-attack; sid:2024; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC yppasswd username overflow attempt UDP"; flow:to_server; content:"|00 01 86 A9|",depth 4,offset 12; content:"|00 00 00 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_jump:4,0,relative,align; byte_test:4,>,64,0,relative; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,2763; reference:cve,2001-0779; reference:nessus,10684; classtype:rpc-portmap-decode; sid:2025; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC yppasswd username overflow attempt TCP"; flow:to_server,established; content:"|00 01 86 A9|",depth 4,offset 16; content:"|00 00 00 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_jump:4,0,relative,align; byte_test:4,>,64,0,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,2763; reference:cve,2001-0779; reference:nessus,10684; classtype:rpc-portmap-decode; sid:2026; rev:15; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC yppasswd old password overflow attempt UDP"; flow:to_server; content:"|00 01 86 A9|",depth 4,offset 12; content:"|00 00 00 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,64,0,relative; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,2763; reference:cve,2001-0779; classtype:rpc-portmap-decode; sid:2027; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC yppasswd old password overflow attempt TCP"; flow:to_server,established; content:"|00 01 86 A9|",depth 4,offset 16; content:"|00 00 00 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,64,0,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,2763; reference:cve,2001-0779; classtype:rpc-portmap-decode; sid:2028; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC yppasswd new password overflow attempt UDP"; flow:to_server; content:"|00 01 86 A9|",depth 4,offset 12; content:"|00 00 00 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_jump:4,0,relative,align; byte_jump:4,0,relative,align; byte_test:4,>,64,0,relative; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,2763; reference:cve,2001-0779; classtype:rpc-portmap-decode; sid:2029; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC yppasswd new password overflow attempt TCP"; flow:to_server,established; content:"|00 01 86 A9|",depth 4,offset 16; content:"|00 00 00 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_jump:4,0,relative,align; byte_jump:4,0,relative,align; byte_test:4,>,64,0,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,2763; reference:cve,2001-0779; classtype:rpc-portmap-decode; sid:2030; rev:12; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC yppasswd user update UDP"; flow:to_server; content:"|00 01 86 A9|",depth 4,offset 12; content:"|00 00 00 01|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,2763; reference:cve,2001-0779; classtype:rpc-portmap-decode; sid:2031; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC yppasswd user update TCP"; flow:to_server,established; content:"|00 01 86 A9|",depth 4,offset 16; content:"|00 00 00 01|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,2763; reference:cve,2001-0779; classtype:rpc-portmap-decode; sid:2032; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC ypserv maplist request UDP"; flow:to_server; content:"|00 01 86 A4|",depth 4,offset 12; content:"|00 00 00 0B|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,5914; reference:bugtraq,6016; reference:cve,2002-1232; reference:nessus,13976; classtype:rpc-portmap-decode; sid:2033; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC ypserv maplist request TCP"; flow:to_server,established; content:"|00 01 86 A4|",depth 4,offset 16; content:"|00 00 00 0B|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,5914; reference:bugtraq,6016; reference:cve,2002-1232; classtype:rpc-portmap-decode; sid:2034; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap network-status-monitor request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 03 0D|p",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:2035; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap network-status-monitor request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 03 0D|p",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:2036; rev:12; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC network-status-monitor mon-callback request UDP"; flow:to_server; content:"|00 03 0D|p",depth 4,offset 12; content:"|00 00 00 01|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; classtype:rpc-portmap-decode; sid:2037; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC network-status-monitor mon-callback request TCP"; flow:to_server,established; content:"|00 03 0D|p",depth 4,offset 16; content:"|00 00 00 01|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; classtype:rpc-portmap-decode; sid:2038; rev:10; )
alert udp $EXTERNAL_NET any -> $HOME_NET 67 ( msg:"SERVER-OTHER bootp hostname format string attempt"; flow:to_server; content:"|01|",depth 1; content:"|0C|",distance 240; content:"%",distance 0; content:"%",within 8,distance 1; content:"%",within 8,distance 1; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,4701; reference:cve,2002-0702; reference:nessus,11312; classtype:misc-attack; sid:2039; rev:12; )
alert udp $EXTERNAL_NET any -> $HOME_NET 49 ( msg:"POLICY-OTHER xtacacs login attempt"; flow:to_server; content:"|80 01|",depth 2; content:"|00|",distance 4; metadata:ruleset community; classtype:misc-activity; sid:2040; rev:9; )
alert udp $HOME_NET 49 -> $EXTERNAL_NET any ( msg:"INDICATOR-SCAN xtacacs failed login response"; flow:to_client; content:"|80 02|",depth 2; content:"|02|",distance 4; metadata:policy max-detect-ips drop,ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:misc-activity; sid:2041; rev:9; )
alert udp $HOME_NET 49 -> $EXTERNAL_NET any ( msg:"POLICY-OTHER xtacacs accepted login response"; flow:to_client; content:"|80 02|",depth 2; content:"|01|",distance 4; metadata:ruleset community; classtype:misc-activity; sid:2042; rev:9; )
alert udp $HOME_NET 500 -> $EXTERNAL_NET 500 ( msg:"INDICATOR-SCAN isakmp login failed"; content:"|10 05|",depth 2,offset 17; content:"|00 00 00 01 01 00 00 18|",within 8,distance 13; metadata:policy max-detect-ips drop,ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:misc-activity; sid:2043; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1723 ( msg:"POLICY-OTHER PPTP Start Control Request attempt"; flow:to_server,established,no_stream; content:"|00 01|",depth 2,offset 2; content:"|00 01|",depth 2,offset 8; metadata:ruleset community; classtype:attempted-admin; sid:2044; rev:8; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC snmpXdmi overflow attempt UDP"; flow:to_server; content:"|00 01 87 99|",depth 4,offset 12; content:"|00 00 01 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,1024,20,relative; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,2417; reference:cve,2001-0236; reference:nessus,10659; reference:url,www.cert.org/advisories/CA-2001-05.html; classtype:attempted-admin; sid:2045; rev:21; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP partial body.peek buffer overflow attempt"; flow:to_server,established; content:"PARTIAL",nocase; content:"BODY.PEEK[",distance 0,nocase; pcre:"/\sPARTIAL.*BODY\.PEEK\[[^\]]{1024}/ims"; metadata:ruleset community; service:imap; reference:bugtraq,4713; reference:cve,2002-0379; reference:nessus,10966; classtype:misc-attack; sid:2046; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 873 ( msg:"SERVER-OTHER rsyncd module list access"; flow:to_server,established; content:"|23|list",depth 5; metadata:ruleset community; classtype:misc-activity; sid:2047; rev:5; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1434 ( msg:"SQL ping attempt"; flow:to_server; content:"|02|",depth 1; metadata:policy max-detect-ips drop,ruleset community; reference:nessus,10674; classtype:misc-activity; sid:2049; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1434 ( msg:"SERVER-MSSQL version overflow attempt"; flow:to_server; dsize:>100; content:"|04|",depth 1; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,5310; reference:cve,2002-0649; reference:nessus,10674; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-039; classtype:attempted-admin; sid:2050; rev:19; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap nlockmgr request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 B5|",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,1372; reference:cve,2000-0508; reference:nessus,10220; classtype:rpc-portmap-decode; sid:2079; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap nlockmgr request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 01 86 B5|",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; reference:bugtraq,1372; reference:cve,2000-0508; reference:nessus,10220; classtype:rpc-portmap-decode; sid:2080; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap rpc.xfsmd request UDP"; flow:to_server; content:"|00 01 86 A0|",depth 4,offset 12; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 05 F7|h",within 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,5072; reference:bugtraq,5075; reference:cve,2002-0359; classtype:rpc-portmap-decode; sid:2081; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap rpc.xfsmd request TCP"; flow:to_server,established; content:"|00 01 86 A0|",depth 4,offset 16; content:"|00 00 00 03|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|00 05 F7|h",within 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; service:sunrpc; reference:bugtraq,5072; reference:bugtraq,5075; reference:cve,2002-0359; classtype:rpc-portmap-decode; sid:2082; rev:15; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC rpc.xfsmd xfs_export attempt UDP"; flow:to_server; content:"|00 05 F7|h",depth 4,offset 12; content:"|00 00 00 0D|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,5072; reference:bugtraq,5075; reference:cve,2002-0359; classtype:rpc-portmap-decode; sid:2083; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC rpc.xfsmd xfs_export attempt TCP"; flow:to_server,established; content:"|00 05 F7|h",depth 4,offset 16; content:"|00 00 00 0D|",within 4,distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,5072; reference:bugtraq,5075; reference:cve,2002-0359; classtype:rpc-portmap-decode; sid:2084; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC ypupdated arbitrary command attempt UDP"; content:"|00 01 86 BC|",depth 4,offset 12; content:"|00 00 00 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|7C|",distance 4; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,1749; reference:bugtraq,28383; reference:cve,1999-0208; classtype:misc-attack; sid:2088; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC ypupdated arbitrary command attempt TCP"; flow:to_server,established; content:"|00 01 86 BC|",depth 4,offset 16; content:"|00 00 00 01|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; content:"|7C|",distance 4; content:"|00 00 00 00|",depth 4,offset 8; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,1749; reference:cve,1999-0208; classtype:misc-attack; sid:2089; rev:16; )
alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap proxy integer overflow attempt UDP"; flow:to_server; content:"|00 01 86 A0 00|",depth 5,offset 12; content:"|00 00 00 05|",within 4,distance 3; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,2048,12,relative; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,36564; reference:bugtraq,7123; reference:cve,2003-0028; reference:nessus,11420; classtype:rpc-portmap-decode; sid:2092; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:"PROTOCOL-RPC portmap proxy integer overflow attempt TCP"; flow:to_server,established; content:"|00 01 86 A0 00|",depth 5,offset 16; content:"|00 00 00 05|",within 4,distance 3; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,2048,12,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,7123; reference:cve,2003-0028; reference:nessus,11420; classtype:rpc-portmap-decode; sid:2093; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC CMSD UDP CMSD_CREATE array buffer overflow attempt"; flow:to_server; content:"|00 01 86 E4|",depth 4,offset 12; content:"|00 00 00 15|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,1024,20,relative; content:"|00 00 00 00|",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; reference:bugtraq,36615; reference:bugtraq,5356; reference:cve,2002-0391; reference:cve,2009-3699; reference:nessus,11418; classtype:attempted-admin; sid:2094; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC CMSD TCP CMSD_CREATE array buffer overflow attempt"; flow:to_server,established; content:"|00 01 86 E4|",depth 4,offset 16; content:"|00 00 00 15|",within 4,distance 4; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,1024,20,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,5356; reference:cve,2002-0391; reference:nessus,11418; classtype:attempted-admin; sid:2095; rev:14; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR SubSeven 2.1 Gold server connection response"; flow:to_client,established; content:"connected. time/date|3A| ",depth 22; content:"version|3A| GOLD 2.1",distance 1; metadata:ruleset community; reference:nessus,10409; classtype:trojan-activity; sid:2100; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"OS-WINDOWS Microsoft Windows SMB Trans Max Param/Count OS-WINDOWS attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB%",within 5,distance 3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/Rs"; content:"|00 00 00 00|",within 4,distance 5; metadata:ruleset community; reference:bugtraq,5556; reference:cve,2002-0724; reference:nessus,11110; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-045; reference:url,www.corest.com/common/showdoc.php?idx=262; classtype:protocol-command-decode; sid:2101; rev:23; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB Trans2 OPEN2 unicode maximum param count overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB2",within 5,distance 3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/Rs"; content:"|00 00|",within 2,distance 29; byte_test:2,>,1024,-12,relative,little; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:cve,2003-0201; classtype:protocol-command-decode; sid:2103; rev:17; )
alert tcp $HOME_NET 512 -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE rexec username too long response"; flow:to_client,established; content:"username too long",depth 17; metadata:ruleset community; reference:bugtraq,7459; reference:cve,2003-1097; classtype:unsuccessful-user; sid:2104; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP authenticate literal overflow attempt"; flow:to_server,established; content:"AUTHENTICATE",fast_pattern,nocase; pcre:"/\sAUTHENTICATE\s[^\n]*?\{/ims"; byte_test:5,>,256,0,relative,string,dec; metadata:policy max-detect-ips drop,ruleset community; service:imap; reference:bugtraq,21724; reference:cve,1999-0042; reference:cve,2006-6424; reference:nessus,10292; classtype:misc-attack; sid:2105; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP lsub overflow attempt"; flow:to_server,established; content:"LSUB"; isdataat:100,relative; pcre:"/\sLSUB\s[^\n]{100}/ims"; metadata:policy max-detect-ips drop,ruleset community; service:imap; reference:bugtraq,1110; reference:bugtraq,15006; reference:cve,2000-0284; reference:cve,2005-3155; reference:nessus,10374; classtype:misc-attack; sid:2106; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP create buffer overflow attempt"; flow:to_server,established; content:"CREATE"; isdataat:1024,relative; pcre:"/\sCREATE\s[^\n]{1024}/ims"; metadata:ruleset community; service:imap; reference:bugtraq,7446; reference:cve,2003-1470; classtype:misc-attack; sid:2107; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP CAPA overflow attempt"; flow:to_server,established; content:"CAPA",nocase; isdataat:10,relative; pcre:"/^CAPA\s[^\n]{10}/ims"; metadata:ruleset community; service:pop3; classtype:attempted-admin; sid:2108; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP TOP overflow attempt"; flow:to_server,established; content:"TOP",nocase; isdataat:50,relative; pcre:"/^TOP\s[^\n]{50}/ims"; metadata:ruleset community; service:pop3; classtype:attempted-admin; sid:2109; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP STAT overflow attempt"; flow:to_server,established; content:"STAT",nocase; isdataat:10,relative; pcre:"/^STAT\s[^\n]{10}/ims"; metadata:ruleset community; service:pop3; classtype:attempted-admin; sid:2110; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP DELE overflow attempt"; flow:to_server,established; content:"DELE",nocase; isdataat:10,relative; pcre:"/^DELE\s[^\n]{10}/ims"; metadata:ruleset community; service:pop3; classtype:attempted-admin; sid:2111; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP RSET overflow attempt"; flow:to_server,established; content:"RSET",nocase; isdataat:10,relative; pcre:"/^RSET\s[^\n]{10}/ims"; metadata:ruleset community; service:pop3; classtype:attempted-admin; sid:2112; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 512 ( msg:"PROTOCOL-SERVICES rexec username overflow attempt"; flow:to_server,established; content:"|00|",offset 9; content:"|00|",distance 0; content:"|00|",distance 0; metadata:ruleset community; classtype:attempted-admin; sid:2113; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 512 ( msg:"PROTOCOL-SERVICES rexec password overflow attempt"; flow:to_server,established; content:"|00|"; content:"|00|",distance 33; content:"|00|",distance 0; metadata:ruleset community; classtype:attempted-admin; sid:2114; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP list overflow attempt"; flow:to_server,established; content:"LIST",nocase; isdataat:100,relative; pcre:"/\sLIST\s[^\n]{100}/ims"; metadata:policy max-detect-ips drop,ruleset community; service:imap; reference:bugtraq,1110; reference:bugtraq,15006; reference:cve,2000-0284; reference:cve,2005-3155; reference:nessus,10374; classtype:misc-attack; sid:2118; rev:19; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP rename literal overflow attempt"; flow:to_server,established; content:"RENAME",fast_pattern,nocase; pcre:"/\sRENAME\s[^\n]*?\s\{/ims"; byte_test:5,>,256,0,relative,string,dec; metadata:ruleset community; service:imap; reference:bugtraq,1110; reference:cve,2000-0284; reference:nessus,10374; classtype:misc-attack; sid:2119; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP create literal buffer overflow attempt"; flow:to_server,established; content:"CREATE",fast_pattern,nocase; pcre:"/\sCREATE\s*\{/ims"; byte_test:5,>,256,0,relative,string,dec; metadata:ruleset community; service:imap; reference:bugtraq,7446; reference:cve,2003-1470; classtype:misc-attack; sid:2120; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP DELE negative argument attempt"; flow:to_server,established; content:"DELE",fast_pattern,nocase; pcre:"/^DELE\s+-\d/ims"; metadata:ruleset community; service:pop3; reference:bugtraq,6053; reference:bugtraq,7445; reference:cve,2002-1539; reference:nessus,11570; classtype:misc-attack; sid:2121; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP UIDL negative argument attempt"; flow:to_server,established; content:"UIDL",fast_pattern,nocase; pcre:"/^UIDL\s+-\d/ims"; metadata:ruleset community; service:pop3; reference:bugtraq,6053; reference:cve,2002-1539; reference:nessus,11570; classtype:misc-attack; sid:2122; rev:17; )
alert tcp $HOME_NET !21:23 -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE Microsoft cmd.exe banner"; flow:established; content:"Microsoft Windows",depth 18; content:"|28|C|29| Copyright 1985-",distance 0; content:"Microsoft Corp.",distance 0; metadata:policy max-detect-ips drop,ruleset community; reference:nessus,11633; classtype:successful-admin; sid:2123; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 34012 ( msg:"MALWARE-BACKDOOR Remote PC Access connection"; flow:to_server,established; content:"|28 00 01 00 04 00 00 00 00 00 00 00|",depth 12; metadata:ruleset community; reference:nessus,11673; classtype:trojan-activity; sid:2124; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP CWD Root directory traversal attempt"; flow:to_server,established; content:"CWD",nocase; content:"C|3A 5C|",distance 1; metadata:ruleset community; service:ftp; reference:bugtraq,7674; reference:cve,2003-0392; reference:nessus,11677; classtype:protocol-command-decode; sid:2125; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1723 ( msg:"OS-WINDOWS Microsoft Windows PPTP Start Control Request buffer overflow attempt"; flow:to_server,established,no_stream; isdataat:156; content:"|00 01|",depth 2,offset 2; content:"|00 01|",depth 2,offset 8; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,5807; reference:cve,2002-1214; reference:nessus,11178; reference:url,technet.microsoft.com/en-us/security/bulletin/MS02-063; classtype:attempted-admin; sid:2126; rev:16; )
alert tcp any any <> any 179 ( msg:"SERVER-OTHER BGP invalid length"; flow:stateless; content:"|FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF|"; byte_test:2,<,19,0,relative; metadata:ruleset community; reference:bugtraq,6213; reference:cve,2002-1350; reference:nessus,14011; reference:nessus,15043; reference:url,sf.net/tracker/index.php?func=detail&aid=744523&group_id=53066&atid=469575; classtype:bad-unknown; sid:2158; rev:12; )
alert tcp $EXTERNAL_NET any <> $HOME_NET 179 ( msg:"SERVER-OTHER BGP invalid type 0"; flow:stateless; content:"|FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF|",depth 16; content:"|00|",within 1,distance 2; metadata:ruleset community; reference:bugtraq,6213; reference:cve,2002-1350; reference:nessus,14011; reference:nessus,15043; classtype:bad-unknown; sid:2159; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"OS-WINDOWS Microsoft Windows SMB startup folder access"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB2",depth 5,offset 4; content:"Documents and Settings|5C|All Users|5C|Start Menu|5C|Programs|5C|Startup|00|",distance 0,nocase; metadata:ruleset community; service:netbios-ssn; reference:url,attack.mitre.org/techniques/T1060; classtype:attempted-recon; sid:2176; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"OS-WINDOWS Microsoft Windows SMB startup folder unicode access"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB2",depth 5,offset 4; content:"|5C 00|S|00|t|00|a|00|r|00|t|00| |00|M|00|e|00|n|00|u|00 5C 00|P|00|r|00|o|00|g|00|r|00|a|00|m|00|s|00 5C 00|S|00|t|00|a|00|r|00|t|00|u|00|p",distance 0,nocase; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1060; classtype:attempted-recon; sid:2177; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP USER format string attempt"; flow:to_server,established; content:"USER",fast_pattern,nocase; pcre:"/^USER\s[^\n]*?%[^\n]*?%/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,7474; reference:bugtraq,7776; reference:bugtraq,9262; reference:bugtraq,9402; reference:bugtraq,9600; reference:bugtraq,9800; reference:cve,2004-0277; reference:nessus,10041; reference:nessus,11687; classtype:misc-attack; sid:2178; rev:23; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP PASS format string attempt"; flow:to_server,established; content:"PASS",fast_pattern,nocase; pcre:"/^PASS\s[^\n]*?%[^\n]*?%/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,7474; reference:bugtraq,9262; reference:bugtraq,9800; reference:cve,2000-0699; reference:cve,2007-1195; reference:nessus,10490; classtype:misc-attack; sid:2179; rev:16; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PUA-P2P BitTorrent announce request"; flow:to_server,established; content:"/announce"; content:"info_hash="; content:"peer_id="; content:"event="; metadata:ruleset community; service:http; classtype:policy-violation; sid:2180; rev:10; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PUA-P2P BitTorrent transfer"; flow:to_server,established; content:"|13|BitTorrent protocol",depth 20; metadata:ruleset community; classtype:policy-violation; sid:2181; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"PROTOCOL-RPC mountd TCP mount path overflow attempt"; flow:to_server,established; content:"|00 01 86 A5 00|",depth 5,offset 16; content:"|00 00 00 01|",within 4,distance 3; byte_jump:4,4,relative,align; byte_jump:4,4,relative,align; byte_test:4,>,1023,0,relative; content:"|00 00 00 00|",depth 4,offset 8; metadata:ruleset community; reference:bugtraq,8179; reference:cve,2003-0252; reference:nessus,11800; classtype:misc-attack; sid:2184; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 135 ( msg:"NETBIOS DCERPC invalid bind attempt"; flow:to_server,established; content:"|05|",depth 1; content:"|0B|",within 1,distance 1; byte_test:1,&,1,0,relative; content:"|00|",within 1,distance 21; metadata:ruleset community; classtype:attempted-dos; sid:2190; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB DCERPC invalid bind attempt"; flow:to_server,established; content:"|FF|SMB%",depth 5,offset 4,nocase; content:"&|00|",within 2,distance 56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|",within 12,distance 5,nocase; content:"|05|",within 1,distance 2; content:"|0B|",within 1,distance 1; byte_test:1,&,1,0,relative; content:"|00|",within 1,distance 21; metadata:ruleset community; service:netbios-ssn; classtype:attempted-dos; sid:2191; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP USER format string attempt"; flow:to_server,established; content:"USER",fast_pattern,nocase; pcre:"/^USER\s+[^\n]*?%/ims"; metadata:ruleset community; service:pop3; reference:bugtraq,10976; reference:bugtraq,7667; reference:cve,2003-0391; reference:nessus,11742; classtype:attempted-admin; sid:2250; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows SMB-DS DCERPC Remote Activation bind attempt"; flow:to_server,established; content:"|FF|SMB%",depth 5,offset 4,nocase; content:"&|00|",within 2,distance 56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|",within 12,distance 5,nocase; content:"|05|",within 1; content:"|0B|",within 1,distance 1; byte_test:1,&,1,0,relative; content:"|B8|J|9F|M|1C|}|CF 11 86 1E 00| |AF|n|7C|W",within 16,distance 29; tag:session,packets 5; metadata:ruleset community; service:netbios-ssn; reference:bugtraq,8234; reference:bugtraq,8458; reference:cve,2003-0528; reference:cve,2003-0605; reference:cve,2003-0715; reference:nessus,11798; reference:nessus,11835; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:attempted-admin; sid:2252; rev:22; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: ( msg:"PROTOCOL-RPC sadmind query with root credentials attempt TCP"; flow:to_server,established; content:"|00 01 87 88|",depth 4,offset 16; content:"|00 00 00 01 00 00 00 01|",within 8,distance 4; byte_jump:4,8,relative,align; content:"|00 00 00 00|",within 4; metadata:ruleset community; classtype:misc-attack; sid:2255; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1024: ( msg:"PROTOCOL-RPC sadmind query with root credentials attempt UDP"; flow:to_server; content:"|00 01 87 88|",depth 4,offset 12; content:"|00 00 00 01 00 00 00 01|",within 8,distance 4; byte_jump:4,8,relative,align; content:"|00 00 00 00|",within 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:misc-attack; sid:2256; rev:12; )
alert udp $EXTERNAL_NET any -> $HOME_NET 135 ( msg:"OS-WINDOWS DCERPC Messenger Service buffer overflow attempt"; content:"|04 00|",depth 2; byte_test:1,>,15,2,relative; byte_jump:4,86,relative,little,align; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,relative,little; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,8826; reference:cve,2003-0717; reference:nessus,11888; reference:nessus,11890; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-043; classtype:attempted-admin; sid:2257; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows SMB-DS DCERPC Messenger Service buffer overflow attempt"; flow:to_server,established; content:"|FF|SMB%",depth 5,offset 4,nocase; content:"&|00|",within 2,distance 56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|",within 12,distance 5,nocase; content:"|04 00|",within 2; byte_test:1,>,15,2,relative; byte_jump:4,86,relative,little,align; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,0,relative,little; metadata:ruleset community; service:netbios-ssn; reference:bugtraq,8826; reference:cve,2003-0717; reference:nessus,11888; reference:nessus,11890; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-043; classtype:attempted-admin; sid:2258; rev:17; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR FsSniffer connection attempt"; flow:to_server,established; content:"RemoteNC Control Password|3A|"; metadata:ruleset community; reference:nessus,11854; classtype:trojan-activity; sid:2271; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP LIST integer overflow attempt"; flow:to_server,established; content:"LIST",fast_pattern,nocase; pcre:"/^LIST\s+\x22-W\s+\d+/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,8875; reference:cve,2003-0853; reference:cve,2003-0854; reference:nessus,11912; classtype:misc-attack; sid:2272; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP login brute force attempt"; flow:to_server,established,no_stream; content:"LOGIN",fast_pattern,nocase; detection_filter:track by_dst,count 30,seconds 30; metadata:ruleset community; service:imap; reference:url,attack.mitre.org/techniques/T1110; classtype:suspicious-login; sid:2273; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP login brute force attempt"; flow:to_server,established,no_stream; content:"USER",fast_pattern,nocase; detection_filter:track by_dst,count 30,seconds 30; metadata:ruleset community; service:pop3; reference:url,attack.mitre.org/techniques/T1110; classtype:suspicious-login; sid:2274; rev:11; )
alert tcp $HOME_NET 2401 -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE CVS non-relative path error response"; flow:to_client,established; content:"E cvs server|3A| warning|3A| cannot make directory CVS in /",fast_pattern,nocase; metadata:ruleset community; reference:bugtraq,9178; reference:cve,2003-0977; reference:nessus,11947; classtype:misc-attack; sid:2317; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 2401 ( msg:"SERVER-OTHER CVS non-relative path access attempt"; flow:to_server,established; content:"Argument"; pcre:"/^Argument\s+\//ims"; pcre:"/^Directory/Rims"; metadata:ruleset community; reference:bugtraq,9178; reference:cve,2003-0977; reference:nessus,11947; classtype:misc-attack; sid:2318; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1655 ( msg:"SERVER-OTHER ebola PASS overflow attempt"; flow:to_server,established; content:"PASS",fast_pattern,nocase; pcre:"/^PASS\s[^\n]{49}/ims"; metadata:ruleset community; reference:bugtraq,9156; classtype:attempted-admin; sid:2319; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1655 ( msg:"SERVER-OTHER ebola USER overflow attempt"; flow:to_server,established; content:"USER",fast_pattern,nocase; pcre:"/^USER\s[^\n]{49}/ims"; metadata:ruleset community; reference:bugtraq,9156; classtype:attempted-admin; sid:2320; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP auth overflow attempt"; flow:to_server,established; content:"AUTH"; isdataat:368,relative; content:!"|0A|",within 368; metadata:ruleset community; service:imap; reference:bugtraq,8861; reference:cve,2003-1177; reference:nessus,11910; classtype:misc-attack; sid:2330; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP MKD format string attempt"; flow:to_server,established; content:"MKD",fast_pattern,nocase; pcre:"/^MKD\s[^\n]*?%[^\n]*?%/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,9262; classtype:misc-attack; sid:2332; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP RENAME format string attempt"; flow:to_server,established; content:"RENAME",fast_pattern,nocase; pcre:"/^RENAME\s[^\n]*?%[^\n]*?%/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,9262; classtype:misc-attack; sid:2333; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3535 ( msg:"PROTOCOL-FTP Yak! FTP server default account login attempt"; flow:to_server,established; content:"USER",nocase; content:"y049575046",fast_pattern,nocase; pcre:"/^USER\s+y049575046/ims"; metadata:ruleset community; reference:bugtraq,9072; reference:url,attack.mitre.org/techniques/T1078; classtype:suspicious-login; sid:2334; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3535 ( msg:"PROTOCOL-FTP RMD / attempt"; flow:to_server,established; content:"RMD",fast_pattern,nocase; pcre:"/^RMD\s+\x2f$/ims"; metadata:ruleset community; reference:bugtraq,9159; classtype:attempted-dos; sid:2335; rev:10; )
alert udp any any -> any 69 ( msg:"PROTOCOL-TFTP PUT filename overflow attempt"; flow:to_server; content:"|00|",depth 1; byte_test:1,<,3,0,relative; isdataat:101,relative; content:!"|00|",within 100,distance 2; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,20131; reference:bugtraq,22923; reference:bugtraq,7819; reference:bugtraq,8505; reference:cve,2003-0380; reference:cve,2003-0729; reference:cve,2006-4948; reference:cve,2006-6184; reference:cve,2008-1611; reference:cve,2009-2957; reference:cve,2009-2958; reference:nessus,18264; classtype:attempted-admin; sid:2337; rev:23; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP LIST buffer overflow attempt"; flow:to_server,established; content:"LIST",nocase; isdataat:128,relative; pcre:"/^LIST(?!\n)\s[^\n]{128}/ims"; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:bugtraq,10181; reference:bugtraq,14339; reference:bugtraq,33454; reference:bugtraq,58247; reference:bugtraq,6869; reference:bugtraq,7251; reference:bugtraq,7861; reference:bugtraq,8486; reference:bugtraq,9675; reference:cve,1999-0349; reference:cve,1999-1510; reference:cve,2000-0129; reference:cve,2004-1992; reference:cve,2005-2373; reference:cve,2007-0019; reference:cve,2009-0351; reference:url,technet.microsoft.com/en-us/security/bulletin/MS99-003; classtype:misc-attack; sid:2338; rev:35; )
alert udp $EXTERNAL_NET any -> $HOME_NET 69 ( msg:"PROTOCOL-TFTP NULL command attempt"; flow:to_server; content:"|00 00|",depth 2; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,7575; classtype:bad-unknown; sid:2339; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP SITE CHMOD overflow attempt"; flow:to_server,established; content:"SITE",nocase; content:"CHMOD",distance 0,nocase; isdataat:200,relative; pcre:"/^SITE\s+CHMOD\s[^\n]{200}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,10181; reference:bugtraq,9483; reference:bugtraq,9675; reference:cve,1999-0838; reference:nessus,12037; classtype:attempted-admin; sid:2340; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP STOR overflow attempt"; flow:to_server,established; content:"STOR",nocase; isdataat:200,relative; content:!"|0D|",within 200; content:!"|0A|",within 200; content:!"|00|",within 200; metadata:ruleset community; service:ftp; reference:bugtraq,8668; reference:cve,2000-0133; reference:url,exploit-db.com/exploits/39662/; classtype:attempted-admin; sid:2343; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP XCWD overflow attempt"; flow:to_server,established; content:"XCWD",nocase; isdataat:100,relative; pcre:"/^XCWD(?!\n)\s[^\n]{100}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,11542; reference:bugtraq,8704; reference:cve,2004-2728; classtype:attempted-admin; sid:2344; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP XMKD overflow attempt"; flow:to_server,established; content:"XMKD",nocase; isdataat:200,relative; pcre:"/^XMKD(?!\n)\s[^\n]{200}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,7909; reference:cve,2000-0133; reference:cve,2001-1021; classtype:attempted-admin; sid:2373; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP NLST overflow attempt"; flow:to_server,established; content:"NLST",nocase; isdataat:200,relative; pcre:"/^NLST(?!\n)\s[^\n]{200}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,7909; reference:cve,1999-1544; reference:cve,2009-3023; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-053; reference:url,www.kb.cert.org/vuls/id/276653; classtype:attempted-admin; sid:2374; rev:19; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3127:3199 ( msg:"MALWARE-CNC DoomJuice/mydoom.a backdoor upload/execute"; flow:to_server,established; content:"|85 13|<|9E A2|",depth 5; metadata:ruleset community; reference:url,securityresponse.symantec.com/avcenter/venc/data/w32.hllw.doomjuice.html; classtype:trojan-activity; sid:2375; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500 ( msg:"SERVER-OTHER ISAKMP first payload certificate request length overflow attempt"; flow:to_server; byte_test:4,>,2043,24; content:"|07|",depth 1,offset 16; byte_test:2,>,2043,30; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,9582; reference:cve,2004-0040; classtype:attempted-admin; sid:2376; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500 ( msg:"SERVER-OTHER ISAKMP second payload certificate request length overflow attempt"; flow:to_server; byte_test:4,>,2043,24; content:"|07|",depth 1,offset 28; byte_jump:2,30; byte_test:2,>,2043,-2,relative; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,9582; reference:cve,2004-0040; classtype:attempted-admin; sid:2377; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500 ( msg:"SERVER-OTHER ISAKMP third payload certificate request length overflow attempt"; flow:to_server; byte_test:4,>,2043,24; byte_jump:2,30; content:"|07|",within 1,distance -4; byte_jump:2,1,relative; byte_test:2,>,2043,-2,relative; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,9582; reference:cve,2004-0040; classtype:attempted-admin; sid:2378; rev:10; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500 ( msg:"SERVER-OTHER ISAKMP forth payload certificate request length overflow attempt"; flow:to_server; byte_test:4,>,2043,24; byte_jump:2,30; byte_jump:2,-2,relative; content:"|07|",within 1,distance -4; byte_jump:2,1,relative; byte_test:2,>,2043,-2,relative; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,9582; reference:cve,2004-0040; classtype:attempted-admin; sid:2379; rev:10; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500 ( msg:"SERVER-OTHER ISAKMP fifth payload certificate request length overflow attempt"; flow:to_server; byte_test:4,>,2043,24; byte_jump:2,30; byte_jump:2,-2,relative; byte_jump:2,-2,relative; content:"|07|",within 1,distance -4; byte_jump:2,1,relative; byte_test:2,>,2043,-2,relative; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,9582; reference:cve,2004-0040; classtype:attempted-admin; sid:2380; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP RNTO overflow attempt"; flow:to_server,established; content:"RNTO",nocase; isdataat:200,relative; pcre:"/^RNTO(?!\n)\s[^\n]{200}/ims"; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:bugtraq,15457; reference:bugtraq,8315; reference:cve,2000-0133; reference:cve,2001-1021; reference:cve,2003-0466; reference:cve,2005-3683; classtype:attempted-admin; sid:2389; rev:21; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP STOU overflow attempt"; flow:to_server,established; content:"STOU",nocase; isdataat:200,relative; pcre:"/^STOU\s[^\n]{200}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,8315; reference:cve,2003-0466; classtype:attempted-admin; sid:2390; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP APPE overflow attempt"; flow:to_server,established; content:"APPE",nocase; isdataat:200,relative; pcre:"/^APPE(?!\n)\s[^\n]{200}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,8315; reference:bugtraq,8542; reference:cve,2000-0133; reference:cve,2003-0466; reference:cve,2003-0772; classtype:attempted-admin; sid:2391; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP RETR overflow attempt"; flow:to_server,established; content:"RETR",nocase; isdataat:200,relative; pcre:"/^RETR(?!\n)\s[^\n]{200}/ims"; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:bugtraq,15457; reference:bugtraq,23168; reference:bugtraq,8315; reference:cve,2003-0466; reference:cve,2004-0287; reference:cve,2004-0298; reference:cve,2005-3683; classtype:attempted-admin; sid:2392; rev:22; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 2301 ( msg:"SERVER-WEBAPP Compaq web-based management agent denial of service attempt"; flow:to_server,established; content:"<!",depth 75; content:">",within 50; metadata:ruleset community; reference:bugtraq,8014; classtype:web-application-attack; sid:2394; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB Session Setup andx username overflow attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,!&,128,6,relative; content:"s",depth 1,offset 39; byte_jump:2,0,relative,little; byte_test:4,!&,2147483648,21,relative,little; content:!"|00|",within 255,distance 29; metadata:ruleset community; reference:bugtraq,9752; reference:cve,2004-0193; reference:url,www.eeye.com/html/Research/Advisories/AD20040226.html; classtype:protocol-command-decode; sid:2401; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS Session Setup andx username overflow attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,!&,128,6,relative; content:"s",depth 1,offset 39; byte_jump:2,0,relative,little; byte_test:4,!&,2147483648,21,relative,little; content:!"|00|",within 255,distance 29; metadata:ruleset community; service:netbios-ssn; reference:bugtraq,9752; reference:cve,2004-0193; reference:url,www.eeye.com/html/Research/Advisories/AD20040226.html; classtype:protocol-command-decode; sid:2402; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB Session Setup unicode username overflow attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMBs",within 5,distance 3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/Rs"; byte_test:4,!&,2147483648,21,relative,little; content:!"|00 00|",within 510,distance 29; metadata:ruleset community; reference:bugtraq,9752; reference:cve,2004-0193; reference:url,www.eeye.com/html/Research/Advisories/AD20040226.html; classtype:protocol-command-decode; sid:2403; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS Session Setup unicode andx username overflow attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,&,128,6,relative; content:"s",depth 1,offset 39; byte_jump:2,0,relative,little; byte_test:4,!&,2147483648,21,relative,little; content:!"|00 00|",within 510,distance 29; metadata:ruleset community; service:netbios-ssn; reference:bugtraq,9752; reference:cve,2004-0193; reference:url,www.eeye.com/html/Research/Advisories/AD20040226.html; classtype:protocol-command-decode; sid:2404; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP APOP USER overflow attempt"; flow:to_server,established; content:"APOP",nocase; isdataat:256,relative; pcre:"/^APOP\s+USER\s[^\n]{256}/ims"; metadata:ruleset community; service:pop3; reference:bugtraq,9794; reference:cve,2004-2375; classtype:attempted-admin; sid:2409; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 554 ( msg:"SERVER-WEBAPP RealNetworks RealSystem Server DESCRIBE buffer overflow attempt"; flow:to_server,established; content:"DESCRIBE",nocase; content:"../",distance 1; pcre:"/^DESCRIBE\s[^\n]{300}/ims"; metadata:ruleset community; reference:bugtraq,8476; reference:cve,2003-0725; reference:nessus,11642; reference:url,www.service.real.com/help/faq/security/rootexploit091103.html; classtype:web-application-attack; sid:2411; rev:16; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE successful cross site scripting forced download attempt"; flow:to_server,established; content:"|0A|Referer|3A| res|3A|/C|3A|"; metadata:ruleset community; classtype:successful-user; sid:2412; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500 ( msg:"SERVER-OTHER ISAKMP delete hash with empty hash attempt"; flow:to_server; content:"|08|",depth 1,offset 16; content:"|0C|",depth 1,offset 28; content:"|00 04|",depth 2,offset 30; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,9416; reference:bugtraq,9417; reference:cve,2004-0164; classtype:misc-attack; sid:2413; rev:16; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500 ( msg:"SERVER-OTHER ISAKMP initial contact notification without SPI attempt"; flow:to_server; content:"|0B|",depth 1,offset 16; content:"|00 0C 00 00 00 01 01 00 06 02|",depth 10,offset 30; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,9416; reference:bugtraq,9417; reference:cve,2004-0164; classtype:misc-attack; sid:2414; rev:16; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500 ( msg:"SERVER-OTHER ISAKMP second payload initial contact notification without SPI attempt"; flow:to_server; content:"|0B|",depth 1,offset 28; byte_jump:2,30; content:"|00 0C 00 00 00 01 01 00|`|02|",within 10,distance -2; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,9416; reference:bugtraq,9417; reference:cve,2004-0164; classtype:misc-attack; sid:2415; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP invalid MDTM command attempt"; flow:to_server,established; content:"MDTM",fast_pattern,nocase; pcre:"/^MDTM \d+[-+]\D/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,9751; reference:cve,2001-1021; reference:cve,2004-0330; classtype:attempted-admin; sid:2416; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP format string attempt"; flow:to_server,established; content:"%",fast_pattern,nocase; pcre:"/\s+.*?%.*?%/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,15352; reference:bugtraq,30993; reference:bugtraq,9800; reference:cve,2002-2074; reference:cve,2007-1195; reference:cve,2009-4769; classtype:string-detect; sid:2417; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 ( msg:"POLICY-OTHER Microsoft Windows Terminal Server no encryption session initiation attempt"; flow:to_server,established; content:"|03 00 01|",depth 3; content:"|00|",depth 1,offset 288; metadata:ruleset community; reference:cve,2001-0663; reference:url,technet.microsoft.com/en-us/security/bulletin/MS01-052; classtype:attempted-dos; sid:2418; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 119 ( msg:"PROTOCOL-NNTP sendsys overflow attempt"; flow:to_server,established; content:"sendsys",fast_pattern,nocase; pcre:"/^sendsys\x3a[^\n]{21}/ims"; metadata:ruleset community; reference:bugtraq,9382; reference:cve,2004-0045; reference:nessus,11984; classtype:attempted-admin; sid:2424; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 119 ( msg:"PROTOCOL-NNTP senduuname overflow attempt"; flow:to_server,established; content:"senduuname",fast_pattern,nocase; pcre:"/^senduuname\x3a[^\n]{21}/ims"; metadata:ruleset community; reference:bugtraq,9382; reference:cve,2004-0045; reference:nessus,11984; classtype:attempted-admin; sid:2425; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 119 ( msg:"PROTOCOL-NNTP version overflow attempt"; flow:to_server,established; content:"version",fast_pattern,nocase; pcre:"/^version\x3a[^\n]{21}/ims"; metadata:ruleset community; reference:bugtraq,9382; reference:cve,2004-0045; reference:nessus,11984; classtype:attempted-admin; sid:2426; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 119 ( msg:"PROTOCOL-NNTP checkgroups overflow attempt"; flow:to_server,established; content:"checkgroups",fast_pattern,nocase; pcre:"/^checkgroups\x3a[^\n]{21}/ims"; metadata:ruleset community; reference:bugtraq,9382; reference:cve,2004-0045; reference:nessus,11984; classtype:attempted-admin; sid:2427; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 119 ( msg:"PROTOCOL-NNTP ihave overflow attempt"; flow:to_server,established; content:"ihave",fast_pattern,nocase; pcre:"/^ihave\x3a[^\n]{21}/ims"; metadata:ruleset community; reference:bugtraq,9382; reference:cve,2004-0045; reference:nessus,11984; classtype:attempted-admin; sid:2428; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 119 ( msg:"PROTOCOL-NNTP sendme overflow attempt"; flow:to_server,established; content:"sendme",fast_pattern,nocase; pcre:"/^sendme\x3a[^\n]{21}/ims"; metadata:ruleset community; reference:bugtraq,9382; reference:cve,2004-0045; reference:nessus,11984; classtype:attempted-admin; sid:2429; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 119 ( msg:"PROTOCOL-NNTP newgroup overflow attempt"; flow:to_server,established; content:"newgroup",fast_pattern,nocase; pcre:"/^newgroup\x3a[^\n]{32}/ims"; metadata:ruleset community; service:nntp; reference:bugtraq,9382; reference:cve,2004-0045; reference:nessus,11984; classtype:attempted-admin; sid:2430; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 119 ( msg:"PROTOCOL-NNTP rmgroup overflow attempt"; flow:to_server,established; content:"rmgroup",fast_pattern,nocase; pcre:"/^rmgroup\x3a[^\n]{32}/ims"; metadata:ruleset community; service:nntp; reference:bugtraq,9382; reference:cve,2004-0045; reference:nessus,11984; classtype:attempted-admin; sid:2431; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 119 ( msg:"PROTOCOL-NNTP article post without path attempt"; flow:to_server,established; content:"takethis",fast_pattern,nocase; pcre:!"/^takethis.*?Path\x3a.*?[\r]{0,1}?\n[\r]{0,1}\n/is"; metadata:ruleset community; classtype:attempted-admin; sid:2432; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3000 ( msg:"SERVER-WEBAPP MDaemon form2raw.cgi overflow attempt"; flow:to_server,established; content:"/form2raw.cgi",fast_pattern,nocase; pcre:"/\Wfrom=[^\x3b&\n]{100}/is"; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,9317; reference:cve,2003-1200; reference:url,secunia.com/advisories/10512/; classtype:web-application-attack; sid:2433; rev:13; )
alert udp any 4000 -> any any ( msg:"SERVER-OTHER ICQ SRV_MULTI/SRV_META_USER overflow attempt - ISS Witty Worm"; flow:to_server; content:"|05 00|",depth 2; content:"|12 02|",within 2,distance 5; byte_test:1,>,1,12,relative; content:"|05 00|"; content:"n|00|",within 2,distance 5; content:"|05 00|"; content:"|DE 03|",within 2,distance 5; byte_test:2,>,512,-11,relative,little; metadata:policy max-detect-ips drop,ruleset community; reference:cve,2004-0362; reference:url,www.eeye.com/html/Research/Advisories/AD20040318.html; classtype:misc-attack; sid:2446; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP ALLO overflow attempt"; flow:to_server,established; content:"ALLO",nocase; isdataat:200,relative; pcre:"/^ALLO(?!\n)\s[^\n]{200}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,9953; reference:cve,2004-1883; reference:nessus,14598; classtype:attempted-admin; sid:2449; rev:12; )
alert tcp $EXTERNAL_NET 5050 -> $HOME_NET any ( msg:"POLICY-SOCIAL Yahoo IM successful logon"; flow:to_client,established; content:"YMSG",depth 4,nocase; content:"|00 01|",depth 2,offset 10; metadata:ruleset community; classtype:policy-violation; sid:2450; rev:9; )
alert tcp $EXTERNAL_NET 5050 -> $HOME_NET any ( msg:"POLICY-SOCIAL Yahoo IM voicechat"; flow:to_client,established; content:"YMSG",depth 4,nocase; content:"|00|J",depth 2,offset 10; metadata:ruleset community; classtype:policy-violation; sid:2451; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 5050 ( msg:"POLICY-SOCIAL Yahoo IM ping"; flow:to_server,established; content:"YMSG",depth 4,nocase; content:"|00 12|",depth 2,offset 10; metadata:ruleset community; classtype:policy-violation; sid:2452; rev:9; )
alert tcp $EXTERNAL_NET 5050 -> $HOME_NET any ( msg:"POLICY-SOCIAL Yahoo IM conference invitation"; flow:to_client,established; content:"YMSG",depth 4,nocase; content:"|00 18|",depth 2,offset 10; metadata:ruleset community; classtype:policy-violation; sid:2453; rev:9; )
alert tcp $EXTERNAL_NET 5050 -> $HOME_NET any ( msg:"POLICY-SOCIAL Yahoo IM conference logon success"; flow:to_client,established; content:"YMSG",depth 4,nocase; content:"|00 19|",depth 2,offset 10; metadata:ruleset community; classtype:policy-violation; sid:2454; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 5050 ( msg:"POLICY-SOCIAL Yahoo IM conference message"; flow:to_server,established; content:"YMSG",depth 4,nocase; content:"|00 1D|",depth 2,offset 10; metadata:ruleset community; classtype:policy-violation; sid:2455; rev:8; )
alert tcp $EXTERNAL_NET 5050 -> $HOME_NET any ( msg:"POLICY-SOCIAL Yahoo Messenger File Transfer Receive Request"; flow:established; content:"YMSG",depth 4; content:"|00|M",depth 2,offset 10; metadata:ruleset community; classtype:policy-violation; sid:2456; rev:9; )
alert tcp any any <> any 5101 ( msg:"POLICY-SOCIAL Yahoo IM message"; flow:established; content:"YMSG",depth 4,nocase; metadata:ruleset community; classtype:policy-violation; sid:2457; rev:7; )
alert tcp $EXTERNAL_NET 5050 -> $HOME_NET any ( msg:"POLICY-SOCIAL Yahoo IM successful chat join"; flow:to_client,established; content:"YMSG",depth 4,nocase; content:"|00 98|",depth 2,offset 10; metadata:ruleset community; classtype:policy-violation; sid:2458; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 5050 ( msg:"POLICY-SOCIAL Yahoo IM conference offer invitation"; flow:to_server,established; content:"YMSG",depth 4,nocase; content:"|00|P",depth 2,offset 10; metadata:ruleset community; classtype:policy-violation; sid:2459; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 5100 ( msg:"POLICY-SOCIAL Yahoo IM conference request"; flow:to_server,established; content:"<R",depth 2; pcre:"/^\x3c(REQIMG|RVWCFG)\x3e/ims"; metadata:ruleset community; classtype:policy-violation; sid:2460; rev:9; )
alert tcp $EXTERNAL_NET 5100 -> $HOME_NET any ( msg:"POLICY-SOCIAL Yahoo IM conference watch"; flow:to_client,established; content:"|0D 00 05 00|",depth 4; metadata:ruleset community; classtype:policy-violation; sid:2461; rev:10; )
alert ip any any -> any any ( msg:"SERVER-OTHER Ethereal IGMP IGAP account overflow attempt"; ip_proto:2; byte_test:1,>,63,0; byte_test:1,<,67,0; byte_test:1,>,16,12; metadata:ruleset community; reference:bugtraq,9952; reference:cve,2004-0176; reference:cve,2004-0367; classtype:attempted-admin; sid:2462; rev:10; )
alert ip any any -> any any ( msg:"SERVER-OTHER Ethereal IGMP IGAP message overflow attempt"; ip_proto:2; byte_test:1,>,63,0; byte_test:1,<,67,0; byte_test:1,>,64,13; metadata:ruleset community; reference:bugtraq,9952; reference:cve,2004-0176; reference:cve,2004-0367; classtype:attempted-admin; sid:2463; rev:10; )
alert ip any any -> any any ( msg:"SERVER-OTHER Ethereal EIGRP prefix length overflow attempt"; ip_proto:88; byte_test:1,>,32,44; metadata:ruleset community; reference:bugtraq,9952; reference:cve,2004-0176; reference:cve,2004-0367; classtype:attempted-admin; sid:2464; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS ADMIN$ share access"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMBu",within 5,distance 3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; byte_jump:2,7,relative,little; content:"ADMIN|24 00|",distance 2,nocase; metadata:ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:2474; rev:10; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500 ( msg:"SERVER-OTHER ISAKMP invalid identification payload attempt"; flow:to_server; content:"|05|",depth 1,offset 16; byte_test:1,!&,1,19; byte_test:1,>,8,32; byte_test:2,>,0,30; byte_test:2,<,10,30; byte_test:2,!=,8,30; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,10004; reference:cve,2004-0184; classtype:attempted-dos; sid:2486; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 80 ( msg:"SERVER-OTHER esignal STREAMQUOTE buffer overflow attempt"; flow:to_server,established; content:"<STREAMQUOTE>",nocase; isdataat:1040,relative; content:!"</STREAMQUOTE>",within 1040,nocase; metadata:ruleset community; reference:bugtraq,9978; reference:cve,2004-1868; classtype:attempted-admin; sid:2489; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 80 ( msg:"SERVER-OTHER esignal SNAPQUOTE buffer overflow attempt"; flow:to_server,established; content:"<SNAPQUOTE>",nocase; isdataat:1024,relative; content:!"</SNAPQUOTE>",within 1052,nocase; metadata:ruleset community; reference:bugtraq,9978; reference:cve,2004-1868; classtype:attempted-admin; sid:2490; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP lsass DsRolerUpgradeDownlevelServer overflow attempt"; flow:to_server,established; dce_iface:uuid 3919286a-b10c-11d0-9ba8-00c04fd92ef5; dce_opnum:"9"; dce_stub_data; byte_test:4,>,256,0,dce; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ssn; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; classtype:attempted-admin; sid:2508; rev:24; )
alert udp $EXTERNAL_NET any -> $HOME_NET [135,138,1024:] ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP lsass DsRolerUpgradeDownlevelServer overflow attempt"; dce_iface:uuid 3919286a-b10c-11d0-9ba8-00c04fd92ef5; dce_opnum:"9"; dce_stub_data; byte_test:4,>,256,0,dce; metadata:policy max-detect-ips drop,ruleset community; service:netbios-dgm; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; classtype:attempted-admin; sid:2511; rev:22; )
alert tcp $EXTERNAL_NET any <> $HOME_NET 179 ( msg:"SERVER-OTHER BGP spoofed connection reset attempt"; flow:established,no_stream; flags:FRS*; detection_filter:track by_dst,count 10,seconds 10; metadata:ruleset community; reference:bugtraq,10183; reference:cve,2004-0230; reference:url,www.uniras.gov.uk/vuls/2004/236929/index.htm; classtype:attempted-dos; sid:2523; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 548 ( msg:"SERVER-OTHER AFP FPLoginExt username buffer overflow attempt"; flow:to_server,established; content:"|00 02|",depth 2; content:"?",within 1,distance 14; content:"cleartxt passwrd",nocase; byte_jump:2,1,relative; byte_jump:2,1,relative; isdataat:2,relative; metadata:ruleset community; reference:bugtraq,10271; reference:cve,2004-0430; reference:url,www.atstake.com/research/advisories/2004/a050304-1.txt; classtype:attempted-admin; sid:2545; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP MDTM overflow attempt"; flow:to_server,established; content:"MDTM",nocase; isdataat:100,relative; pcre:"/^MDTM(?!\n)\s[^\n]{100}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,9751; reference:cve,2001-1021; reference:cve,2004-0330; reference:nessus,12080; classtype:attempted-admin; sid:2546; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7777:7778 ( msg:"SERVER-OTHER Oracle Web Cache GET overflow attempt"; flow:to_server,established; content:"GET"; pcre:"/^GET[^s]{432}/ms"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,9868; reference:cve,2004-0385; reference:nessus,12126; classtype:attempted-admin; sid:2551; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7777:7778 ( msg:"SERVER-OTHER Oracle Web Cache HEAD overflow attempt"; flow:to_server,established; content:"HEAD"; pcre:"/^HEAD[^s]{432}/ms"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,9868; reference:cve,2004-0385; reference:nessus,12126; classtype:attempted-admin; sid:2552; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7777:7778 ( msg:"SERVER-OTHER Oracle Web Cache PUT overflow attempt"; flow:to_server,established; content:"PUT"; pcre:"/^PUT[^s]{432}/ms"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,9868; reference:cve,2004-0385; reference:nessus,12126; classtype:attempted-admin; sid:2553; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7777:7778 ( msg:"SERVER-OTHER Oracle Web Cache POST overflow attempt"; flow:to_server,established; content:"POST"; pcre:"/^POST[^s]{432}/ms"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,9868; reference:cve,2004-0385; reference:nessus,12126; classtype:attempted-admin; sid:2554; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7777:7778 ( msg:"SERVER-OTHER Oracle Web Cache TRACE overflow attempt"; flow:to_server,established; content:"TRACE"; pcre:"/^TRACE[^s]{432}/ms"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,9868; reference:cve,2004-0385; reference:nessus,12126; classtype:attempted-admin; sid:2555; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7777:7778 ( msg:"SERVER-OTHER Oracle Web Cache DELETE overflow attempt"; flow:to_server,established; content:"DELETE"; pcre:"/^DELETE[^s]{432}/ms"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,9868; reference:cve,2004-0385; reference:nessus,12126; classtype:attempted-admin; sid:2556; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7777:7778 ( msg:"SERVER-OTHER Oracle Web Cache LOCK overflow attempt"; flow:to_server,established; content:"LOCK"; pcre:"/^LOCK[^s]{432}/ms"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,9868; reference:cve,2004-0385; reference:nessus,12126; classtype:attempted-admin; sid:2557; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7777:7778 ( msg:"SERVER-OTHER Oracle Web Cache MKCOL overflow attempt"; flow:to_server,established; content:"MKCOL"; pcre:"/^MKCOL[^s]{432}/ms"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,9868; reference:cve,2004-0385; reference:nessus,12126; classtype:attempted-admin; sid:2558; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7777:7778 ( msg:"SERVER-OTHER Oracle Web Cache COPY overflow attempt"; flow:to_server,established; content:"COPY"; pcre:"/^COPY[^s]{432}/ms"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,9868; reference:cve,2004-0385; reference:nessus,12126; classtype:attempted-admin; sid:2559; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7777:7778 ( msg:"SERVER-OTHER Oracle Web Cache MOVE overflow attempt"; flow:to_server,established; content:"MOVE"; pcre:"/^MOVE[^s]{432}/ms"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,9868; reference:cve,2004-0385; reference:nessus,12126; classtype:attempted-admin; sid:2560; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 873 ( msg:"SERVER-OTHER rsync backup-dir directory traversal attempt"; flow:to_server,established; content:"--backup-dir",fast_pattern,nocase; pcre:"/--backup-dir\s+\x2e\x2e\x2f/"; metadata:ruleset community; reference:bugtraq,10247; reference:cve,2004-0426; reference:nessus,12230; classtype:string-detect; sid:2561; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 81 ( msg:"SERVER-WEBAPP McAfee ePO file upload attempt"; flow:to_server,established; content:"/spipe/repl_file",nocase; content:"Command=BEGIN",nocase; metadata:ruleset community; service:http; reference:bugtraq,10200; reference:cve,2004-0038; classtype:attempted-admin; sid:2562; rev:9; )
alert udp $EXTERNAL_NET 137 -> $HOME_NET 137 ( msg:"NETBIOS NS lookup response name overflow attempt"; byte_test:1,&,0x80,2; content:"|00 01|",depth 2,offset 6; byte_test:1,>,32,12; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ns; reference:bugtraq,10333; reference:cve,2004-0444; reference:url,www.eeye.com/html/Research/Advisories/AD20040512A.html; classtype:attempted-admin; sid:2563; rev:8; )
alert udp $EXTERNAL_NET 137 -> $HOME_NET 137 ( msg:"NETBIOS NS lookup short response attempt"; dsize:<56; byte_test:1,&,0x80,2; content:"|00 01|",depth 2,offset 6; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ns; reference:bugtraq,10335; reference:cve,2004-0444; reference:url,www.eeye.com/html/Research/Advisories/AD20040512C.html; classtype:attempted-admin; sid:2564; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP RETR format string attempt"; flow:to_server,established; content:"RETR",fast_pattern,nocase; pcre:"/^RETR\s[^\n]*?%[^\n]*?%/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,9800; reference:cve,2004-1883; classtype:attempted-admin; sid:2574; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 2401 ( msg:"SERVER-OTHER CVS Max-dotdot integer overflow attempt"; flow:to_server,established; content:"Max-dotdot",fast_pattern,nocase; pcre:"/^Max-dotdot[\s\r\n]*\d{3,}/ims"; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,10499; reference:cve,2004-0417; classtype:misc-attack; sid:2583; rev:9; )
alert tcp $EXTERNAL_NET 6666:6669 -> $HOME_NET any ( msg:"SERVER-OTHER eMule buffer overflow attempt"; flow:to_client,established; content:"PRIVMSG",fast_pattern,nocase; pcre:"/^PRIVMSG\s+[^\s]+\s+\x3a\s*\x01SENDLINK\x7c[^\x7c]{69}/ims"; metadata:ruleset community; reference:bugtraq,10039; reference:cve,2004-1892; reference:nessus,12233; classtype:attempted-user; sid:2584; rev:10; )
alert tcp $HOME_NET 4711 -> $EXTERNAL_NET any ( msg:"PUA-P2P eDonkey server response"; flow:to_client,established; content:"Server|3A| eMule",fast_pattern,nocase; metadata:ruleset community; reference:url,www.emule-project.net; classtype:policy-violation; sid:2587; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"SERVER-OTHER HP Web JetAdmin ExecuteFile admin access"; flow:to_server,established; content:"/plugins/framework/script/content.hts",fast_pattern,nocase; content:"ExecuteFile",nocase; metadata:ruleset community; reference:bugtraq,10224; classtype:attempted-admin; sid:2655; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 443 ( msg:"SERVER-WEBAPP SSLv2 Client_Hello Challenge Length overflow attempt"; flow:to_server,established; ssl_version:sslv2; ssl_state:client_hello; content:"|01 00 02|",depth 3,offset 2; byte_test:1,>,127,0; byte_test:2,>,32,9; metadata:policy max-detect-ips drop,ruleset community; service:ssl; reference:bugtraq,11015; reference:cve,2004-0826; classtype:attempted-admin; sid:2656; rev:22; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 443 ( msg:"SERVER-WEBAPP SSLv2 Client_Hello with pad Challenge Length overflow attempt"; flow:to_server,established; ssl_version:sslv2; ssl_state:client_hello; content:"|01 00 02|",depth 3,offset 2; byte_test:2,>,32,9; metadata:policy max-detect-ips drop,ruleset community; service:ssl; classtype:attempted-admin; sid:2657; rev:20; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP login format string attempt"; flow:to_server,established; content:"LOGIN",fast_pattern,nocase; pcre:"/\sLOGIN\s[^\n]*?%/ims"; metadata:ruleset community; service:imap; reference:bugtraq,10976; reference:cve,2004-0777; classtype:attempted-admin; sid:2664; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP login literal format string attempt"; flow:to_server,established; content:"LOGIN",fast_pattern,nocase; pcre:"/\sLOGIN\s\w+\s\{\d+\}[\r]?\n[^\n]*?%/ims"; metadata:policy max-detect-ips drop,ruleset community; service:imap; reference:bugtraq,10976; reference:cve,2007-0221; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-026; classtype:attempted-admin; sid:2665; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:"PROTOCOL-POP PASS format string attempt"; flow:to_server,established; content:"PASS",fast_pattern,nocase; pcre:"/^PASS\s+[^\n]*?%/ims"; metadata:ruleset community; service:pop3; reference:bugtraq,10976; reference:cve,2004-0777; classtype:attempted-admin; sid:2666; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS UDP inverse query"; flow:to_server; byte_test:1,<,16,2; byte_test:1,&,8,2; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:bugtraq,2321; reference:cve,2001-0012; reference:nessus,10605; classtype:attempted-recon; sid:2921; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS TCP inverse query"; flow:to_server,established; byte_test:1,<,16,4; byte_test:1,&,8,4; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:bugtraq,2321; reference:cve,2001-0012; reference:nessus,10605; classtype:attempted-recon; sid:2922; rev:12; )
alert tcp $HOME_NET 139 -> $EXTERNAL_NET any ( msg:"NETBIOS SMB repeated logon failure"; flow:to_client,established,no_stream; content:"|FF|SMBs",depth 5,offset 4; content:"m|00 00 C0|",within 4; detection_filter:track by_dst,count 10,seconds 60; metadata:ruleset community; classtype:unsuccessful-user; sid:2923; rev:14; )
alert tcp $HOME_NET 445 -> $EXTERNAL_NET any ( msg:"NETBIOS SMB-DS repeated logon failure"; flow:to_client,established,no_stream; content:"|FF|SMBs",depth 5,offset 4; content:"m|00 00 C0|",within 4; detection_filter:track by_dst,count 10,seconds 60; metadata:ruleset community; service:netbios-ssn; classtype:unsuccessful-user; sid:2924; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 119 ( msg:"OS-WINDOWS Microsoft Windows XPAT pattern overflow attempt"; flow:to_server,established; content:"PAT|20|",depth 5,nocase; isdataat:160,relative; pcre:"/^X?PAT\s+[^\n]{160}/i"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:cve,2004-0574; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-036; classtype:attempted-admin; sid:2927; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP nddeapi NDdeSetTrustedShareW overflow attempt"; flow:to_server,established; dce_iface:uuid 2f5f3220-c126-1076-b549-074d078619da; dce_opnum:"12"; dce_stub_data; isdataat:256; content:!"|00|",depth 256,offset 12; metadata:ruleset community; service:netbios-ssn; reference:bugtraq,11372; reference:cve,2004-0206; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-031; classtype:attempted-admin; sid:2936; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"NETBIOS DCERPC NCACN-IP-TCP winreg InitiateSystemShutdown attempt"; flow:to_server,established; dce_iface:uuid 338cd001-2244-31f1-aaaa-900038001003; dce_opnum:"24"; metadata:ruleset community; service:netbios-ssn; reference:url,msdn.microsoft.com/library/default.asp?url=/library/en-us/shutdown/base/initiatesystemshutdown.asp; classtype:protocol-command-decode; sid:2942; rev:14; )
alert udp $EXTERNAL_NET 7808 -> $HOME_NET any ( msg:"SERVER-OTHER Volition Freespace 2 buffer overflow attempt"; flow:to_client; content:"|00 E1|..|B4 00 00 00|",depth 8; isdataat:160,relative; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,9785; classtype:misc-attack; sid:3006; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP command overflow attempt"; flow:to_server,established; content:"LOGIN"; isdataat:100,relative; pcre:"/\s(APPEND|CHECK|CLOSE|CREATE|DELETE|EXAMINE|EXPUNGE|FETCH|LIST|RENAME|SEARCH|SELECT|STATUS|SUBSCRIBE|UNSUBSCRIBE)\s[^\n]{100}/ims"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:imap; reference:bugtraq,11675; reference:bugtraq,11775; reference:bugtraq,15006; reference:bugtraq,15753; reference:cve,2004-1211; reference:cve,2005-0707; reference:cve,2005-1520; reference:cve,2005-2923; reference:cve,2005-3155; reference:nessus,15771; classtype:misc-attack; sid:3007; rev:22; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP delete literal overflow attempt"; flow:to_server,established; content:"DELETE",fast_pattern,nocase; pcre:"/\sDELETE\s[^\n]*?\{/ims"; byte_test:5,>,100,0,relative,string,dec; metadata:ruleset community; service:imap; reference:bugtraq,11675; reference:cve,2005-1520; reference:nessus,15771; classtype:misc-attack; sid:3008; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20034 ( msg:"MALWARE-BACKDOOR NetBus Pro 2.0 connection request"; flow:to_server,established; content:"BN |00 02 00|",depth 6; content:"|05 00|",depth 2,offset 8; flowbits:set,backdoor.netbus_2.connect; flowbits:noalert; metadata:ruleset community; classtype:misc-activity; sid:3009; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 22222 ( msg:"MALWARE-CNC RUX the Tick get windows directory"; flow:to_server,established; content:"WINDIR",depth 6; metadata:ruleset community; classtype:misc-activity; sid:3010; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 22222 ( msg:"MALWARE-CNC RUX the Tick get system directory"; flow:to_server,established; content:"SYSDIR",depth 6; metadata:ruleset community; classtype:misc-activity; sid:3011; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 22222 ( msg:"MALWARE-CNC RUX the Tick upload/execute arbitrary file"; flow:to_server,established; content:"ABCJZDATEIV",depth 11; metadata:ruleset community; classtype:misc-activity; sid:3012; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 23432 ( msg:"MALWARE-CNC Asylum 0.1 connection request"; flow:to_server,established; content:"RQS",depth 3; flowbits:set,backdoor.asylum.connect; flowbits:noalert; metadata:ruleset community; classtype:misc-activity; sid:3013; rev:8; )
alert tcp $HOME_NET 23432 -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Asylum 0.1 connection"; flow:to_client,established; flowbits:isset,backdoor.asylum.connect; content:"GNT",depth 3; metadata:ruleset community; classtype:misc-activity; sid:3014; rev:10; )
alert tcp $HOME_NET 2000 -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Insane Network 4.0 connection"; flow:to_client,established; content:"Insane Network vs 4.0 by Suid Flow|0A 0D|www.blackcode.com|0A 0D|[r00t]|23|",depth 62; metadata:ruleset community; classtype:misc-activity; sid:3015; rev:10; )
alert tcp $HOME_NET 63536 -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Insane Network 4.0 connection port 63536"; flow:to_client,established; content:"Insane Network vs 4.0 by Suid Flow|0A 0D|www.blackcode.com|0A 0D|[r00t]|23|",depth 62; metadata:ruleset community; classtype:misc-activity; sid:3016; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 42 ( msg:"OS-WINDOWS Microsoft Windows WINS overflow attempt"; flow:to_server,established; byte_test:1,&,64,6; byte_test:1,&,32,6; byte_test:1,&,16,6; byte_test:1,&,8,6; pcre:!"/^.{8}(\x05\x37(\x1E[\x90-\xFF]|[\x1F-\x2F].|\x30[\x00-\x70])|\x00\x00\x00[\x00-\x65]|\x02\x68\x05\xC0)/s"; metadata:policy max-detect-ips drop,ruleset community; service:wins; reference:bugtraq,11763; reference:cve,2004-0567; reference:cve,2004-1080; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-045; reference:url,www.immunitysec.com/downloads/instantanea.pdf; classtype:misc-attack; sid:3017; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE oversized Security Descriptor attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-15,relative,from_beginning,little; pcre:"/^.{4}/R"; byte_test:4,>,1024,36,relative,little; metadata:ruleset community; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3018; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE andx oversized Security Descriptor attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,!&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-15,relative,from_beginning,little; pcre:"/^.{4}/R"; byte_test:4,>,1024,36,relative,little; metadata:ruleset community; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3019; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE unicode oversized Security Descriptor attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-15,relative,from_beginning,little; pcre:"/^.{4}/R"; byte_test:4,>,1024,36,relative,little; metadata:ruleset community; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3020; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE unicode andx oversized Security Descriptor attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-15,relative,from_beginning,little; pcre:"/^.{4}/R"; byte_test:4,>,1024,36,relative,little; metadata:ruleset community; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3021; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE oversized Security Descriptor attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-15,relative,from_beginning,little; pcre:"/^.{4}/R"; byte_test:4,>,1024,36,relative,little; metadata:ruleset community; service:netbios-ssn; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3022; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE andx oversized Security Descriptor attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,!&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-15,relative,from_beginning,little; pcre:"/^.{4}/R"; byte_test:4,>,1024,36,relative,little; metadata:ruleset community; service:netbios-ssn; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3023; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE unicode oversized Security Descriptor attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-15,relative,from_beginning,little; pcre:"/^.{4}/R"; byte_test:4,>,1024,36,relative,little; metadata:ruleset community; service:netbios-ssn; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3024; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE unicode andx oversized Security Descriptor attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-15,relative,from_beginning,little; pcre:"/^.{4}/R"; byte_test:4,>,1024,36,relative,little; metadata:ruleset community; service:netbios-ssn; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3025; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE SACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3026; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE andx SACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,!&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3027; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE unicode SACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3028; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE unicode andx SACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3029; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE SACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; service:netbios-ssn; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3030; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE andx SACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,!&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; service:netbios-ssn; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3031; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE unicode SACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; service:netbios-ssn; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3032; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE unicode andx SACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; service:netbios-ssn; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3033; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE DACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3034; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE andx DACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,!&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3035; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE unicode DACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3036; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE unicode andx DACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3037; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE DACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; service:netbios-ssn; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3038; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE andx DACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,!&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; service:netbios-ssn; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3039; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE unicode DACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; service:netbios-ssn; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3040; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE unicode andx DACL overflow attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; byte_test:4,>,32,-16,relative,little; metadata:ruleset community; service:netbios-ssn; reference:cve,2004-1154; classtype:protocol-command-decode; sid:3041; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; classtype:protocol-command-decode; sid:3042; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE andx invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,!&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; classtype:protocol-command-decode; sid:3043; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE unicode invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; classtype:protocol-command-decode; sid:3044; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE unicode andx invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; classtype:protocol-command-decode; sid:3045; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3046; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE andx invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,!&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3047; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE unicode invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3048; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE unicode andx invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 12; byte_jump:4,12,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3049; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; classtype:protocol-command-decode; sid:3050; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE andx invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,!&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; classtype:protocol-command-decode; sid:3051; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE unicode invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; classtype:protocol-command-decode; sid:3052; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB NT Trans NT CREATE unicode andx invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; classtype:protocol-command-decode; sid:3053; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3054; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE andx invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,!&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3055; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE unicode invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB|A0|",within 5,distance 3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3056; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS NT Trans NT CREATE unicode andx invalid SACL ace size dos attempt"; flow:stateless; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; byte_test:1,&,128,6,relative; content:"|A0|",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 37; byte_jump:4,-7,relative,from_beginning,little; pcre:"/^.{4}/R"; content:!"|00 00 00 00|",within 4,distance 16; byte_jump:4,16,relative,little; content:"|00 00|",within 2,distance -10; metadata:ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3057; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP copy literal overflow attempt"; flow:to_server,established; content:"COPY",fast_pattern,nocase; pcre:"/\sCOPY\s[^\n]*?\{/ims"; byte_test:5,>,1024,0,relative,string,dec; metadata:ruleset community; service:imap; reference:bugtraq,1110; reference:cve,2000-0284; reference:nessus,10374; classtype:misc-attack; sid:3058; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3632 ( msg:"APP-DETECT distccd remote command execution attempt"; flow:to_server,established; content:"DIST00000001",depth 12,nocase; metadata:ruleset community; reference:url,distcc.samba.org/security.html; classtype:policy-violation; sid:3061; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1020 ( msg:"MALWARE-BACKDOOR Vampire 1.2 connection request"; flow:to_server,established; content:"Hello...",depth 8; flowbits:set,backdoor.vampire_12.connect; flowbits:noalert; metadata:ruleset community; classtype:misc-activity; sid:3063; rev:6; )
alert tcp $HOME_NET 1020 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Vampire 1.2 connection confirmation"; flow:to_client,established; flowbits:isset,backdoor.vampire_12.connect; content:"Vampire v1.2 Server On-Line.....",depth 32; metadata:ruleset community; classtype:misc-activity; sid:3064; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP append literal overflow attempt"; flow:to_server,established; content:"APPEND",fast_pattern,nocase; pcre:"/\sAPPEND\s[^\n]*?\s\{/ims"; byte_test:5,>,256,0,relative,string,dec; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:imap; reference:bugtraq,11775; reference:cve,2004-1211; reference:nessus,15867; classtype:misc-attack; sid:3065; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP APPEND overflow attempt"; flow:to_server,established; content:"APPEND",nocase; isdataat:256,relative; content:!"|0D 0A|",within 256; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:imap; reference:bugtraq,11775; reference:bugtraq,21729; reference:cve,2004-1211; reference:cve,2006-6425; reference:nessus,15867; classtype:misc-attack; sid:3066; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP examine literal overflow attempt"; flow:to_server,established; content:"EXAMINE",fast_pattern,nocase; pcre:"/\sEXAMINE\s[^\n]*?\s\{/ims"; byte_test:5,>,256,0,relative,string,dec; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:imap; reference:bugtraq,11775; reference:cve,2004-1211; reference:nessus,15867; classtype:misc-attack; sid:3067; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP fetch literal overflow attempt"; flow:to_server,established; content:"FETCH",fast_pattern,nocase; pcre:"/\sFETCH\s[^\n]*?\s\{/ims"; byte_test:5,>,256,0,relative,string,dec; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:imap; reference:bugtraq,11775; reference:cve,2004-1211; reference:nessus,15867; classtype:misc-attack; sid:3069; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP fetch overflow attempt"; flow:to_server,established; content:"FETCH",nocase; isdataat:256,relative; pcre:"/\sFETCH\s[^\n]{256}/ims"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:imap; reference:bugtraq,11775; reference:cve,2004-1211; reference:nessus,15867; classtype:misc-attack; sid:3070; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP status literal overflow attempt"; flow:to_server,established; content:"STATUS",fast_pattern,nocase; pcre:"/\sSTATUS[^\n]*?\{/ims"; byte_test:5,>,256,0,relative,string,dec; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:imap; reference:bugtraq,11775; reference:bugtraq,15491; reference:cve,2004-1211; reference:nessus,15867; classtype:misc-attack; sid:3071; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP STATUS overflow attempt"; flow:to_server,established; content:"STATUS",nocase; isdataat:100,relative; content:!"|0D 0A|",within 100; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:imap; reference:bugtraq,11775; reference:bugtraq,13727; reference:bugtraq,14243; reference:bugtraq,15491; reference:cve,2004-1211; reference:cve,2005-1256; reference:cve,2005-2278; reference:cve,2005-3314; reference:cve,2017-1274; reference:nessus,15867; classtype:misc-attack; sid:3072; rev:20; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP SUBSCRIBE literal overflow attempt"; flow:to_server,established; content:"SUBSCRIBE",fast_pattern,nocase; pcre:"/^\w+\s+SUBSCRIBE\s[^\n]*?\{/ims"; byte_test:5,>,256,0,relative,string; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:imap; reference:bugtraq,11775; reference:bugtraq,15488; reference:bugtraq,23050; reference:bugtraq,26219; reference:cve,2004-1211; reference:cve,2005-3189; reference:cve,2007-3510; reference:nessus,15867; classtype:attempted-admin; sid:3073; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP SUBSCRIBE overflow attempt"; flow:to_server,established; content:"SUBSCRIBE",nocase; isdataat:100; pcre:"/^\w+\s+SUBSCRIBE\s[^\n]{100}/ims"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:imap; reference:bugtraq,11775; reference:bugtraq,15488; reference:bugtraq,23050; reference:bugtraq,26219; reference:cve,2004-1211; reference:cve,2005-3189; reference:cve,2007-1579; reference:cve,2007-3510; reference:nessus,15867; classtype:attempted-admin; sid:3074; rev:20; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP unsubscribe literal overflow attempt"; flow:to_server,established; content:"UNSUBSCRIBE",fast_pattern,nocase; pcre:"/\sUNSUBSCRIBE\s[^\n]*?\s\{/ims"; byte_test:5,>,256,0,relative,string,dec; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:imap; reference:bugtraq,11775; reference:cve,2004-1211; reference:nessus,15867; classtype:misc-attack; sid:3075; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"PROTOCOL-IMAP UNSUBSCRIBE overflow attempt"; flow:to_server,established; content:"UNSUBSCRIBE",nocase; isdataat:100; pcre:"/^\w+\s+UNSUBSCRIBE\s[^\n]{100}/ims"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:imap; reference:bugtraq,11775; reference:bugtraq,15488; reference:cve,2004-1211; reference:cve,2005-3189; reference:nessus,15867; classtype:attempted-admin; sid:3076; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP RNFR overflow attempt"; flow:to_server,established; content:"RNFR",nocase; isdataat:200,relative; pcre:"/^RNFR\s[^\n]{200}/ims"; metadata:ruleset community; service:ftp; reference:bugtraq,14339; classtype:attempted-admin; sid:3077; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 119 ( msg:"PROTOCOL-NNTP Microsoft Windows SEARCH pattern overflow attempt"; flow:to_server,established; content:"SEARCH|20|",depth 7,nocase; isdataat:160,relative; pcre:"/^SEARCH\s+[^\n]{160}/i"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:cve,2004-0574; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-036; classtype:attempted-admin; sid:3078; rev:13; )
alert udp $EXTERNAL_NET any -> $HOME_NET 7787 ( msg:"SERVER-OTHER Unreal Tournament secure overflow attempt"; flow:to_server; content:"|5C|secure|5C|",fast_pattern,nocase; pcre:"/\x5csecure\x5c[^\x00]{50}/ims"; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,10570; reference:cve,2004-0608; classtype:misc-attack; sid:3080; rev:9; )
alert tcp $HOME_NET 5880 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Y3KRAT 1.5 Connect"; flow:to_client,established; content:"connected",depth 9; flowbits:set,backdoor.y3krat_15.connect; flowbits:noalert; metadata:ruleset community; classtype:misc-activity; sid:3081; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 5880 ( msg:"MALWARE-BACKDOOR Y3KRAT 1.5 Connect Client Response"; flow:to_server,established; flowbits:isset,backdoor.y3krat_15.connect; content:"getclient",depth 9; flowbits:set,backdoor.y3krat_15.client.response; flowbits:noalert; metadata:ruleset community; classtype:misc-activity; sid:3082; rev:13; )
alert tcp $HOME_NET 5880 -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Y3KRAT 1.5 Connection confirmation"; flow:to_client,established; flowbits:isset,backdoor.y3krat_15.client.response; content:"client",depth 7; metadata:ruleset community; classtype:misc-activity; sid:3083; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6101 ( msg:"SERVER-OTHER Veritas backup overflow attempt"; flow:to_server,established; content:"|02 00|",depth 2; content:"|00|",within 1,distance 1; isdataat:72; content:!"|00|",depth 66,offset 6; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,11974; reference:cve,2004-1172; classtype:attempted-admin; sid:3084; rev:16; )
alert udp $EXTERNAL_NET any -> $HOME_NET 2048 ( msg:"SERVER-OTHER squid WCCP I_SEE_YOU message overflow attempt"; flow:to_server; content:"|00 00 00 08|",depth 4; byte_test:4,>,32,16; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,12275; reference:cve,2005-0095; classtype:attempted-user; sid:3089; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP llsrpc LlsrConnect overflow attempt"; flow:to_server,established; dce_iface:uuid 342cfd40-3c6c-11ce-a893-08002b2e9c6d; dce_opnum:"0"; dce_stub_data; byte_test:4,>,52,0,dce; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-010; classtype:attempted-admin; sid:3114; rev:20; )
alert tcp $EXTERNAL_NET 1863 -> $HOME_NET any ( msg:"PUA-OTHER Microsoft MSN Messenger png overflow"; flow:to_client,established; content:"application/x-msnmsgrp2p",nocase; content:"|89|PNG|0D 0A 1A 0A|",distance 0; content:"IHDR",within 4,distance 4; content:"|03|",within 1,distance 9; content:"tRNS",distance 0; byte_test:4,>,256,-8,relative,big; metadata:ruleset community; reference:bugtraq,10872; reference:cve,2004-0957; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-009; classtype:attempted-user; sid:3130; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB Trans2 QUERY_FILE_INFO attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB2",within 5,distance 3; pcre:"/^.{27}/R"; content:"|07 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3135; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB Trans2 QUERY_FILE_INFO andx attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; content:"2",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|07 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3136; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS Trans2 QUERY_FILE_INFO attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB2",within 5,distance 3; pcre:"/^.{27}/R"; content:"|07 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3137; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS Trans2 QUERY_FILE_INFO andx attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; content:"2",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|07 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3138; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB Trans2 FIND_FIRST2 attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB2",within 5,distance 3; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3139; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 139 ( msg:"NETBIOS SMB Trans2 FIND_FIRST2 andx attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; content:"2",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3140; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS Trans2 FIND_FIRST2 attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB2",within 5,distance 3; pcre:"/^.{27}/R"; content:"|01 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3141; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"NETBIOS SMB-DS Trans2 FIND_FIRST2 andx attempt"; flow:to_server,established; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; content:"2",depth 1,offset 39; byte_jump:2,0,relative,little; content:"|01 00|",within 2,distance 29; flowbits:set,smb.trans2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:3142; rev:11; )
alert tcp $HOME_NET 139 -> $EXTERNAL_NET any ( msg:"OS-WINDOWS Microsoft Windows SMB Trans2 FIND_FIRST2 command response overflow attempt"; flow:to_client,established; flowbits:isset,smb.trans2; content:"|00|",depth 1; content:"|FF|SMB2",within 5,distance 3; pcre:"/^.{27}/R"; flowbits:unset,smb.trans2; byte_test:2,>,15,7,relative,little; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,12484; reference:cve,2005-0045; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-011; classtype:protocol-command-decode; sid:3143; rev:17; )
alert tcp $HOME_NET 139 -> $EXTERNAL_NET any ( msg:"OS-WINDOWS Microsoft Windows SMB Trans2 FIND_FIRST2 response andx overflow attempt"; flow:to_client,established; flowbits:isset,smb.trans2; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; content:"2",depth 1,offset 39; byte_jump:2,0,relative,little; flowbits:unset,smb.trans2; byte_test:2,>,15,7,relative,little; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,12484; reference:cve,2005-0045; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-011; classtype:protocol-command-decode; sid:3144; rev:17; )
alert tcp $HOME_NET 445 -> $EXTERNAL_NET any ( msg:"OS-WINDOWS Microsoft Windows SMB-DS Trans2 FIND_FIRST2 response overflow attempt"; flow:to_client,established; flowbits:isset,smb.trans2; content:"|00|",depth 1; content:"|FF|SMB2",within 5,distance 3; pcre:"/^.{27}/R"; flowbits:unset,smb.trans2; byte_test:2,>,15,7,relative,little; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ssn; reference:bugtraq,12484; reference:cve,2005-0045; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-011; classtype:protocol-command-decode; sid:3145; rev:16; )
alert tcp $HOME_NET 445 -> $EXTERNAL_NET any ( msg:"OS-WINDOWS Microsoft Windows SMB-DS Trans2 FIND_FIRST2 response andx overflow attempt"; flow:to_client,established; flowbits:isset,smb.trans2; content:"|00|",depth 1; content:"|FF|SMB",within 4,distance 3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/Rs"; content:"2",depth 1,offset 39; byte_jump:2,0,relative,little; flowbits:unset,smb.trans2; byte_test:2,>,15,7,relative,little; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ssn; reference:bugtraq,12484; reference:cve,2005-0045; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-011; classtype:protocol-command-decode; sid:3146; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 79 ( msg:"PROTOCOL-FINGER / execution attempt"; flow:to_server,established; content:"/"; pcre:"/^\x2f/ims"; metadata:ruleset community; reference:cve,1999-0612; reference:cve,2000-0915; classtype:attempted-recon; sid:3151; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS TCP inverse query overflow"; flow:to_server,established; byte_test:1,<,16,4; byte_test:1,&,8,4; isdataat:400; metadata:ruleset community; service:dns; reference:bugtraq,134; reference:cve,1999-0009; classtype:attempted-admin; sid:3153; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS UDP inverse query overflow"; flow:to_server; isdataat:400; byte_test:1,<,16,2; byte_test:1,&,8,2; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:bugtraq,134; reference:cve,1999-0009; classtype:attempted-admin; sid:3154; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 31337 ( msg:"MALWARE-BACKDOOR BackOrifice 2000 Inbound Traffic"; flow:to_server,established; content:"1j|D0 D9|"; metadata:ruleset community; classtype:trojan-activity; sid:3155; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP ISystemActivator CoGetInstanceFromFile attempt"; flow:to_server,established; dce_iface:uuid 000001a0-0000-0000-c000-000000000046; dce_opnum:"1"; dce_stub_data; content:"|01 10 08 00 CC CC CC CC|"; content:"|5C 00 5C 00|",distance 0; byte_test:4,>,256,-8,relative,dce; metadata:ruleset community; service:netbios-ssn; reference:cve,2003-0715; reference:url,technet.microsoft.com/en-us/security/bulletin/ms03-039; classtype:protocol-command-decode; sid:3158; rev:17; )
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP ISystemActivator CoGetInstanceFromFile attempt"; dce_iface:uuid 000001a0-0000-0000-c000-000000000046; dce_opnum:"1"; dce_stub_data; content:"|01 10 08 00 CC CC CC CC|"; content:"|5C 00 5C 00|",distance 0; byte_test:4,>,256,-8,relative,dce; metadata:policy max-detect-ips drop,ruleset community; service:dcerpc; reference:cve,2003-0715; reference:url,technet.microsoft.com/en-us/security/bulletin/ms03-039; classtype:protocol-command-decode; sid:3159; rev:17; )
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP msqueue function 4 overflow attempt"; dce_iface:uuid 975201b0-59ca-11d0-a8d5-00a0c90d8051; dce_opnum:"4"; dce_stub_data; byte_test:4,>,128,8,dce; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:dcerpc; reference:cve,2005-0059; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-017; classtype:attempted-admin; sid:3171; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 137 ( msg:"OS-WINDOWS name query overflow attempt TCP"; flow:to_server,established; byte_test:1,&,64,2; content:" ",offset 12; isdataat:56,relative; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ns; reference:bugtraq,9624; reference:cve,2003-0825; reference:nessus,15912; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-006; classtype:attempted-admin; sid:3195; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET 137 ( msg:"OS-WINDOWS name query overflow attempt UDP"; byte_test:1,&,64,2; content:" ",offset 12; isdataat:56,relative; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ns; reference:bugtraq,9624; reference:cve,2003-0825; reference:nessus,15912; reference:url,technet.microsoft.com/en-us/security/bulletin/ms04-006; classtype:attempted-admin; sid:3196; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 42 ( msg:"OS-WINDOWS Microsoft Windows WINS name query overflow attempt TCP"; flow:established; byte_test:1,&,64,2; content:" ",offset 12; isdataat:56,relative; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,9624; reference:cve,2003-0825; reference:nessus,15912; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-006; classtype:attempted-admin; sid:3199; rev:12; )
alert udp $EXTERNAL_NET any -> $HOME_NET 42 ( msg:"OS-WINDOWS Microsoft Windows WINS name query overflow attempt UDP"; flow:to_server; byte_test:1,&,64,2; content:" ",offset 12; isdataat:56,relative; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,9624; reference:cve,2003-0825; reference:nessus,15912; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-006; classtype:attempted-admin; sid:3200; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP winreg OpenKey overflow attempt"; flow:to_server,established; dce_iface:uuid 338cd001-2244-31f1-aaaa-900038001003; dce_opnum:"15"; dce_stub_data; byte_test:2,>,1024,20,dce; metadata:ruleset community; service:netbios-ssn; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-040; classtype:attempted-admin; sid:3218; rev:23; )
alert udp $EXTERNAL_NET any -> $HOME_NET 135 ( msg:"OS-WINDOWS Messenger message little endian overflow attempt"; content:"|04 00|",depth 2; byte_test:1,&,16,2,relative; content:"|F8 91|{Z|00 FF D0 11 A9 B2 00 C0|O|B6 E6 FC|",within 16,distance 22; content:"|00 00|",within 2,distance 28; byte_jump:4,18,relative,little,align; byte_jump:4,8,relative,little,align; byte_test:4,>,1024,8,relative,little; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,8826; reference:cve,2003-0717; classtype:attempted-admin; sid:3234; rev:6; )
alert udp $EXTERNAL_NET any -> $HOME_NET 135 ( msg:"OS-WINDOWS Messenger message overflow attempt"; content:"|04 00|",depth 2; byte_test:1,!&,16,2,relative; content:"|F8 91|{Z|00 FF D0 11 A9 B2 00 C0|O|B6 E6 FC|",within 16,distance 22; content:"|00 00|",within 2,distance 28; byte_jump:4,18,relative,align; byte_jump:4,8,relative,align; byte_test:4,>,1024,8,relative; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,8826; reference:cve,2003-0717; classtype:attempted-admin; sid:3235; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP irot IrotIsRunning/Revoke overflow attempt"; flow:to_server,established; dce_iface:uuid b9e79e60-3d52-11ce-aaa1-00006901293f; dce_opnum:"1-2"; dce_stub_data; pcre:"/^(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,relative,dce,align; byte_test:4,>,1024,0,relative,dce; metadata:ruleset community; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,technet.microsoft.com/en-us/security/bulletin/ms03-010; classtype:attempted-admin; sid:3238; rev:15; )
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP irot IrotIsRunning/Revoke overflow attempt"; dce_iface:uuid b9e79e60-3d52-11ce-aaa1-00006901293f; dce_opnum:"1-2"; dce_stub_data; pcre:"/^(\x00\x00\x00\x00|.{12})/s"; byte_jump:4,-4,relative,dce,align; byte_test:4,>,1024,0,relative,dce; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,technet.microsoft.com/en-us/security/bulletin/ms03-010; classtype:attempted-admin; sid:3239; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP ISystemActivator RemoteCreateInstance attempt"; flow:to_server,established; dce_iface:uuid 000001a0-0000-0000-c000-000000000046; dce_opnum:"4"; dce_stub_data; content:"|01 10 08 00 CC CC CC CC|"; content:"|5C 00 5C 00|",distance 0; byte_test:4,>,256,-8,relative,dce; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ssn; reference:bugtraq,8205; reference:cve,2003-0352; reference:cve,2003-0715; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-026; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:protocol-command-decode; sid:3397; rev:18; )
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP ISystemActivator RemoteCreateInstance attempt"; dce_iface:uuid 000001a0-0000-0000-c000-000000000046; dce_opnum:"4"; dce_stub_data; content:"|01 10 08 00 CC CC CC CC|"; content:"|5C 00 5C 00|",distance 0; byte_test:4,>,256,-8,relative,dce; metadata:policy max-detect-ips drop,ruleset community; service:dcerpc; reference:bugtraq,8205; reference:cve,2003-0352; reference:cve,2003-0715; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-026; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:protocol-command-decode; sid:3398; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP IActivation remoteactivation overflow attempt"; flow:to_server,established; dce_iface:uuid 4d9f4ab8-7d1c-11cf-861e-0020af6e7c57; dce_opnum:"0"; dce_stub_data; byte_test:4,>,256,52,dce; metadata:policy max-detect-ips drop,ruleset community; service:dcerpc,netbios-ssn; reference:bugtraq,8205; reference:cve,2003-0352; reference:cve,2003-0528; reference:cve,2003-0715; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-026; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:attempted-admin; sid:3409; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP PORT bounce attempt"; flow:to_server,established; content:"PORT",nocase; pcre:"/^PORT/ims"; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:bugtraq,126; reference:cve,1999-0017; reference:nessus,10081; classtype:misc-attack; sid:3441; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 515 ( msg:"OS-WINDOWS Microsoft Windows TCP print service overflow attempt"; flow:to_server,established; pcre:"/^(\x03|\x04|\x05)/s"; content:"|00|",within 497; content:"|0A|",within 497; metadata:ruleset community; reference:bugtraq,1082; reference:cve,2000-0232; reference:url,technet.microsoft.com/en-us/security/bulletin/MS00-021; classtype:attempted-dos; sid:3442; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 617 ( msg:"SERVER-OTHER Arkeia client backup system info probe"; flow:to_server,established; content:"ARKADMIN_GET_"; pcre:"/^(CLIENT|MACHINE)_INFO/Ri"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,12594; reference:cve,2005-0491; classtype:attempted-recon; sid:3453; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 617 ( msg:"SERVER-OTHER Arkeia client backup generic info probe"; flow:to_server,established; content:"ARKFS|00|root|00|root",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,12594; reference:cve,2005-0491; classtype:attempted-recon; sid:3454; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 5001 ( msg:"SERVER-OTHER Bontago Game Server Nickname buffer overflow"; flow:to_server,established; content:"|FF 01 00 00 00 00 01|"; isdataat:512,relative; metadata:ruleset community; reference:bugtraq,12603; reference:cve,2005-0501; reference:url,aluigi.altervista.org/adv/bontagobof-adv.txt; classtype:attempted-user; sid:3455; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 617 ( msg:"SERVER-OTHER Arkeia backup client type 77 overflow attempt"; flow:to_server,established; content:"|00|M",depth 2; byte_test:2,>,23,6; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,12594; reference:cve,2005-0491; reference:nessus,17158; classtype:attempted-user; sid:3457; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 617 ( msg:"SERVER-OTHER Arkeia backup client type 84 overflow attempt"; flow:to_server,established; content:"|00|T",depth 2; byte_test:2,>,255,6; isdataat:263; content:!"|00|",depth 255,offset 8; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:bugtraq,12594; reference:cve,2005-0491; classtype:attempted-user; sid:3458; rev:9; )
alert udp $HOME_NET any -> $EXTERNAL_NET 41170 ( msg:"PUA-P2P Manolito Search Query"; flow:to_server; content:"|01 02 00 14|",depth 4,offset 16; metadata:ruleset community; reference:url,openlito.sourceforge.net; reference:url,www.blubster.com; classtype:policy-violation; sid:3459; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP REST with numeric argument"; flow:to_server,established; content:"REST",fast_pattern,nocase; pcre:"/REST\s+[0-9]+\n/i"; metadata:ruleset community; service:ftp; reference:bugtraq,7825; classtype:attempted-recon; sid:3460; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.Hydraq variant outbound connection"; flow:to_server,established; content:"|FF FF FF FF FF FF 00 00 FE FF FF FF FF FF FF FF FF FF 88 FF|",depth 20; metadata:impact_flag red,ruleset community; service:ssl; reference:url,www.virustotal.com/#/file/9051f618a5a8253a003167e65ce1311fa91a8b70d438a384be48b02e73ba855c/detection; classtype:trojan-activity; sid:16368; rev:8; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 445 ( msg:"NETBIOS SMB TRANS2 Find_First2 request attempt"; flow:to_server,established; content:"|FF|SMB2|00 00 00 00|",depth 9,offset 4; content:"|00 00|",within 2,distance 13; content:"|00|",within 1,distance 18; content:"|00 00|",within 2,distance 6; content:"|01 00|",within 2,distance 10; flowbits:set,smb.trans2.findfirst2; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:17745; rev:10; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 445 ( msg:"NETBIOS SMB-DS Trans2 Distributed File System GET_DFS_REFERRAL request"; flow:to_server,established; content:"|00|",offset 1; content:"|FF|SMB2",depth 5,offset 4; content:"|00 00 00 00|",within 4; content:"|10 00|",depth 2,offset 65; flowbits:set,smb.trans2.get_dfs_referral; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:19190; rev:9; )
alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:"SERVER-OTHER multiple products blacknurse ICMP denial of service attempt"; icode:3; itype:3; detection_filter:track by_src,count 250,seconds 1; metadata:policy max-detect-ips drop,ruleset community; reference:cve,2011-1871; reference:url,soc.tdc.dk/blacknurse/blacknurse.pdf; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-064; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-083; classtype:attempted-dos; sid:19678; rev:10; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 12080 ( msg:"MALWARE-CNC Win.Trojan.Derusbi.A variant outbound connection"; flow:to_server,established; content:"|00 00 00 01 00 00 00|",depth 7,offset 1; content:"|01 00 00 00 68 01 00 00|",within 8,distance 8; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/6fecd042c3c0b54e7354cd8dfb1975c626acd8df55f88c4149462e15e77918b0/analysis/; reference:url,www.virustotal.com/en/file/705404d6bbf6dae254e2d3bc44eca239976be7f0dc4d49fe93b0fb1d1c2704fe/analysis/; classtype:trojan-activity; sid:20080; rev:8; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY Microsoft Windows EMF metafile file attachment detected"; flow:to_client,established; content:".emf",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2eemf/i"; flowbits:set,file.emf; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:20850; rev:17; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY PDF file attachment detected"; flow:to_client,established; content:".pdf",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2epdf/i"; flowbits:set,file.pdf; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21035; rev:17; )
alert tcp $EXTERNAL_NET 21 -> $HOME_NET any ( msg:"MALWARE-OTHER known malicious FTP login banner - 0wns j0"; flow:to_client,established; content:"220|20|",depth 4; content:"0wns j0",distance 0,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ftp; reference:url,seclists.org/fulldisclosure/2004/Sep/895; reference:url,www.cyber-ta.org/releases/malware-analysis/public/SOURCES/CLUSTERS-NEW/behavior-summary.html; classtype:trojan-activity; sid:21255; rev:6; )
alert tcp $EXTERNAL_NET 21 -> $HOME_NET any ( msg:"MALWARE-OTHER known malicious FTP quit banner - Goodbye happy r00ting"; flow:to_client,established; content:"221 Goodbye happy r00ting",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ftp; reference:url,taosecurity.blogspot.com/2006/01/nepenthes-discoveries-earlier-today-i.html; classtype:trojan-activity; sid:21256; rev:7; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY XSL file attachment detected"; flow:to_client,established; content:".xsl",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2exsl/i"; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; reference:url,attack.mitre.org/techniques/T1220; classtype:misc-activity; sid:21283; rev:13; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY XSLT file attachment detected"; flow:to_client,established; content:".xslt",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2exslt/i"; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; reference:url,attack.mitre.org/techniques/T1220; classtype:misc-activity; sid:21286; rev:13; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY paq8o file attachment detected"; flow:to_client,established; content:".paq8o",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2epaq8o/i"; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21411; rev:16; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY XML file attachment detected"; flow:to_client,established; content:".xml",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2exml/i"; flowbits:set,file.xml; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21499; rev:11; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY PNG file attachment detected"; flow:to_client,established; content:".png",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2epng/i"; flowbits:set,file.png; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21613; rev:16; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY SMI file attachment detected"; flow:to_client,established; content:".smi",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2esmi/i"; flowbits:set,file.realplayer.playlist; flowbits:set,file.dmg; flowbits:set,file.smi; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21695; rev:12; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY SAMI file attachment detected"; flow:to_client,established; content:".sami",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2esami/i"; flowbits:set,file.realplayer.playlist; flowbits:set,file.smi; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21697; rev:12; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY ANI file attachment detected"; flow:to_client,established; content:".ani",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2eani/i"; flowbits:set,file.ani; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21725; rev:12; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY JPG file attachment detected"; flow:to_client,established; content:".jpg",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2ejpg/i"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21728; rev:12; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY JPG file attachment detected"; flow:to_client,established; content:".jpeg",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2ejpeg/i"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21730; rev:12; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY JPG file attachment detected"; flow:to_client,established; content:".pjpeg",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2epjpeg/i"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21732; rev:12; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY JPG file attachment detected"; flow:to_client,established; content:".jpe",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2ejpe/i"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21734; rev:12; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY JPG file attachment detected"; flow:to_client,established; content:".jif",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2ejif/i"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21736; rev:12; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY JPG file attachment detected"; flow:to_client,established; content:".jfi",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2ejfi/i"; flowbits:set,file.jpeg; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21738; rev:13; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY RTF file attachment detected"; flow:to_client,established; content:".rtf",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2ertf/i"; flowbits:set,file.rtf; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21746; rev:12; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY ZIP file attachment detected"; flow:to_client,established; content:".zip",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2ezip/i"; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21856; rev:13; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY Portable Executable file attachment detected"; flow:to_client,established; content:".exe",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2eexe/i"; flowbits:set,file.exe; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:21908; rev:11; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY XM file attachment detected"; flow:to_client,established; content:".xm",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2exm/i"; flowbits:set,file.xm; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:22044; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"PROTOCOL-FTP Multiple Products FTP MKD buffer overflow attempt"; flow:to_server,established; content:"MKD ",depth 4; isdataat:75,relative; content:!"|0A|",within 75; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:bugtraq,11772; reference:bugtraq,15457; reference:bugtraq,23885; reference:bugtraq,39041; reference:bugtraq,612; reference:bugtraq,7278; reference:bugtraq,9872; reference:cve,1999-0911; reference:cve,2004-1135; reference:cve,2005-3683; reference:cve,2007-2586; reference:cve,2009-3023; reference:cve,2010-0625; reference:nessus,12108; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-053; reference:url,www.exploit-db.com/exploits/14399/; reference:url,www.kb.cert.org/vuls/id/276653; classtype:attempted-admin; sid:23055; rev:10; )
alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:"MALWARE-CNC Win.Trojan.ZeroAccess outbound connection"; flow:to_server; dsize:20; content:"|9E 98|",depth 2,offset 6; metadata:ruleset community; reference:url,www.virustotal.com/file/50cdd9f6c5629630c8d8a3a4fe7d929d3c6463b2f9407d9a90703047e7db7ff9/analysis/; classtype:trojan-activity; sid:23492; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Magania variant outbound connection"; flow:to_server,established; content:"User-Agent: Google page|0D 0A|",fast_pattern,nocase; content:".asp?"; content:"mac=",within 4; content:"&ver=",distance 0; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:url,www.seculert.com/blog/2013/06/adversary-arsenal-exposed-part-i-pinkstats.html; reference:url,www.virustotal.com/file/6a813f96bb65367a8b5c5ba2937c773785a0a0299032a6c77b9b0862be8bdb71/analysis/; classtype:trojan-activity; sid:24015; rev:8; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 84 ( msg:"MALWARE-OTHER Malicious UA detected on non-standard port"; flow:to_server,established,no_stream; content:"User-Agent|3A| Mozilla/5.0 |28|Windows|3B| U|3B| MSIE 9.0|3B| Windows NT 9.0|3B| en-US|29|"; detection_filter:track by_src,count 1,seconds 120; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,anubis.iseclab.org/?action=result&task_id=1691c3b8835221fa4692960681f39c736&format=html; classtype:trojan-activity; sid:24265; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS Microsoft Windows SMB NTLM NULL session attempt"; flow:to_server,established; content:"|FF|SMB|73 00 00 00 00|",depth 9,offset 4; content:"|00 00|",within 2,distance 13; content:"|FF|",within 1,distance 9; content:"NTLMSSP|00 03 00 00 00|",within 100; content:"|00 00 00 00 48 00 00 00|",within 8,distance 24,fast_pattern; flowbits:set,smb.null_session; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert,ruleset community; service:netbios-ssn; reference:bugtraq,1163; reference:cve,2000-0347; classtype:attempted-recon; sid:24359; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] ( msg:"NETBIOS SMB Trans2 FIND_FIRST2 find file and directory info request"; flow:to_server,established; content:"|FF|SMB2|00 00 00 00|",depth 9,offset 4; byte_test:1,!&,0x80,0,relative; content:"|01 00|",within 2,distance 52; byte_jump:2,-10,relative,from_beginning,little,post_offset 10; content:"|04 01|",within 2; flowbits:set,smb.trans2.fileinfo; flowbits:noalert; metadata:policy max-detect-ips alert,ruleset community; service:netbios-ssn; classtype:protocol-command-decode; sid:24972; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.Symmi variant outbound connection"; flow:to_server,established; content:"lfstream|26|",depth 9,offset 8; pcre:"/^POST\x20\x2fg[ao]lfstream\x26/"; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/file/f4c44b5331c30b62beacae5d343d591584715c2d9d6d65848216b61efd916ec1/analysis/; classtype:trojan-activity; sid:25511; rev:4; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1900 ( msg:"SERVER-OTHER libupnp command buffer overflow attempt"; flow:to_server; content:"M-SEARCH ",depth 9; content:"|3A|device|3A|"; isdataat:180,relative; content:!"|3A|",within 180; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssdp; reference:cve,2012-5958; reference:cve,2012-5962; classtype:attempted-admin; sid:25589; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 1024:65535 ( msg:"MALWARE-CNC Win.Trojan.Fakeavlock variant outbound connection"; flow:to_server,established; isdataat:266; isdataat:!276; http_header; content:"User-Agent|3A| Mozilla/5.0 (Windows|3B| U|3B| MSIE 9.0|3B| Windows NT 9.0|3B| en-US)|0D 0A|",fast_pattern,nocase; http_raw_uri; bufferlen:159; http_uri; pcre:"/\x2f[A-F0-9]{158}/"; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/file/c49f7dbc036ad0a86df02cbbde00cb3b3fbd651d82f6c9c5a98170644374f64f/analysis/; classtype:trojan-activity; sid:25675; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 ( msg:"APP-DETECT Ammyy remote access tool"; flow:to_server,established; http_method; content:"POST"; http_header; content:"|0A|Host|3A 20|rl.ammyy.com|0D 0A|",fast_pattern,nocase; metadata:ruleset community; service:http; reference:url,www.ammyy.com; classtype:policy-violation; gid:1; sid:25947; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Daws Trojan Outbound Plaintext over SSL Port"; flow:to_server,established; content:"POST",depth 4; pcre:"/^POST\x20\x2f[a-z]+\.[a-z]{3}\x20HTTP\x2f1\.1\r\n/"; content:"|0D 0A|Content|2D|Disposition|3A 20|form|2D|data|3B 20|name|3D 22|"; pcre:"/[^\x0d\x0a\x09\x20-\x7e]{4}/R"; pcre:"/\d+\x2d{2}\r\n$/R"; metadata:impact_flag red,ruleset community; service:ssl; reference:url,www.virustotal.com/file/f810c56734a686fdf46eb3ff895db6f3dd0cebb45c1e74bcc1c43f8050242d53/analysis/1359999907/; classtype:trojan-activity; sid:26289; rev:2; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"MALWARE-OTHER UTF-8 BOM in zip file attachment detected"; flow:to_client,established; file_data; content:"|EF BB BF 50 4B 03 04|",depth 7; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ftp-data,imap,pop3; classtype:trojan-activity; sid:26381; rev:5; )
alert tcp any any -> $HOME_NET 445 ( msg:"MALWARE-OTHER Win.Worm.Dorkbot folder snkb0ptz creation attempt SMB"; flow:to_server,established; content:"|73 00 6E 00 6B 00 62 00 30 00 70 00 74 00 7A 00|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ssn; classtype:trojan-activity; sid:26411; rev:3; )
alert tcp any any -> $HOME_NET 445 ( msg:"MALWARE-OTHER Win.Worm.Dorkbot executable snkb0ptz.exe creation attempt SMB"; flow:to_server,established; content:"|73 00 6E 00 6B 00 62 00 30 00 70 00 74 00 7A 00|",fast_pattern,nocase; content:".exe"; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ssn; classtype:trojan-activity; sid:26412; rev:3; )
alert tcp any any -> $HOME_NET 445 ( msg:"MALWARE-OTHER Win.Worm.Dorkbot Desktop.ini snkb0ptz.exe creation attempt SMB"; flow:to_server,established; content:"|73 00 6E 00 6B 00 62 00 30 00 70 00 74 00 7A 00|"; content:"|5C|",within 1; content:"|00 44 00 65 00 73 00 6B 00 74 00 6F 00 70 00 2E 00 69 00 6E 00 69 00|",distance 0; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ssn; classtype:trojan-activity; sid:26413; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"SERVER-ORACLE Oracle WebCenter FatWire Satellite Server header injection on blobheadername2 attempt"; flow:to_server,established; content:"blobheadername2=Location",fast_pattern,nocase; content:"blobheadervalue2=",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:cve,2013-1509; reference:url,www.oracle.com/technetwork/topics/security/cpuapr2013-1899555.html; classtype:web-application-attack; sid:26468; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"SERVER-ORACLE Oracle WebCenter FatWire Satellite Server header injection on blobheadername2 attempt"; flow:to_server,established; content:"blobheadername2=Refresh",fast_pattern,nocase; content:"blobheadervalue2=",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:cve,2013-1509; reference:url,www.oracle.com/technetwork/topics/security/cpuapr2013-1899555.html; classtype:web-application-attack; sid:26469; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC User-Agent known malicious user agent NOKIAN95/WEB"; flow:to_server,established; content:"User-Agent|3A| NOKIAN95|2F|WEB",fast_pattern,nocase; metadata:ruleset community; service:http; reference:url,blog.trendmicro.com/trendlabs-security-intelligence/targeted-attack-campaign-hides-behind-ssl-communication/; classtype:trojan-activity; sid:26522; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PUA-ADWARE Win.Adware.BProtector browser hijacker dll list download attempt"; flow:to_server,established; http_method; content:"GET"; http_uri; content:"/builds/",nocase; content:"fflists.txt",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:misc-activity; sid:26553; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Win.Backdoor.PCRat data upload"; flow:to_server,established; content:"PCRatd",depth 6; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:url,www.virustotal.com/en/file/669DF9DED24D56997D7B1EA6249BB704226DADA09230DC285AE66CA0C9B7247B/analysis/; classtype:misc-activity; sid:26655; rev:2; )
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:"MALWARE-OTHER self-signed SSL certificate with default MyCompany Ltd organization name"; flow:to_client,established; ssl_state:server_hello; content:"|55 04 0A|"; content:"|0E|MyCompany Ltd",within 14,distance 1; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:ssl; reference:url,attack.mitre.org/techniques/T1078; reference:url,en.wikipedia.org/wiki/Self-signed_certificate; reference:url,security.ncsa.illinois.edu/research/grid-howtos/usefulopenssl.html; classtype:policy-violation; sid:27538; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Backdoor.Aumlib variant outbound connection"; flow:to_server,established; content:"/bbs/search.asp"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 5.0|3B| Windows NT 5.0|29|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; classtype:trojan-activity; sid:27630; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Backdoor.Aumlib variant outbound connection"; flow:to_server,established; content:"/buy-sell/search.asp?newsid="; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 5.0|3B| Windows NT 5.0|29|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; classtype:trojan-activity; sid:27631; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.Bisonha variant outbound connection"; flow:to_server,established; content:"GET /3001",fast_pattern; isdataat:260,relative; content:"0000000000000000000000000"; pcre:"/\/3001[0-9A-F]{262,304}/"; metadata:impact_flag red,ruleset community; service:ssl; reference:url,bl0g.cedricpernet.net/post/2013/08/29/APT-More-on-G20Summit-Espionage-Operation; reference:url,www.virustotal.com/en/file/f0d8834fb0e2d3c6e7c1fde7c6bcf9171e5deca119338e4fac21568e0bb70ab7/analysis/; classtype:trojan-activity; sid:27805; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Gh0st variant outbound connection"; flow:to_server,established; content:"Gh0st",depth 5; content:"|00 00 00|",within 3,distance 1; content:"|00 00 78 9C|",within 4,distance 2; metadata:impact_flag red,ruleset community; reference:url,virustotal.com/en/file/a4fd37b8b9eabd0bfda7293acbb1b6c9f97f8cc3042f3f78ad2b11816e1f9a59/analysis/1425053730/; classtype:trojan-activity; sid:27964; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 1039 ( msg:"MALWARE-CNC Win.Trojan.Symmi variant SQL check-in"; flow:to_server,established; content:"s|00|e|00|l|00|e|00|c|00|t|00| |00|v|00|e|00|r|00|i|00|f|00|i|00|c|00|a|00|n|00|d|00|o|00| |00|f|00|r|00|o|00|m|00| |00|v|00|e|00|r|00|i|00|f|00|i|00|c|00|a|00|n|00|d|00|o|00| |00|w|00|h|00|e|00|r|00|e|00| |00|i|00|d|00|_|00|p|00|c|00|=|00|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/47c71ff0eb61b371e967b93b6909bb05f2aab973e3214ea2d5ed246884dd045e/analysis/; classtype:trojan-activity; sid:28446; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 ( msg:"MALWARE-CNC Win.Trojan.Conficker variant outbound connection"; flow:to_server,established; isdataat:145; isdataat:!146; http_raw_uri; bufferlen:1; pkt_data; content:"GET / HTTP/1.1|0D 0A|User-Agent: Mozilla/4.0 (compatible|3B| MSIE 7.0|3B| Windows NT 5.1|3B| Trident/4.0)|0D 0A|Host: checkip.dyndns.org|0D 0A|Cache-Control: no-cache|0D 0A 0D 0A|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; reference:url,www.sans.org/security-resources/malwarefaq/conficker-worm.php; classtype:trojan-activity; sid:28542; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 ( msg:"MALWARE-CNC Win.Trojan.Conficker variant outbound connection"; flow:to_server,established; isdataat:138; isdataat:!139; http_raw_uri; bufferlen:1; pkt_data; content:"GET / HTTP/1.1|0D 0A|User-Agent: Mozilla/4.0 (compatible|3B| MSIE 7.0|3B| Windows NT 5.1|3B| Trident/4.0)|0D 0A|Host: www.ask.com|0D 0A|Cache-Control: no-cache|0D 0A 0D 0A|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; reference:url,www.sans.org/security-resources/malwarefaq/conficker-worm.php; classtype:trojan-activity; sid:28543; rev:3; )
alert udp $EXTERNAL_NET 2425 -> $HOME_NET 2425 ( msg:"INDICATOR-SCAN inbound probing for IPTUX messenger port "; flow:to_server; content:"iptux",depth 5,offset 2; content:"lws|3A|lws",within 7,distance 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; reference:url,github.com/iptux-src/iptux; classtype:misc-activity; sid:28552; rev:3; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1434 ( msg:"MALWARE-OTHER SQL Slammer worm propagation attempt inbound"; flow:to_server; content:"|04|",depth 1; content:"Qh.dll",fast_pattern,nocase; content:"sock"; content:"send"; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; reference:bugtraq,5310; reference:bugtraq,5311; reference:cve,2002-0649; classtype:trojan-activity; sid:28555; rev:2; )
alert udp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS DNS query amplification attempt"; flow:to_server; content:"|00 01|",depth 2,offset 4; content:"|00 01|",within 2,distance 4; byte_test:1,!&,0xF8,2; content:"|00 00 FF 00 01 00 00 29|"; byte_test:2,>,0x7FFF,0,relative; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:dns; reference:url,www.us-cert.gov/ncas/alerts/TA13-088A; classtype:attempted-dos; sid:28556; rev:3; )
alert udp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS Malformed DNS query with HTTP content"; flow:to_server; content:"|54 20|",fast_pattern,nocase; content:"GET |2F| HTTP"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:dns; reference:url,www.ietf.org/rfc/rfc2616.txt; classtype:misc-activity; sid:28557; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 ( msg:"MALWARE-CNC Win.Trojan.Zeus outbound connection"; flow:to_server,established; http_raw_uri; bufferlen:1; pkt_data; content:"GET / HTTP/1.1|0D 0A|Accept: */*|0D 0A|Accept-Language:",depth 45; content:"|0D 0A|Connection: Close|0D 0A 0D 0A|",fast_pattern; http_header; content:"google.com|0D 0A|"; content:"|3B 20|MSIE|20|"; content:!"Accept-Encoding: "; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/en/file/d4b16269c9849c33a7bb2fdc782173a00e99db12a585689618dde3f4c6fcb101/analysis/; classtype:trojan-activity; sid:28800; rev:4; )
alert udp $HOME_NET any -> $EXTERNAL_NET 2090 ( msg:"MALWARE-CNC Win.Trojan.Palevo outbound connection"; flow:to_server; dsize:21; content:"|00 00|",depth 2,offset 19; metadata:impact_flag red,ruleset community; reference:url,palevotracker.abuse.ch/?ipaddress=209.222.14.3; reference:url,palevotracker.abuse.ch/?ipaddress=31.170.179.179; classtype:trojan-activity; sid:28805; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 58455 ( msg:"MALWARE-BACKDOOR Zollard variant outbound connection attempt"; flow:to_server,established; content:".zollard/",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:telnet; reference:url,www.deependresearch.org/2013/12/hey-zollard-leave-my-internet-of-things.html; classtype:trojan-activity; sid:28913; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 ( msg:"MALWARE-CNC Win.Trojan.Symmi variant network connectivity check"; flow:to_server,established; http_header; content:"Host: bit.ly|0D 0A|Accept: text/html, */*|0D 0A|Accept-Encoding: identity|0D 0A|User-Agent: Mozilla/3.0 (compatible|3B| Indy Library)",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/en/file/47c71ff0eb61b371e967b93b6909bb05f2aab973e3214ea2d5ed246884dd045e/analysis/; classtype:trojan-activity; sid:28918; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 ( msg:"MALWARE-CNC Win.Trojan.Symmi variant network connectivity check"; flow:to_server,established; http_header; content:"Host: bitly.com|0D 0A|Accept: text/html, */*|0D 0A|Accept-Encoding: identity|0D 0A|User-Agent: Mozilla/3.0 (compatible|3B| Indy Library)",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/en/file/084455c1de5d9440eb95edd2e6868aab1ce3dd674c2e3ba481254edc65b30b89/analysis/; classtype:trojan-activity; sid:28919; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Worm.Steckt IRCbot requesting URL through IRC"; flow:to_client,established; content:"JOIN |3A|#"; content:"!dl http://",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:irc; reference:url,www.virustotal.com/en/file/411e93206a7750c8df25730349bf9756ddba52c1bc780eaac4bba2b3872bc037/analysis/; classtype:trojan-activity; sid:28982; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Worm.Neeris IRCbot variant outbound connection"; flow:to_server,established; content:"JOIN #biz abc|0D 0A|",depth 15; metadata:impact_flag red,ruleset community; service:irc; reference:url,www.virustotal.com/en/file/0a8f320fc7535f164bbd9d0e462fd459c55ff448cf5e84dc2115f2f4aa800e6b/analysis/1387176826/; classtype:trojan-activity; sid:28986; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Worm.Steckt IRCbot variant outbound connection"; flow:to_server,established; content:"JOIN #n jobs|0D 0A|",depth 14; metadata:impact_flag red,ruleset community; service:irc; reference:url,www.virustotal.com/en/file/480eb4aa76a55ad7b0db128138113615ca834f9e6c62f798f54c8ac0759657fe/analysis/1387177714/; reference:url,www.virustotal.com/en/file/5b1d04b7504a3ac1befe4408fd4f9cd877b92661db47a75f197924cb660551d3/analysis/1387178129/; classtype:trojan-activity; sid:28987; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Worm.Steckt IRCbot variant outbound connection"; flow:to_server,established; content:"JOIN #test1|20 7C 0D 0A|JOIN #test2|20 7C 0D 0A|JOIN #test3 (null)|0D 0A|",depth 50; metadata:impact_flag red,ruleset community; service:irc; reference:url,www.virustotal.com/en/file/480eb4aa76a55ad7b0db128138113615ca834f9e6c62f798f54c8ac0759657fe/analysis/1387177714/; reference:url,www.virustotal.com/en/file/5b1d04b7504a3ac1befe4408fd4f9cd877b92661db47a75f197924cb660551d3/analysis/1387178129/; classtype:trojan-activity; sid:28988; rev:3; )
alert tcp $EXTERNAL_NET [777,778] -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Dropper inbound encrypted traffic"; flow:to_client,established; isdataat:9; isdataat:!20; content:"|05 29 00 00 00 05 29 00 00 00|",fast_pattern,nocase; metadata:ruleset community; reference:url,www.virustotal.com/en/file/20b49af8b750a1899117827476402ccaf7095fb5b7aad2e96c8109290da453cb/analysis/; reference:url,www.virustotal.com/en/file/559e8dbe388c8c103996b208eb5532e295da717f84b4a7ddf5c9885de8115606/analysis/; classtype:trojan-activity; sid:29378; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [777,778] ( msg:"MALWARE-CNC Win.Trojan.Dropper outbound encrypted traffic - potential exfiltration"; flow:to_server,established; isdataat:1440; content:"|03 2B 82 86 02 A0 05|",fast_pattern,nocase; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1020; reference:url,www.virustotal.com/en/file/20b49af8b750a1899117827476402ccaf7095fb5b7aad2e96c8109290da453cb/analysis/; reference:url,www.virustotal.com/en/file/559e8dbe388c8c103996b208eb5532e295da717f84b4a7ddf5c9885de8115606/analysis/; classtype:trojan-activity; sid:29379; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [777,778] ( msg:"MALWARE-CNC Win.Trojan.Dropper outbound encrypted traffic"; flow:to_server,established; isdataat:4; isdataat:!5; content:"|05 29 00 00 00|",fast_pattern,nocase; metadata:ruleset community; reference:url,www.virustotal.com/en/file/20b49af8b750a1899117827476402ccaf7095fb5b7aad2e96c8109290da453cb/analysis/; reference:url,www.virustotal.com/en/file/559e8dbe388c8c103996b208eb5532e295da717f84b4a7ddf5c9885de8115606/analysis/; classtype:trojan-activity; sid:29380; rev:2; )
alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:"FILE-IDENTIFY Adobe AIR file attachment detected"; flow:to_client,established; content:".air",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2eair/i"; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:imap,pop3; classtype:misc-activity; sid:29385; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 ( msg:"FILE-IDENTIFY Adobe AIR file attachment detected"; flow:to_server,established; content:".air",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2eair/i"; flowbits:set,file.zip; flowbits:noalert; metadata:policy balanced-ips alert,policy connectivity-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; classtype:misc-activity; sid:29386; rev:15; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 ( msg:"MALWARE-CNC Win.Trojan.Zeus variant outbound connection"; flow:to_server,established; http_raw_uri; bufferlen:6; pkt_data; content:"/webhp HTTP/1.1|0D 0A|Accept: */*|0D 0A|Connection: Close|0D 0A|User-Agent: Mozilla/4.0 (",fast_pattern,nocase; http_header; content:"|3B| MSIE "; content:"google."; content:!"Accept-"; http_cookie; content:"NID=",depth 4; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/en/file/ef4e0ccc49decb41f213a20f61d92374c3b97497105d7c20e7284f65055d2ccb/analysis/; classtype:trojan-activity; sid:29395; rev:1; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PROTOCOL-ICMP Unusual L3retriever Ping detected"; icode:0; itype:8; dsize:>32; content:"ABCDEFGHIJKLMNOPQRSTUVWABCDEFGHI",depth 32; metadata:policy max-detect-ips drop,ruleset community; reference:url,krebsonsecurity.com/2014/01/a-closer-look-at-the-target-malware-part-ii/; reference:url,krebsonsecurity.com/2014/01/a-first-look-at-the-target-intrusion-malware/; classtype:successful-recon-limited; sid:29454; rev:2; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PROTOCOL-ICMP Unusual Microsoft Windows Ping detected"; icode:0; itype:8; dsize:>32; content:"0123456789abcdefghijklmnopqrstuv",depth 32; metadata:policy max-detect-ips drop,ruleset community; reference:url,krebsonsecurity.com/2014/01/a-closer-look-at-the-target-malware-part-ii/; reference:url,krebsonsecurity.com/2014/01/a-first-look-at-the-target-intrusion-malware/; classtype:successful-recon-limited; sid:29455; rev:2; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PROTOCOL-ICMP Unusual PING detected"; icode:0; itype:8; fragbits:!M; content:!"ABCDEFGHIJKLMNOPQRSTUVWABCDEFGHI",depth 32; content:!"0123456789abcdefghijklmnopqrstuv",depth 32; content:!"EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE",depth 36; content:!"WANG2"; content:!"cacti-monitoring-system",depth 65; content:!"SolarWinds",depth 72; metadata:policy max-detect-ips drop,ruleset community; reference:url,krebsonsecurity.com/2014/01/a-closer-look-at-the-target-malware-part-ii/; reference:url,krebsonsecurity.com/2014/01/a-first-look-at-the-target-intrusion-malware/; classtype:successful-recon-limited; sid:29456; rev:3; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:"PROTOCOL-ICMP Unusual Microsoft Windows 7 Ping detected"; icode:0; itype:8; dsize:>32; content:"abcdefghijklmnopqrstuvwabcdefghi",depth 32; metadata:policy max-detect-ips drop,ruleset community; reference:url,krebsonsecurity.com/2014/01/a-closer-look-at-the-target-malware-part-ii/; reference:url,krebsonsecurity.com/2014/01/a-first-look-at-the-target-intrusion-malware/; classtype:successful-recon-limited; sid:29457; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.Fexel variant outbound connection"; flow:to_server,established; content:"|0A|Agtid|3A 20|"; content:"08x|0D 0A|",within 5,distance 8; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/en/file/b33ffbec01b43301edd9db42a59dcd33dd45f638733e2f92f0cb5bfe86714734/analysis/; classtype:trojan-activity; sid:29459; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.Kuluoz outbound connection"; flow:to_server,established; content:" HTTP/1.1|0D 0A|Accept: */*|0D 0A|Content-Type: application/x-www-form-urlencoded|0D 0A|User-Agent: Mozilla/5.0 (Windows NT 6.1|3B| WOW64|3B| rv:25.0) Gecko/20100101 Firefox/25.0|0D 0A|Host: ",fast_pattern,nocase; content:"POST /",depth 6; content:" HTTP/1.1",within 9,distance 42; pcre:"/^POST\x20\x2f[A-F\d]{42}\x20HTTP/"; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/en/file/8b53c46a7dfbe738c558e653f33fccf2004fc294848eee20903daa556bb3af09/analysis/; classtype:trojan-activity; sid:29865; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC User-Agent known malicious user-agent string Updates downloader - Win.Trojan.Upatre"; flow:to_server,established; http_header; content:"User-Agent|3A| Updates downloader|0D 0A|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/en/file/F167C95A467F584890F39BA2162F1B96E7626F5C575EB151C8E4E00E68F97478/analysis/; classtype:trojan-activity; sid:29887; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 1024: ( msg:"MALWARE-CNC Win.Trojan.Glupteba.M initial outbound connection"; flow:to_server,established; content:"/stat?"; content:"uptime="; content:"&downlink=",distance 0; content:"&uplink=",distance 0; content:"&id=",distance 0; content:"&statpass=bpass",distance 0,fast_pattern; content:"&version=",distance 0; content:"&features=",distance 0; content:"&guid=",distance 0; content:"&comment=",distance 0; content:"&p=",distance 0; content:"&s=",distance 0; metadata:ruleset community; service:http; reference:url,www.welivesecurity.com/wp-content/uploads/2014/03/operation_windigo.pdf; classtype:trojan-activity; sid:30288; rev:3; )
alert tcp $EXTERNAL_NET 1600:1604 -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Zbot/Bublik inbound connection"; flow:to_client,established; content:"E|00|N|00|D|00|S|00|E|00|R|00|V|00|E|00|R|00|B|00|U|00|F|00|F|00|E|00|R|00|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; reference:url,isc.sans.edu/forums/diary/Malicious+PDF+sent+in+massive+scam+to+Colombian+users+claiming+to+be+from+Credit+score+agency/17875; reference:url,www.virustotal.com/en/file/bbc1a8b0892785c75f0f44d9414e424ed03cefbf951ed20eaae50031670c8a96/analysis/; classtype:trojan-activity; sid:30482; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 1600:1604 ( msg:"MALWARE-CNC Win.Trojan.Zbot/Bublik outbound connection"; flow:to_server,established; content:"GET /123456789.functionss",fast_pattern,nocase; metadata:impact_flag red,ruleset community; reference:url,isc.sans.edu/forums/diary/Malicious+PDF+sent+in+massive+scam+to+Colombian+users+claiming+to+be+from+Credit+score+agency/17875; reference:url,www.virustotal.com/en/file/bbc1a8b0892785c75f0f44d9414e424ed03cefbf951ed20eaae50031670c8a96/analysis/; classtype:trojan-activity; sid:30483; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 1600:1604 ( msg:"MALWARE-CNC Win.Trojan.Zbot/Bublik outbound connection"; flow:to_server,established; isdataat:!19; content:"myversion|7C|",fast_pattern,nocase; pcre:"/myversion\x7c(\d\x2e){3}\d\x0d\x0a/"; metadata:impact_flag red,ruleset community; reference:url,isc.sans.edu/forums/diary/Malicious+PDF+sent+in+massive+scam+to+Colombian+users+claiming+to+be+from+Credit+score+agency/17875; reference:url,www.virustotal.com/en/file/bbc1a8b0892785c75f0f44d9414e424ed03cefbf951ed20eaae50031670c8a96/analysis/; classtype:trojan-activity; sid:30484; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL SSLv3 heartbeat read overrun attempt"; flow:to_server,established,only_stream; content:"|18 03 00|",depth 3; detection_filter:track by_src,count 3,seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30510; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1 heartbeat read overrun attempt"; flow:to_server,established,only_stream; content:"|18 03 01|",depth 3; detection_filter:track by_src,count 3,seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30511; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt"; flow:to_server,established,only_stream; content:"|18 03 02|",depth 3; detection_filter:track by_src,count 3,seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30512; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt"; flow:to_server,established,only_stream; content:"|18 03 03|",depth 3; detection_filter:track by_src,count 3,seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30513; rev:8; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established,only_stream; content:"|18 03 00|",depth 3; byte_test:2,>,128,0,relative; content:"|02|",within 1,distance 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30514; rev:11; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established,only_stream; content:"|18 03 01|",depth 3; byte_test:2,>,128,0,relative; content:"|02|",within 1,distance 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30515; rev:11; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established,only_stream; content:"|18 03 02|",depth 3; byte_test:2,>,128,0,relative; content:"|02|",within 1,distance 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30516; rev:11; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established,only_stream; content:"|18 03 03|",depth 3; byte_test:2,>,128,0,relative; content:"|02|",within 1,distance 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30517; rev:11; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL SSLv3 heartbeat read overrun attempt - vulnerable client response"; flow:to_server,established,only_stream; content:"|18 03 00|",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst,count 2,seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30520; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1 heartbeat read overrun attempt - vulnerable client response"; flow:to_server,established,only_stream; content:"|18 03 01|",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst,count 2,seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30521; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt - vulnerable client response"; flow:to_server,established,only_stream; content:"|18 03 02|",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst,count 2,seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30522; rev:9; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt - vulnerable client response"; flow:to_server,established,only_stream; content:"|18 03 03|",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst,count 2,seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30523; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt"; flow:to_server,established; content:"|18 03 02 00 03 01 40 00|",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30524; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:"SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt"; flow:to_server,established; isdataat:68; isdataat:!69; content:"|18 03 03 00 40|",depth 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30525; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 443 ( msg:"SERVER-OTHER OpenSSL Heartbleed masscan access exploitation attempt"; flow:to_server,established; content:"[masscan/1.0]"; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30549; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 10991 ( msg:"MALWARE-CNC Linux.Trojan.Elknot outbound connection"; flow:to_server,established; isdataat:400; isdataat:!401; content:"Linux|20|",depth 6,offset 17; pcre:"/Linux\x20\d\.[0-9]{1,2}\.[0-9]{1,2}/"; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/13f13f4e214c2755235ba36643e4ab08d4ea679da008397b7a540e0d45e70ab2/analysis/; classtype:trojan-activity; sid:30566; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 ( msg:"MALWARE-CNC Win.Trojan.Zeus variant outbound connection"; flow:to_server,established; http_raw_uri; bufferlen:6; pkt_data; content:"/webhp HTTP/1.1|0D 0A|Accept: */*|0D 0A|Connection: Close|0D 0A|User-Agent: Mozilla/4.0 (",fast_pattern,nocase; http_header; content:"|3B| MSIE "; content:"google."; content:!"Accept-"; http_cookie; content:"PREF=",depth 5; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/en/file/2f2e20d92f7551fccae73bba64d25dd1f18a4018fffd30bdb1f9fb6280182bd0/analysis/1396537812/; reference:url,www.virustotal.com/en/file/b268cba8515040055d866fb9e29d7fe2bc087f205711cdbad3e4b1bde7be2d75/analysis/; reference:url,www.virustotal.com/en/file/ef4e0ccc49decb41f213a20f61d92374c3b97497105d7c20e7284f65055d2ccb/analysis/; classtype:trojan-activity; sid:30570; rev:4; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|16 03 00|"; byte_jump:2,0,relative; content:"|18 03 00|",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30777; rev:4; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|17 03 00|"; byte_jump:2,0,relative; content:"|18 03 00|",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30778; rev:4; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|16 03 01|"; byte_jump:2,0,relative; content:"|18 03 01|",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30779; rev:4; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|17 03 01|"; byte_jump:2,0,relative; content:"|18 03 01|",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30780; rev:4; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|16 03 02|"; byte_jump:2,0,relative; content:"|18 03 02|",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30781; rev:5; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|17 03 02|"; byte_jump:2,0,relative; content:"|18 03 02|",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30782; rev:4; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|16 03 03|"; byte_jump:2,0,relative; content:"|18 03 03|",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30783; rev:4; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|17 03 03|"; byte_jump:2,0,relative; content:"|18 03 03|",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30784; rev:4; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|18 03 00|"; byte_jump:2,0,relative; content:"|18 03 00|",within 3; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30785; rev:4; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|18 03 01|"; byte_jump:2,0,relative; content:"|18 03 01|",within 3; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30786; rev:4; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|18 03 02|"; byte_jump:2,0,relative; content:"|18 03 02|",within 3; byte_test:2,>,128,0,relative; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30787; rev:5; )
alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt"; flow:to_client,established; content:"|18 03 03|"; byte_jump:2,0,relative; content:"|18 03 03|",within 3; byte_test:2,>,128,0,relative; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:cve,2014-0160; classtype:attempted-recon; sid:30788; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Win.Backdoor.Hikit outbound banner response"; flow:to_client,established; content:"|5D 00 20 00|h|00|i|00|k|00|i|00|t|00|>|00|",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http,ssl; reference:url,www.virustotal.com/en/file/aa4b2b448a5e246888304be51ef9a65a11a53bab7899bc1b56e4fc20e1b1fd9f/analysis/; classtype:trojan-activity; sid:30948; rev:3; )
alert udp $EXTERNAL_NET any -> $HOME_NET [16464,16465,16470,16471] ( msg:"MALWARE-CNC Win.Trojan.ZeroAccess inbound connection"; flow:to_server; dsize:16; content:"|28 94 8D AB|",depth 4,offset 4; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/file/50cdd9f6c5629630c8d8a3a4fe7d929d3c6463b2f9407d9a90703047e7db7ff9/analysis/; classtype:trojan-activity; sid:31136; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:"MALWARE-CNC Win.Trojan.HW32 variant spam attempt"; flow:to_server,established; content:"MAIL FROM: <Reademal.com>|0D 0A|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:smtp; reference:url,www.virustotal.com/en/file/e69b310dff09830641d4b9682375ce3df503674d23c429bd7847979ea9250b2b/analysis/; classtype:trojan-activity; sid:31507; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Glupteba C&C server HELLO request to client"; flow:to_client,established; isdataat:5; isdataat:!6; content:"HELLO|0A|"; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/0bcc2bf3cf06952e18c3e1d9860698dbb3ff1644a0389a9756c1b82b66fb2b83/analysis/; classtype:trojan-activity; sid:31603; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Glupteba C&C server READD command to client"; flow:to_client,established; isdataat:5; isdataat:!6; content:"READD|0A|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/0bcc2bf3cf06952e18c3e1d9860698dbb3ff1644a0389a9756c1b82b66fb2b83/analysis/; classtype:trojan-activity; sid:31604; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Glupteba C&C server READY command to client"; flow:to_client,established; isdataat:5; isdataat:!6; content:"READY|0A|"; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/0bcc2bf3cf06952e18c3e1d9860698dbb3ff1644a0389a9756c1b82b66fb2b83/analysis/; classtype:trojan-activity; sid:31605; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Glupteba client response/authenticate to C&C server"; flow:to_server,established; isdataat:14; isdataat:!18; content:"|3A|bpass|0A|",fast_pattern,nocase; pcre:"/[0-9A-Z]{8}\x3abpass\x0a/"; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/0bcc2bf3cf06952e18c3e1d9860698dbb3ff1644a0389a9756c1b82b66fb2b83/analysis/; classtype:trojan-activity; sid:31607; rev:3; )
alert udp $HOME_NET 67 -> $HOME_NET 68 ( msg:"OS-OTHER Malicious DHCP server bash environment variable injection attempt"; flow:stateless; content:"() {",fast_pattern,nocase; content:"|02 01 06 00|",depth 4; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:cve,2014-6271; reference:cve,2014-6277; reference:cve,2014-6278; reference:cve,2014-7169; classtype:attempted-admin; sid:31985; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC User-Agent known malicious user-agent string - Install - Win.Backdoor.Upatre"; flow:to_server,established; content:"/0/ HTTP/1."; content:"User-Agent: Install|0D 0A|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/en/file/ae7f419e0093fd2d4892ea6920aaa2c12c95cede9c97cb0a1f096496d4ff93ea/analysis/; classtype:trojan-activity; sid:31990; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC User-Agent known malicious user-agent string - Treck - Win.Backdoor.Upatre"; flow:to_server,established; content:"/0/ HTTP/1."; content:"User-Agent: Treck|0D 0A|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/en/file/e295922322324e048657a5b4c0c4c9717a1a127e39ba45a03dc5d4d4bb2e523f/analysis/; classtype:trojan-activity; sid:31991; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Linux.Backdoor.Flooder inbound connection attempt - command"; flow:to_client,established; isdataat:!14; content:"|21 2A 20|SCANNER ON",fast_pattern,nocase; metadata:ruleset community; reference:url,www.virustotal.com/en/file/73b0d95541c84965fa42c3e257bb349957b3be626dec9d55efcc6ebcba6fa489/analysis/; classtype:trojan-activity; sid:32009; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 23 ( msg:"MALWARE-CNC Linux.Backdoor.Flooder outbound telnet connection attempt"; flow:to_server,established; content:"/bin/busybox|3B|echo -e |27 5C|147|5C|141|5C|171|5C|146|5C|147|5C|164|27 0D 0A|",fast_pattern,nocase; metadata:ruleset community; service:telnet; reference:url,www.virustotal.com/en/file/73b0d95541c84965fa42c3e257bb349957b3be626dec9d55efcc6ebcba6fa489/analysis/; classtype:trojan-activity; sid:32010; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Linux.Backdoor.Flooder outbound connection"; flow:to_server,established; isdataat:9; isdataat:!10; content:"BUILD X86|0A|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/73b0d95541c84965fa42c3e257bb349957b3be626dec9d55efcc6ebcba6fa489/analysis/; classtype:trojan-activity; sid:32011; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"OS-OTHER Bash environment variable injection attempt"; flow:to_server,established; content:"USER ",depth 5; content:"() {",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ftp; reference:cve,2014-6271; reference:cve,2014-6277; reference:cve,2014-6278; reference:cve,2014-7169; classtype:attempted-admin; sid:32043; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"OS-OTHER Bash environment variable injection attempt"; flow:to_server,established; content:"PASS ",depth 5; content:"() {",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ftp; reference:cve,2014-6271; reference:cve,2014-6277; reference:cve,2014-6278; reference:cve,2014-7169; classtype:attempted-admin; sid:32069; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [53,80,443,5432] ( msg:"MALWARE-CNC WIN.Trojan.Plugx variant outbound connection"; flow:to_server,established; content:"HHV1:"; content:"HHV2:",within 20; content:"HHV3: 61456",within 20,fast_pattern; content:"HHV4:",within 20; metadata:impact_flag red,ruleset community; service:dns,http,ssl; reference:url,virustotal.com/en/file/4d464f9def2276dac15d19ccf049b7c68642290bc0e345e06d4b6e9103fde9e6/analysis/; classtype:trojan-activity; sid:32179; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.ZxShell connection incoming attempt"; flow:to_client,established; isdataat:15; isdataat:!16; content:"|85 19 00 00 25 04 00 00|",depth 8; metadata:impact_flag red,ruleset community; reference:url,virustotal.com/en/file/438ed90e1f69b5dcae2d30d241159aaed74f9d3125c60f1003915b2237978f7d/analysis/; classtype:trojan-activity; sid:32180; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Backdoor.ZxShell connection outgoing attempt"; flow:to_server,established; isdataat:15; isdataat:!16; content:"|86 19 00 00 04 01 00 00|",depth 8; metadata:impact_flag red,ruleset community; reference:url,virustotal.com/en/file/438ed90e1f69b5dcae2d30d241159aaed74f9d3125c60f1003915b2237978f7d/analysis/; classtype:trojan-activity; sid:32181; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Zxshell variant outbound connection"; flow:to_server,established; content:"|20|OS|3A 20|"; content:"|20|CPU|3A|",distance 0; content:"Hz,RAM|3A|",distance 0; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/547044cb73f1c18ccd92cd28afded37756f749a9338ed7c04306c1de46889d6b/analysis/; classtype:trojan-activity; sid:32192; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-OTHER Sinkhole reply - irc-sinkhole.cert.pl"; flow:to_client,established; content:"|3A|irc|2D|sinkhole|2E|cert|2E|pl",fast_pattern,nocase; content:"|3A|End of MOTD command|2E|"; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; classtype:trojan-activity; sid:32260; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 ( msg:"FILE-IDENTIFY bmp file attachment detected"; flow:to_server,established; content:".bmp",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2ebmp/i"; flowbits:set,file.bmp; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; reference:url,en.wikipedia.org/wiki/BMP_file_format; classtype:misc-activity; sid:32378; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 ( msg:"FILE-IDENTIFY dib file attachment detected"; flow:to_server,established; content:".dib",fast_pattern,nocase; content:"Content-Disposition: attachment|3B|"; content:"filename=",nocase; pcre:"/filename=[^\n]*\x2edib/i"; flowbits:set,file.bmp; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; reference:url,en.wikipedia.org/wiki/BMP_file_format; classtype:misc-activity; sid:32380; rev:12; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC User-Agent known malicious user-agent string RUpdate"; flow:to_server,established; content:"User-Agent: RUpdate|0D 0A|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/en/file/0d68f1d3855543a4732e551e9e4375a2cd85d9ab11a86334f67ad99c5f6990a0/analysis/; classtype:trojan-activity; sid:32645; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [8000,8080] ( msg:"MALWARE-CNC Win.Trojan.Wiper variant outbound connection"; flow:to_server,established; isdataat:41; isdataat:!42; content:"(|00|",depth 2; content:"|04 00 00 00|",within 4,distance 36; metadata:impact_flag red,ruleset community; reference:url,virustotal.com/en/file/e2ecec43da974db02f624ecadc94baf1d21fd1a5c4990c15863bb9929f781a0a/analysis/; classtype:trojan-activity; sid:32674; rev:5; )
alert tcp $EXTERNAL_NET 488 -> $HOME_NET any ( msg:"MALWARE-BACKDOOR Win.Trojan.Wiper inbound communication attempt"; flow:to_client,established; content:"|60 DB 37 37 37 37 37 37|",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; reference:url,us-cert.gov/ncas/alerts/TA14-353A; classtype:trojan-activity; sid:32911; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 488 ( msg:"MALWARE-BACKDOOR Win.Trojan.Wiper outbound communication attempt"; flow:to_server,established; content:"|60 DB 37 37 37 37 37 37|",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; reference:url,us-cert.gov/ncas/alerts/TA14-353A; classtype:trojan-activity; sid:32912; rev:2; )
alert tcp $EXTERNAL_NET 488 -> $HOME_NET any ( msg:"MALWARE-BACKDOOR Win.Trojan.Wiper inbound communication attempt"; flow:to_client,established; content:"|65 DB 37 37 37 37 37 37|",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; reference:url,us-cert.gov/ncas/alerts/TA14-353A; classtype:trojan-activity; sid:32915; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 488 ( msg:"MALWARE-BACKDOOR Win.Trojan.Wiper outbound communication attempt"; flow:to_server,established; content:"|65 DB 37 37 37 37 37 37|",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; reference:url,us-cert.gov/ncas/alerts/TA14-353A; classtype:trojan-activity; sid:32916; rev:2; )
alert tcp $EXTERNAL_NET [547,8080,133,117,189,159] -> $HOME_NET any ( msg:"MALWARE-BACKDOOR Win.Trojan.Wiper inbound communication attempt"; flow:to_client,established; content:"|7B 08 2A 2A|",offset 17; content:"|08 2A 2A 01 00|",distance 0; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; reference:url,us-cert.gov/ncas/alerts/TA14-353A; classtype:trojan-activity; sid:32917; rev:2; )
alert tcp any any -> any any ( msg:"MALWARE-TOOLS Win.Trojan.Wiper proxy communication attempt"; flow:established; content:!"HTTP/1"; content:"|E2 1D 49 49|",depth 4,fast_pattern; content:"|49 49 49 49|",within 4,distance 4; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; reference:url,us-cert.gov/ncas/alerts/TA14-353A; classtype:trojan-activity; sid:32937; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC User-Agent known malicious user-agent string - realupdate - Win.Backdoor.Upatre"; flow:to_server,established; content:"/0/ HTTP/1."; content:"User-Agent: realupdate|0D 0A|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; classtype:trojan-activity; sid:33047; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.Medusa variant inbound connection"; flow:to_client,established; isdataat:!509; content:"|00|U|00|n|00|d|00|e|00|r|00 20 00|C|00|o|00|n|00|s|00|t|00|r|00|u|00|c|00|t|00|i|00|o|00|n|00|<|00|/"; content:"|00 22 00 3E 00|w|00|w|00|w|00|.|00|m|00|i|00|c|00|r|00|o|00|s|00|o|00|f|00|t|00 2E 00|c|00|o|00|m|00 3C|",distance 0; metadata:impact_flag red,ruleset community; service:http; classtype:trojan-activity; sid:33058; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC User-Agent known malicious user-agent string - Mazilla/5.0 - Win.Backdoor.Upatre"; flow:to_server,established; content:"User-Agent: Mazilla/5.0|0D 0A|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; classtype:trojan-activity; sid:33207; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,587] ( msg:"MALWARE-CNC Win.Trojan.HawkEye keylogger exfiltration attempt"; flow:to_server,established; content:"HawkEye Keylogger",fast_pattern,nocase; content:"Subject: =?utf-8?B"; metadata:impact_flag red,ruleset community; service:smtp; reference:url,attack.mitre.org/techniques/T1020; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.virustotal.com/en/file/f4499928a6fee5d37fb711ed6d68708bf116cfc7f284d3295dd30ded7ecf64b2/analysis/; classtype:trojan-activity; sid:33220; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,587] ( msg:"MALWARE-CNC Win.Trojan.HawkEye Keylogger exfiltration attempt - clipboard and screenshot"; flow:to_server,established; content:"Subject|3A 20|=?utf-8?B?",fast_pattern; content:"=?=|0D 0A|",within 150; flowbits:set,hawk.lgr; flowbits:noalert; metadata:ruleset community; service:smtp; reference:url,attack.mitre.org/techniques/T1020; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.virustotal.com/en/file/f4499928a6fee5d37fb711ed6d68708bf116cfc7f284d3295dd30ded7ecf64b2/analysis/; classtype:trojan-activity; sid:33221; rev:8; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,587] ( msg:"MALWARE-CNC Win.Trojan.HawkEye Keylogger exfiltration attempt - clipboard and screenshot"; flow:to_server,established; flowbits:isset,hawk.lgr; content:"=0D=0AClipboard",fast_pattern,nocase; content:"=0D=0AKeyboard",nocase; metadata:impact_flag red,ruleset community; service:smtp; reference:url,attack.mitre.org/techniques/T1020; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.virustotal.com/en/file/f4499928a6fee5d37fb711ed6d68708bf116cfc7f284d3295dd30ded7ecf64b2/analysis/; classtype:trojan-activity; sid:33222; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,587] ( msg:"MALWARE-CNC Win.Trojan.HawkEye Keylogger exfiltration attempt - clipboard and screenshot"; flow:to_server,established; flowbits:isset,hawk.lgr; content:"name=screenshot",fast_pattern,nocase; pcre:"/name\x3dscreenshot\d+\x2e/i"; metadata:impact_flag red,ruleset community; service:smtp; reference:url,attack.mitre.org/techniques/T1020; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.virustotal.com/en/file/f4499928a6fee5d37fb711ed6d68708bf116cfc7f284d3295dd30ded7ecf64b2/analysis/; classtype:trojan-activity; sid:33223; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS Microsoft Windows SMB NTLM NULL session attempt"; flow:to_server,established; content:"|FF|SMB|73 00 00 00 00|",depth 9,offset 4; content:"|00 00|",within 2,distance 13; content:"|FF|",within 1,distance 9; content:"NTLMSSP|00 03 00 00 00|",within 100; content:"|00 00 00 00 40 00 00 00|",within 8,distance 24; flowbits:set,smb.null_session; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert,ruleset community; service:netbios-ssn; reference:bugtraq,1163; reference:cve,2000-0347; classtype:attempted-recon; sid:33825; rev:7; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Gh0st variant outbound connection"; flow:to_server,established; content:"KrisR",depth 5; content:"|00 00 00|",within 3,distance 1; content:"|00 00 78 9C|",within 4,distance 2; metadata:impact_flag red,ruleset community; reference:url,virustotal.com/en/file/a4fd37b8b9eabd0bfda7293acbb1b6c9f97f8cc3042f3f78ad2b11816e1f9a59/analysis/1425053730/; classtype:trojan-activity; sid:33885; rev:2; )
alert tcp $EXTERNAL_NET 1433 -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Banload variant MSSQL response"; flow:to_client,established; content:"|0B|m|00|a|00|c|00|a|00|v|00|e|00|r|00|d|00|e|00|m|00|2|00 06|m|00|a|00|s|00|t|00|e|00|r|00|",fast_pattern,nocase; content:"|08|D|00|B|00|S|00|Q|00|0|00|0|00|1|00|7|00|"; metadata:ruleset community; reference:url,www.virustotal.com/en/file/22ccd94c7e99a17753218708cea1abe162d289b7a0105c3be9620bf224f36f3f/analysis/; classtype:trojan-activity; sid:34136; rev:2; )
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Dyre publickey outbound connection"; flow:to_client,established; content:"|00 DE C5 45 99 14 1E F5 7E 56 78 DF 23 CE 8A 12|",fast_pattern,nocase; content:"LvtfOWStYYHNbdiE15aNsOyg"; metadata:impact_flag red,ruleset community; service:http; reference:url,phishme.com/project-dyre-new-rat-slurps-bank-credentials-bypasses-ssl; reference:url,www.virustotal.com/en/file/417c9cd7c8abbd7bbddfc313c9f153758fd11bda47f754b9c59bc308d808c486/analysis/; classtype:trojan-activity; sid:34140; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.Beebone outbound connection"; flow:to_server,established; content:"User-Agent|3A 20|Mozilla/4.0 (compatible|3B| MSIE 7.0|3B| Windows NT 5.1|3B| SV1)|0D 0A|",fast_pattern,nocase; content:"GET"; pcre:"/GET \/[a-z]{8,12}\?[a-z] HTTP\/1.1/i"; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/b06c6ac1174a6992f423d935ccba6f34f107b6591768a743d44d66423312d33a/analysis/; classtype:trojan-activity; sid:34366; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25] ( msg:"MALWARE-CNC Linux.Trojan.Mumblehard variant outbound connection"; flow:to_server,established; content:"POST / HTTP/1.0|0D 0A|Host: ",depth 28; content:"Content-type: application/x-www-form-urlencoded|0D 0A|Content-Length: ",within 100; content:"|0D 0A 0D 0A 0F 0F 09|",within 25,fast_pattern; content:!"User-Agent: ",nocase; metadata:impact_flag red,ruleset community; service:http; reference:url,virustotal.com/file/9512cd72e901d7df95ddbcdfc42cdb16141ff155e0cb0f8321069212e0cd67a8/analysis/1430996623; classtype:trojan-activity; sid:34461; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-BACKDOOR Win.Backdoor.Wekby Torn variant outbound connection"; flow:to_server,established; isdataat:15; isdataat:!16; content:"|00 00 00 11 C8 00 00 00 00 00 00 00 00 00 00 00|",depth 16,fast_pattern,fast_pattern_offset 0,fast_pattern_length 12; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/en/file/1D6BCF409C85887861D587C8AABFC8C8393EA692FE93C0A6836BE507A7F75985/analysis/; classtype:trojan-activity; sid:34500; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Backdoor.Wekby Torn variant outbound connection"; flow:to_server,established; isdataat:15; isdataat:!16; content:"|00 00 00 11 D0 00 00 00|",depth 8; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/1D6BCF409C85887861D587C8AABFC8C8393EA692FE93C0A6836BE507A7F75985/analysis/; classtype:trojan-activity; sid:34501; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-COMPROMISE Metasploit Meterpreter reverse HTTPS certificate"; flow:to_client,established; content:"|16 03 03|"; content:"|0B|",within 1,distance 2; content:"|30 82|",within 2,distance 9; content:"|30 82|",within 2,distance 2; content:"|A0 03 02 01 02 02|",within 6,distance 2; content:"|30 0D 06 09 2A 86 48 86 F7 0D 01 01|",within 22; content:"|31|",within 1,distance 5; content:"|30|",within 1,distance 1; content:"|06 03 55 04 03 0C|",within 6,distance 1; content:"|30|",within 10,distance 3; content:"|17 0D|",within 2,distance 1; content:"Z|17 0D|",within 3,distance 12; content:"Z|30|",within 2,distance 12; content:"|31|",within 1,distance 1; content:"|30|",within 1,distance 1; content:"|06 03 55 04 03 0C|",within 6,distance 1; content:"|30 82|",within 9,distance 2; content:"|30 0D 06 09 2A 86 48 86 F7 0D 01 01 01 05 00 03 82|",within 17,distance 2; content:"|30 82|",within 2,distance 3; content:"|02 82|",within 2,distance 2; content:"|02 03 01 00 01 A3 0D 30 0B 30 09 06 03 55 1D 13 04 02 30 00 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:ssl; reference:url,blog.didierstevens.com; classtype:misc-activity; sid:34864; rev:3; )
alert tcp $EXTERNAL_NET 21 -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Critroni certificate exchange"; flow:to_client,established; content:"|00 D3 62 47 DA 62 4A A1 34|"; content:"|3B 02 49 86 4B DF D7 D7 6C E2 2F 36 81 01 24 3F|",within 400; metadata:impact_flag red,ruleset community; service:ssl; reference:url,www.virustotal.com/en/file/af7a9f581653394955bec5cf10a7dbafbf64f42d09918807274b5d25849a1251/analysis/; classtype:trojan-activity; sid:34917; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Graftor variant HTTP Response"; flow:to_client,established; isdataat:!53; content:"HTTP/1.1 200 OK|0D 0A|Content-Length: "; content:"|0D 0A 0D 0A|session:",within 15,fast_pattern; pcre:"/\r\n\r\nsession\x3a\d{1,7}$/"; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/en/file/1ed49a78ee46c4a0d2eeb3b9ab707b40d3c87448c6f399d7fceefc0c16c66d38/analysis/; classtype:trojan-activity; sid:34997; rev:3; )
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.TorrentLocker/Teerac self-signed certificate"; flow:to_client,established; ssl_state:server_hello; content:"|16 03 01 00 51 02|"; content:"|55 04 06 13 02|XX",fast_pattern,nocase; content:"|55 04 07 0C 0C|Default City"; content:"|55 04 0A 0C 13|Default Company Ltd",distance 6; metadata:impact_flag red,ruleset community; service:ssl; reference:url,www.virustotal.com/en/file/4072beeaf09fe6fef48365f1c14fd800e21b32cfa2af561f515bc45372dd590d/analysis/; classtype:trojan-activity; sid:35393; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-COMPROMISE Metasploit Meterpreter reverse HTTPS certificate"; flow:to_client,established; content:"|16 03 01|"; content:"|0B|",within 1,distance 2; content:"|30 82|",within 2,distance 9; content:"|30 82|",within 2,distance 2; content:"|A0 03 02 01 02 02|",within 6,distance 2; content:"|30 0D 06 09 2A 86 48 86 F7 0D 01 01|",within 22; content:"|31|",within 1,distance 5; content:"|30|",within 1,distance 1; content:"|06 03 55 04 03 0C|",within 6,distance 1; byte_extract:1,0,string_size,relative; content:"|30|",within 1,distance string_size; content:"|17 0D|",within 2,distance 1; content:"Z|17 0D|",within 3,distance 12; content:"Z|30|",within 2,distance 12; content:"|31|",within 1,distance 1; content:"|30|",within 1,distance 1; content:"|06 03 55 04 03 0C|",within 6,distance 1; byte_extract:1,0,string_size,relative; content:"|30 82|",within 2,distance string_size; content:"|30 0D 06 09 2A 86 48 86 F7 0D 01 01 01 05 00 03 82|",within 17,distance 2; content:"|30 82|",within 2,distance 3; content:"|02 82|",within 2,distance 2; content:"|02 03 01 00 01 A3 0D 30 0B 30 09 06 03 55 1D 13 04 02 30 00 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:ssl; reference:url,blog.didierstevens.com; classtype:misc-activity; sid:36611; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-COMPROMISE Metasploit Meterpreter reverse HTTPS certificate"; flow:to_client,established; content:"|16 03 02|"; content:"|0B|",within 1,distance 2; content:"|30 82|",within 2,distance 9; content:"|30 82|",within 2,distance 2; content:"|A0 03 02 01 02 02|",within 6,distance 2; content:"|30 0D 06 09 2A 86 48 86 F7 0D 01 01|",within 22; content:"|31|",within 1,distance 5; content:"|30|",within 1,distance 1; content:"|06 03 55 04 03 0C|",within 6,distance 1; content:"|30|",within 10,distance 3; content:"|17 0D|",within 2,distance 1; content:"Z|17 0D|",within 3,distance 12; content:"Z|30|",within 2,distance 12; content:"|31|",within 1,distance 1; content:"|30|",within 1,distance 1; content:"|06 03 55 04 03 0C|",within 6,distance 1; content:"|30 82|",within 9,distance 2; content:"|30 0D 06 09 2A 86 48 86 F7 0D 01 01 01 05 00 03 82|",within 17,distance 2; content:"|30 82|",within 2,distance 3; content:"|02 82|",within 2,distance 2; content:"|02 03 01 00 01 A3 0D 30 0B 30 09 06 03 55 1D 13 04 02 30 00 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:ssl; reference:url,blog.didierstevens.com; classtype:misc-activity; sid:36612; rev:3; )
alert udp any 53 -> $HOME_NET any ( msg:"PROTOCOL-DNS glibc getaddrinfo A record stack buffer overflow attempt"; flow:to_client; dsize:>2000; byte_test:1,&,2,2; byte_test:1,&,0x80,2; byte_test:1,!&,0x78,2; content:"|00 01|",depth 2,offset 4; content:"|00 00 01 00 01|",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:dns; reference:cve,2015-7547; reference:url,googleonlinesecurity.blogspot.com/2016/02/cve-2015-7547-glibc-getaddrinfo-stack.html; classtype:attempted-user; sid:37730; rev:5; )
alert udp any 53 -> $HOME_NET any ( msg:"PROTOCOL-DNS glibc getaddrinfo AAAA record stack buffer overflow attempt"; flow:to_client; dsize:>2000; byte_test:1,&,2,2; byte_test:1,&,0x80,2; byte_test:1,!&,0x78,2; content:"|00 01|",depth 2,offset 4; content:"|00 00 1C 00 01|",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:dns; reference:cve,2015-7547; reference:url,googleonlinesecurity.blogspot.com/2016/02/cve-2015-7547-glibc-getaddrinfo-stack.html; classtype:attempted-user; sid:37731; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1720 ( msg:"POLICY-OTHER Polycom Botnet inbound connection attempt"; flow:to_server,established; content:"|03 00|",depth 2; content:"|08|",distance 2; content:"|05|",distance 4; content:"MERA RTU",within 100,fast_pattern; metadata:ruleset community; reference:url,support.polycom.com/global/documents/support/documentation/H_3_2_3_Botnet_Bulletin_v_1_2.pdf; classtype:trojan-activity; sid:37814; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 1720 ( msg:"POLICY-OTHER Polycom Botnet inbound connection attempt"; flow:to_server,established; content:"|03 00|",depth 2; content:"|08 02|",within 2,distance 2; content:"EE|A8 C6|3",within 80; content:"ooh323",distance 6,fast_pattern; metadata:ruleset community; reference:url,support.polycom.com/global/documents/support/documentation/H_3_2_3_Botnet_Bulletin_v_1_2.pdf; classtype:trojan-activity; sid:37815; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.NetWiredRC variant connection setup"; flow:to_server,established; content:"|43 00 00 00 05|",depth 5; isdataat:!79; metadata:impact_flag red,ruleset community; reference:url,www.circl.lu/pub/tr-23/; classtype:trojan-activity; sid:38353; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.NetWiredRC variant failed read logs"; flow:to_server,established; content:"|01 00 00 00 3C|",depth 5; isdataat:4; isdataat:!5; metadata:impact_flag red,ruleset community; reference:url,www.circl.lu/pub/tr-23/; classtype:trojan-activity; sid:38354; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.NetWiredRC variant keepalive"; flow:to_server,established; content:"|01 00 00 00 01|",depth 5; isdataat:4; isdataat:!5; metadata:impact_flag red,ruleset community; reference:url,www.circl.lu/pub/tr-23/; classtype:trojan-activity; sid:38355; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.NetWiredRC variant send credentials"; flow:to_server,established; content:"|01 00 00 00 3D|",depth 5; isdataat:4; isdataat:!5; metadata:impact_flag red,ruleset community; reference:url,www.circl.lu/pub/tr-23/; classtype:trojan-activity; sid:38357; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.NetWiredRC variant send mail credentials"; flow:to_server,established; content:"|01 00 00 00 41|",depth 5; isdataat:!9; metadata:impact_flag red,ruleset community; reference:url,www.circl.lu/pub/tr-23/; classtype:trojan-activity; sid:38359; rev:3; )
alert tcp $EXTERNAL_NET 4043 -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Dridex certificate exchange"; flow:to_client,established; content:"|16 03|"; content:"|0B|",distance 3; content:"|55 04 07 0C 06|Lisbon"; content:"|55 04 0A 0C 10|Souppi Otiop SEM",distance 6; content:"|55 04 03 0C 0E|wthcethesmw.ph"; metadata:impact_flag red,ruleset community; service:ssl; reference:url,www.virustotal.com/en/file/f4bf52759270fa4fc4e5745d51dd8d73b49feae9de5bedfd8f4e0a865e8047c4/analysis/1459264179/; classtype:trojan-activity; sid:38378; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:"MALWARE-CNC Win.Trojan.FTPKeyLogger outbound connection"; flow:to_server,established; content:"USER obitex@benfoods.tk|0D 0A|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:ftp; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.virustotal.com/en/file/44f956d41f5aea97884f88f60c1e28dc246b4b7318a87b332367e7f0476ca8fc/analysis/1459279340/; classtype:trojan-activity; sid:38385; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:"MALWARE-CNC Win.Trojan.FTPKeyLogger outbound connection"; flow:to_server,established; content:"PASS Goodman1986|0D 0A|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:ftp; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.virustotal.com/en/file/44f956d41f5aea97884f88f60c1e28dc246b4b7318a87b332367e7f0476ca8fc/analysis/1459279340/; classtype:trojan-activity; sid:38386; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:"MALWARE-CNC Win.Trojan.FTPKeyLogger outbound connection"; flow:to_server,established; content:"STOR Screenshot from|3A 20|",fast_pattern; content:"|29|.png",within 80; metadata:impact_flag red,ruleset community; service:ftp; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.virustotal.com/en/file/44f956d41f5aea97884f88f60c1e28dc246b4b7318a87b332367e7f0476ca8fc/analysis/1459279340/; classtype:trojan-activity; sid:38387; rev:2; )
alert udp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Sweeper outbound connection"; flow:to_server,no_stream; dsize:9; content:"hi00",fast_pattern,nocase; pcre:"/hi00[0-9]{5}/"; detection_filter:track by_src,count 1000,seconds 1; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/38221267218184b17a78d8814d1bd06b12143be859488ae15ca0d754f32d60fc/analysis/1460472611/; classtype:trojan-activity; sid:38514; rev:4; )
alert udp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Sweeper outbound connection"; flow:to_server,no_stream; dsize:24; content:"|39 64 30 33 66 65 66 35 30 30 62 39 30 30 34 36 32 37 31 31 30 33 32 35|",fast_pattern,nocase; detection_filter:track by_src,count 1000,seconds 1; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/38221267218184b17a78d8814d1bd06b12143be859488ae15ca0d754f32d60fc/analysis/1460472611/; classtype:trojan-activity; sid:38515; rev:4; )
alert udp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Sweeper outbound connection"; flow:to_server,no_stream; dsize:24; content:"|61 63 36 62 66 34 64 30 66 35 36 30 30 30 34 36 32 37 31 31 30 33 39 39|",fast_pattern,nocase; detection_filter:track by_src,count 1000,seconds 1; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/38221267218184b17a78d8814d1bd06b12143be859488ae15ca0d754f32d60fc/analysis/1460472611/; classtype:trojan-activity; sid:38516; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Dridex certificate exchange"; flow:to_client,established; content:"|16 03|"; content:"|0B|",distance 3; content:"|55 04 07 0C 0B|Ouagadougou"; content:"|55 04 0A 0C 16|Tiongon Wledb A.M.B.A.",distance 6; content:"|55 04 03 0C 10|ina.themanyag.zm",distance 6; metadata:impact_flag red,ruleset community; service:ssl; reference:url,www.virustotal.com/en/file/fc25709c4e05dbfbcc6ae0cf8a7c06e80156ae05179203021838259aeda9801a/analysis/1461600547/; classtype:trojan-activity; sid:38620; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Bayrob variant outbound connection"; flow:to_server,established; isdataat:7; isdataat:!8; content:"|4C 48 42 80 71 C2 A5 DF|",depth 8; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/6b6b91cd104f4a6d32b5187131d9053911607672076e6ed26ed51369e5329cad/analysis/1462889491/; classtype:trojan-activity; sid:38886; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,587] ( msg:"MALWARE-CNC Win.Trojan.Kirts initial registration"; flow:to_server,established; content:"Subject|3A 20|=?utf-8?B?SGF3a0V5ZSBMb2dnZXIg",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:smtp; reference:url,www.virustotal.com/en/file/f81128f3b9c0347f4ee5946ecf9a95a3d556e8e3a4742d01e5605f862e1d116d/analysis/1462888129/; classtype:trojan-activity; sid:38891; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.PassStealer passwords exfiltration attempt"; flow:to_server; file_data; content:"Passwords Recorded On ",fast_pattern; content:"Time of Recording:",within 20,distance 22; content:"IP Address",within 12,distance 15; metadata:impact_flag red,ruleset community; service:ftp; reference:url,attack.mitre.org/techniques/T1020; reference:url,virustotal.com/en/file/5780e8408c8d5c84d1fbe5c53eeb77832a6af54fd41fab7f720c89fc10989340/analysis/1463495191/; classtype:trojan-activity; sid:38950; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.NetWiredRC variant connection setup"; flow:to_server,established; content:"|3B 00 00 00 05|",depth 5; isdataat:!64; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/5db3b9ce06e334cb61279dd936a40be75df6732228bb692a7a84b1299eb09071/analysis/1464362377/; classtype:trojan-activity; sid:39080; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.LuminosityLink RAT variant outbound connection"; flow:to_server,established; content:"=P4CK3T=",depth 32; content:"8_=_8"; metadata:impact_flag red,ruleset community; reference:url,virustotal.com/en/file/0a6ee066b27f5f8dfeedb8e5f19659e47b70296a49a627e2ce9d3d9456287051/analysis/; classtype:trojan-activity; sid:39106; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.LuminosityLink RAT variant inbound connection"; flow:to_client,established; content:"=P4CK3T=",depth 32; content:"8_=_8"; metadata:impact_flag red,ruleset community; reference:url,virustotal.com/en/file/0a6ee066b27f5f8dfeedb8e5f19659e47b70296a49a627e2ce9d3d9456287051/analysis/; classtype:trojan-activity; sid:39107; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.JRat inbound self-signed SSL certificate"; flow:to_client,established; content:"|16 03 01|"; content:"|02|",distance 2; content:"|03 01|",distance 3; content:"|55 04 06 13 02|FR"; content:"|55 04 0A 13 0C|assylias.Inc",distance 6; content:"|55 04 03 13 08|assylias",distance 6; metadata:impact_flag red,ruleset community; service:ssl; reference:url,www.virustotal.com/en/file/45e8df88b177cec3972f36284290eab652fb21806ef7e9575be853fb30528f28/analysis/; classtype:trojan-activity; sid:39159; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.JRat inbound self-signed SSL certificate"; flow:to_client,established; content:"|16 03 01|"; content:"|02|",distance 2; content:"|03 01|",distance 3; content:"|55 04 06 13 02|US"; content:"|55 04 08 13 0A|California",distance 6; content:"|55 04 07 13 0E|Redwood Shores",distance 6; content:"|55 04 0A 13 14|Oracle America, Inc.",distance 6; content:"|55 04 0B 13 13|Code Signing Bureau",distance 6; content:"|55 04 03 13 14|Oracle America, Inc.",distance 6; metadata:impact_flag red,ruleset community; service:ssl; reference:url,www.virustotal.com/en/file/9d54565f8fb7cf50df11bf9745f7efd04a49abb03e85a3aafbf9a5b5fcd065c9/analysis/; classtype:trojan-activity; sid:39160; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Dridex self-signed certificate exchange"; flow:to_client,established; content:"|16 03|"; content:"|59|",distance 3; content:"|55 04 06 13 02|BN"; content:"|55 04 07 0C 13|Bandar Seri Begawan",distance 6; content:"|55 04 0A 0C 12|Cowchi Aromep LTD.",distance 6; content:"|55 04 03 0C 17|tsre131.eollaieefi.jprs",distance 6; metadata:impact_flag red,ruleset community; service:ssl; reference:url,www.virustotal.com/en/file/6467418eea0564f77c66844e30a17c8561089f2b8301a7d306a71a34e4fef693/analysis/; classtype:trojan-activity; sid:39163; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Backdoor.NanoBot variant outbound connection"; flow:to_server,established; isdataat:11; isdataat:!12; content:"|08 00 00 00 27 C7 CC 6B C2 FD 13 0E|",depth 12; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/d74fcf6b8f2f1c3a1ed742feb3f323f7826e9fc79a3d642082cee46770a4697a/analysis/1461003042/; classtype:trojan-activity; sid:39573; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Backdoor.NanoBot variant outbound connection"; flow:to_server,established; isdataat:11; isdataat:!12; content:"|08 00 00 00 D7 75 FF F7 C7 62 B9 82|",depth 12; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/d74fcf6b8f2f1c3a1ed742feb3f323f7826e9fc79a3d642082cee46770a4697a/analysis/1461003042/; classtype:trojan-activity; sid:39574; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [9000:] ( msg:"MALWARE-CNC Win.Backdoor.NanoBot variant outbound connection"; flow:to_server,established; isdataat:67; isdataat:!68; content:"|40 00 00 00|",depth 4; byte_test:1,>,2,0,relative; content:!"|0A|",within 1,distance 1; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/d74fcf6b8f2f1c3a1ed742feb3f323f7826e9fc79a3d642082cee46770a4697a/analysis/1461003042/; classtype:trojan-activity; sid:39575; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [9000:] ( msg:"MALWARE-CNC Win.Backdoor.NanoBot variant outbound connection"; flow:to_server,established; isdataat:35; isdataat:!36; content:"|20 00 00 00 AD|",depth 5; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/d74fcf6b8f2f1c3a1ed742feb3f323f7826e9fc79a3d642082cee46770a4697a/analysis/1461003042/; classtype:trojan-activity; sid:39576; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Backdoor.NanoBot variant outbound connection"; flow:to_server,established; isdataat:11; isdataat:!12; content:"|08 00 00 00 86 CC 02 89 8F F7 A6 67|",depth 12; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/0a19499dec07ca2ade3aefdf910e13231d63d7a2e238776272b4fffd0ff3a527/analysis/1467727738/; classtype:trojan-activity; sid:39577; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.NanoBot variant inbound connection"; flow:to_client,established; isdataat:35; isdataat:!36; content:"|20 00 00 00 FE A5 0D 55 BB 10 A4 09 7A D9 86 FF 6C 81 E6 97 7C 91 BC DA EE 89 08 2A|",depth 28; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/0a19499dec07ca2ade3aefdf910e13231d63d7a2e238776272b4fffd0ff3a527/analysis/1467727738/; classtype:trojan-activity; sid:39578; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Backdoor.NanoBot variant outbound connection"; flow:to_server,established; isdataat:59; isdataat:!60; content:"|38 00 00 00 FE A5 0D 55 BB 10 A4 09 7A D9 86 FF 6C 81 E6 97 7C 91 BC DA EE 89 08 2A|",depth 28; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/0a19499dec07ca2ade3aefdf910e13231d63d7a2e238776272b4fffd0ff3a527/analysis/1467727738/; classtype:trojan-activity; sid:39579; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Backdoor.NanoBot variant outbound connection"; flow:to_server,established; isdataat:67; isdataat:!68; content:"|40 00 00 00 FE A5 0D 55 BB 10 A4 09 7A D9 86 FF 6C 81 E6 97 7C 91 BC DA EE 89 08 2A|",depth 28; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/0a19499dec07ca2ade3aefdf910e13231d63d7a2e238776272b4fffd0ff3a527/analysis/1467727738/; classtype:trojan-activity; sid:39580; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.NanoBot/Perseus initial outbound connection"; flow:to_server,established; isdataat:59; isdataat:!60; content:"|38 00 00 00 F5 13 89 53|",depth 8; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/4b16d1e205f198222bd2b2bb8dbd55886a9e2b79de484eec0d8cce5db376d3c8/analysis/; classtype:trojan-activity; sid:39581; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.NanoBot/Perseus server heartbeat request attempt"; flow:to_client,established; isdataat:35; isdataat:!36; content:"|20 00 00 00 2B FF 4B F4|",depth 8; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/4b16d1e205f198222bd2b2bb8dbd55886a9e2b79de484eec0d8cce5db376d3c8/analysis/; classtype:trojan-activity; sid:39582; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.NanoBot/Perseus client heartbeat response attempt"; flow:to_server,established; isdataat:51; isdataat:!52; content:"|30 00 00 00 2B FF 4B F4|",depth 8; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/4b16d1e205f198222bd2b2bb8dbd55886a9e2b79de484eec0d8cce5db376d3c8/analysis/; classtype:trojan-activity; sid:39583; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 900 ( msg:"MALWARE-CNC Win.Trojan.Spyrat variant outbound connection"; flow:to_server,established; content:"myversion|7C|2.5.2.",depth 19; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/e64f536556739d50a673a952da7f110f1156fad0f7360d401794e5a8d65ce63a/analysis/; classtype:trojan-activity; sid:39801; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:"FILE-OFFICE Microsoft Windows RTF file with embedded object package SMTP upload attempt"; flow:to_server,established; file_data; content:"{|5C|rt",nocase; content:"{|5C|object|5C|objemb{|5C|*|5C|objclass Package}",distance 0,nocase; flowbits:set,file.rtf.embed; metadata:policy max-detect-ips alert,policy security-ips alert,ruleset community; service:smtp; reference:url,en.wikipedia.org/wiki/Rich_Text_Format; classtype:misc-activity; sid:39903; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,587] ( msg:"MALWARE-CNC Win.Trojan.HawkEye keylogger exfiltration attempt"; flow:to_server,established; content:"Subject: HawkEye Keylogger |7C|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:smtp; reference:url,attack.mitre.org/techniques/T1020; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.virustotal.com/en/file/f4499928a6fee5d37fb711ed6d68708bf116cfc7f284d3295dd30ded7ecf64b2/analysis/; classtype:trojan-activity; sid:39911; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"OS-LINUX Linux Kernel Challenge ACK provocation attempt"; flow:to_server,no_stream; flags:R; detection_filter:track by_src,count 200,seconds 1; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,91704; reference:cve,2016-5696; reference:cve,2017-7285; classtype:attempted-admin; sid:40063; rev:5; )
alert udp $HOME_NET [500,848,4500,4848] -> $EXTERNAL_NET any ( msg:"SERVER-OTHER Cisco IOS Group-Prime memory disclosure exfiltration attempt"; flow:to_client; dsize:>2000; content:"|0B 10 05 00|",depth 8,offset 16; byte_test:4,>,2000,4,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:cve,2016-6415; reference:url,attack.mitre.org/techniques/T1020; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20160916-ikev1; classtype:attempted-recon; sid:40220; rev:6; )
alert udp $EXTERNAL_NET any -> $HOME_NET [500,848,4500,4848] ( msg:"SERVER-OTHER Cisco IOS Group-Prime MD5 memory disclosure attempt"; flow:to_server; dsize:>2000; content:"|00 00 00 00 00 00 00 00|",depth 8,offset 8; content:"|00 00 00 01 00 00 00 01|",depth 8,offset 32; content:"|01 01 04 01|",within 4,distance 4; content:"|80 02 00 01 80 04 00 01 00 06|",distance 0,fast_pattern; byte_test:2,>,2000,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:cve,2016-6415; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20160916-ikev1; classtype:attempted-recon; sid:40221; rev:5; )
alert udp $EXTERNAL_NET any -> $HOME_NET [500,848,4500,4848] ( msg:"SERVER-OTHER Cisco IOS Group-Prime SHA memory disclosure attempt"; flow:to_server; dsize:>2000; content:"|00 00 00 00 00 00 00 00|",depth 8,offset 8; content:"|00 00 00 01 00 00 00 01|",depth 8,offset 32; content:"|01 01 04 01|",within 4,distance 4; content:"|80 02 00 02 80 04 00 01 00 06|",distance 0,fast_pattern; byte_test:2,>,2000,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:cve,2016-6415; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20160916-ikev1; classtype:attempted-recon; sid:40222; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Android.Trojan.SpyNote RAT variant inbound connection"; flow:to_client,established; content:"Server Prent <please>|0D 0A|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/14eb51b26fa4932fc660daf7e803600bf29a8a46fe3f1d652194bc48e9617bd9/analysis/1478720273/; classtype:trojan-activity; sid:40762; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Android.Trojan.SpyNote RAT variant getSMS command response"; flow:to_server,established; content:"|7C|ge|7C|t|7C|SM|7C|S|7C|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/14eb51b26fa4932fc660daf7e803600bf29a8a46fe3f1d652194bc48e9617bd9/analysis/1478720273/; classtype:trojan-activity; sid:40763; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Android.Trojan.SpyNote RAT variant getContacts command response"; flow:to_server,established; content:"send|7C|G|7C 7C|Cont|7C|acts|7C|",fast_pattern,nocase; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/en/file/14eb51b26fa4932fc660daf7e803600bf29a8a46fe3f1d652194bc48e9617bd9/analysis/1478720273/; classtype:trojan-activity; sid:40764; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Backdoor.Houdini variant initial outbound connection"; flow:to_server,established; content:"new_houdini|0D 0A|",depth 13,offset 4; metadata:impact_flag red,ruleset community; classtype:trojan-activity; sid:40831; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.Houdini variant keylogger inbound init command attempt"; flow:to_client,established; isdataat:22; isdataat:!23; content:"silence_keylogger|0D 0A|",depth 19,offset 4; metadata:impact_flag red,ruleset community; reference:url,attack.mitre.org/techniques/T1056; classtype:trojan-activity; sid:40832; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.Houdini variant screenshot inbound init command attempt"; flow:to_client; content:"screenshot_init|0D 0A|",depth 17,offset 4; metadata:impact_flag red,ruleset community; classtype:trojan-activity; sid:40833; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.Houdini variant screenshot inbound silence command attempt"; flow:to_client; isdataat:23; isdataat:!24; content:"silence_screenshot|0D 0A|",depth 20,offset 4; metadata:impact_flag red,ruleset community; classtype:trojan-activity; sid:40834; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.Houdini variant screen_thumb inbound init command attempt"; flow:to_client,established; content:"screen_thumb|0D 0A|",depth 14,offset 4; metadata:impact_flag red,ruleset community; classtype:trojan-activity; sid:40835; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.Houdini variant file enumeration inbound init/root/faf command attempt"; flow:to_client,established; isdataat:22; isdataat:!23; content:"file_manager_",depth 13,offset 4; pcre:"/file_manager_(init|root|faf)\x0d\x0a/"; metadata:impact_flag red,ruleset community; classtype:trojan-activity; sid:40836; rev:4; )
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 1024: ( msg:"PUA-OTHER Bitcoin Mining subscribe Stratum protocol client request attempt"; flow:to_server,established; content:"|7B 22|id|22 3A|"; content:"|22|method|22 3A 22|mining.subscribe|22|"; content:"|22|params|22 3A|",distance 1; metadata:policy max-detect-ips drop,ruleset community; reference:url,www.virustotal.com/en/file/f35b65743142090ecf031731cb0bd77b15055e36dcdaa7a4ab09c5b2add13d15/analysis/1479759162/; classtype:policy-violation; sid:40840; rev:2; )
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 1024: ( msg:"PUA-OTHER Bitcoin Mining authorize Stratum protocol client request attempt"; flow:to_server,established; content:"|7B 22|id|22 3A|"; content:"|22|method|22 3A 22|mining.authorize|22|"; content:"|22|params|22 3A|",distance 1; metadata:policy max-detect-ips drop,ruleset community; reference:url,www.virustotal.com/en/file/f35b65743142090ecf031731cb0bd77b15055e36dcdaa7a4ab09c5b2add13d15/analysis/1479759162/; classtype:policy-violation; sid:40841; rev:2; )
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 1024: ( msg:"PUA-OTHER Bitcoin Mining extranonce Stratum protocol subscribe client request attempt"; flow:to_server,established; content:"|7B 22|id|22 3A|"; content:"|22|method|22 3A 22|mining.extranonce.subscribe|22|"; content:"|22|params|22 3A|",distance 1; metadata:policy max-detect-ips drop,ruleset community; reference:url,www.virustotal.com/en/file/f35b65743142090ecf031731cb0bd77b15055e36dcdaa7a4ab09c5b2add13d15/analysis/1479759162/; classtype:policy-violation; sid:40842; rev:2; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1040 ( msg:"PROTOCOL-OTHER TP-Link TDDP SET_CONFIG type buffer overflow attempt"; flow:to_server; dsize:>336; content:"|01 01 00|",depth 3; byte_test:4,>=,0x0264,4,big; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.coresecurity.com/advisories/tp-link-tddp-multiple-vulnerabilities; classtype:attempted-user; sid:40866; rev:3; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1040 ( msg:"PROTOCOL-OTHER TP-Link TDDP Get_config configuration leak attempt"; flow:to_server; content:"|01 02 00|",depth 3; content:"|00 00|",within 2,distance 7; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.coresecurity.com/advisories/tp-link-tddp-multiple-vulnerabilities; classtype:attempted-recon; sid:40907; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 31337 ( msg:"MALWARE-CNC Linux.DDoS.D93 outbound connection"; flow:to_server; content:"|4E 0F 42 07 27|",depth 5; isdataat:24; isdataat:!25; metadata:impact_flag red,ruleset community; service:http; reference:url,www.virustotal.com/en/file/2c017c94d9f40cba9a20e92c7c636e98de15c599bf004fa06508d701ab9e3068/analysis/; classtype:trojan-activity; sid:40991; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.NetWiredRC variant registration message"; flow:to_server,established; content:"|41 00 00 00 83|",depth 5; isdataat:!79; metadata:impact_flag red,ruleset community; reference:url,virustotal.com/en/file/6f179a4dc1c0393b6f2dac5aaa9c20b120ced4e82ba257bb45e693472c56a88b/analysis/1484683135/; classtype:trojan-activity; sid:41374; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.NetWiredRC variant check logs"; flow:to_server,established; content:"|38 00 00 00 85|",depth 5; isdataat:!79; metadata:impact_flag red,ruleset community; reference:url,virustotal.com/en/file/6f179a4dc1c0393b6f2dac5aaa9c20b120ced4e82ba257bb45e693472c56a88b/analysis/1484683135/; classtype:trojan-activity; sid:41375; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.NetWiredRC variant keepalive"; flow:to_server,established; content:"|01 00 00 00 81|",depth 5; isdataat:4; isdataat:!5; metadata:impact_flag red,ruleset community; reference:url,virustotal.com/en/file/6f179a4dc1c0393b6f2dac5aaa9c20b120ced4e82ba257bb45e693472c56a88b/analysis/1484683135/; classtype:trojan-activity; sid:41376; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC User-Agent known malicious user-agent string - X-Mas"; flow:to_server,established; content:"User-Agent|3A 20|Useragents",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; reference:url,virustotal.com/en/file/2aa91ed4e591da10499708bde44b1f9d0000eaee9a81018cb0f36bd44844df7a/analysis/1484847335/; reference:url,virustotal.com/en/file/83a2b429b969fc5cd38b6c5072391c3513b3b914f54ea80e245b243dbd5377be/analysis/1484847306/; classtype:trojan-activity; sid:41441; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Ransomware.X-Mas outbound connection"; flow:to_server,established; content:"WebKitFormBoundary"; content:"|20|form-data|3B 20|name=|22|uid|22|",fast_pattern; content:"|20|form-data|3B 20|name=|22|uname|22|",distance 0; content:"|20|form-data|3B 20|name=|22|cname|22|",distance 0; content:"|20|form-data|3B 20|name=|22|ltime|22|",distance 0; content:"|20|form-data|3B 20|name=|22|uright|22|",distance 0; content:"|20|form-data|3B 20|name=|22|sysinfo|22|",distance 0; metadata:impact_flag red,ruleset community; service:http; reference:url,virustotal.com/en/file/2aa91ed4e591da10499708bde44b1f9d0000eaee9a81018cb0f36bd44844df7a/analysis/1484847335/; reference:url,virustotal.com/en/file/83a2b429b969fc5cd38b6c5072391c3513b3b914f54ea80e245b243dbd5377be/analysis/1484847306/; classtype:trojan-activity; sid:41442; rev:3; )
alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any ( msg:"SERVER-SAMBA Microsoft Windows SMBv2/SMBv3 Buffer Overflow attempt"; flow:to_client,established; content:"|FE|SMB|40 00|",depth 6,offset 4; content:"|03 00|",within 2,distance 6; byte_test:3,>,200,1; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:cve,2017-0016; classtype:attempted-dos; sid:41499; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Houdini variant initial outbound connection"; flow:to_server,established; content:"new_slave|0D 0A|",depth 11,offset 4; metadata:impact_flag red,ruleset community; reference:url,virustotal.com/en/file/8d75e47c04bb2cc0f4c2e973475d4ff1fc8f32039794e3ea5ca2494c66d80d3f/analysis/; classtype:trojan-activity; sid:41711; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 4786 ( msg:"SERVER-OTHER Cisco IOS Smart Install protocol backup config command attempt"; flow:to_server,established; content:"|00 00 00 01 00 00 00 01 00 00 00 08|",depth 12; content:"://"; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,tools.cisco.com/security/center/content/CiscoSecurityResponse/cisco-sr-20170214-smi; classtype:attempted-admin; sid:41722; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 4786 ( msg:"SERVER-OTHER Cisco IOS Smart Install protocol download config command attempt"; flow:to_server,established; content:"|00 00 00 01 00 00 00 01 00 00 00 03|",depth 12; content:"tftp://",nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,tools.cisco.com/security/center/content/CiscoSecurityResponse/cisco-sr-20170214-smi; classtype:attempted-admin; sid:41723; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 4786 ( msg:"SERVER-OTHER Cisco IOS Smart Install protocol download image command attempt"; flow:to_server,established; content:"|00 00 00 01 00 00 00 01 00 00 00 02|",depth 12; content:"tftp://",nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,tools.cisco.com/security/center/content/CiscoSecurityResponse/cisco-sr-20170214-smi; classtype:attempted-admin; sid:41724; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 4786 ( msg:"SERVER-OTHER Cisco IOS Smart Install protocol version command attempt"; flow:to_server,established; content:"|00 00 00 02 00 00 00 01 00 00 00 05|",depth 12; content:"tftp://",nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:cve,2018-0156; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20180328-smi; reference:url,tools.cisco.com/security/center/content/CiscoSecurityResponse/cisco-sr-20170214-smi; classtype:attempted-admin; sid:41725; rev:4; )
alert tcp any any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows SMB remote code execution attempt"; flow:to_server,established; content:"|FF|SMB3|00 00 00 00|",depth 9,offset 4; byte_extract:2,26,TotalDataCount,relative,little; byte_test:2,>,TotalDataCount,20,relative,little; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; reference:cve,2017-0144; reference:cve,2017-0146; reference:url,blog.talosintelligence.com/2017/05/wannacry.html; reference:url,isc.sans.edu/forums/diary/ETERNALBLUE+Possible+Window+SMB+Buffer+Overflow+0Day/22304/; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-010; classtype:attempted-admin; sid:41978; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [995,80,53,443] ( msg:"MALWARE-CNC Win.Trojan.RedLeaves outbound connection"; flow:to_server,established; isdataat:11; isdataat:!12; content:"|7A 8D 9B DC|",depth 4,offset 4; metadata:impact_flag red,ruleset community; reference:url,github.com/nccgroup/Cyber-Defence/blob/master/Technical%20Notes/Red%20Leaves/Red%20Leaves%20technical%20note%20v1.0.pdf; classtype:trojan-activity; sid:42225; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 ( msg:"OS-WINDOWS Microsoft Windows empty RDP cookie negotiation attempt"; flow:to_server,established; content:"|08 E0 00 00 00 00|",depth 6,offset 4; content:"|0D 0A|",within 2,distance 1; isdataat:!1,relative; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:rdp; reference:cve,2017-0176; reference:cve,2017-9073; reference:url,www.securitytracker.com/id/1038264; classtype:policy-violation; sid:42255; rev:4; )
alert tcp any any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows SMB anonymous user session setup request detected"; flow:to_server,established; content:"|FF|SMB|73 00 00 00 00|",depth 13,offset 4; content:"|01 00 00 00 00 00 00 00|",within 8,distance 38; content:"|00 00 00 00 00|",within 5,distance 6; flowbits:set,smb.null_session; flowbits:noalert; metadata:policy max-detect-ips alert,policy security-ips alert,ruleset community; service:netbios-ssn; reference:url,msdn.microsoft.com/en-us/library/ee441638.aspx; classtype:policy-violation; sid:42256; rev:7; )
alert tcp any any -> $HOME_NET 445 ( msg:"MALWARE-CNC Win.Trojan.Doublepulsar variant process injection command"; flow:to_server,established; content:"|FF|SMB|32 00 00 00 00|",depth 9,offset 4; content:"|42 00|",within 2,distance 21; content:"|0E 00|",within 2,distance 29; content:!"|00 00|",within 2; flowbits:set,smb.trans2.mid66; metadata:impact_flag red,ruleset community; service:netbios-ssn; reference:url,attack.mitre.org/techniques/T1055; reference:url,countercept.com/our-thinking/analyzing-the-doublepulsar-kernel-dll-injection-technique/; reference:url,www.virustotal.com/file/15ffbb8d382cd2ff7b0bd4c87a7c0bffd1541c2fe86865af445123bc0b770d13/analysis/; classtype:trojan-activity; sid:42331; rev:5; )
alert tcp any any -> $HOME_NET 445 ( msg:"MALWARE-CNC Win.Trojan.Doublepulsar variant ping command"; flow:to_server,established; content:"|FF|SMB|32 00 00 00 00|",depth 9,offset 4; content:"|41 00|",within 2,distance 21; content:"|0E 00 0D 00 00 00 00 00 00 00 00 00 00 00 00 00 00|",within 17,distance 29,fast_pattern,fast_pattern_offset 0,fast_pattern_length 10; flowbits:set,smb.trans2.mid65; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:netbios-ssn; reference:url,countercept.com/our-thinking/analyzing-the-doublepulsar-kernel-dll-injection-technique/; reference:url,www.virustotal.com/file/15ffbb8d382cd2ff7b0bd4c87a7c0bffd1541c2fe86865af445123bc0b770d13/analysis/; classtype:trojan-activity; sid:42332; rev:8; )
alert tcp any any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows SMB large NT RENAME transaction request memory leak attempt"; flow:to_server,established; content:"|FF|SMB|A0|",depth 5,offset 4; content:"|05 00|",within 2,distance 64; byte_test:2,>,1024,0,relative,little; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; reference:url,msdn.microsoft.com/en-us/library/ee441910.aspx; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-010; classtype:attempted-recon; sid:42338; rev:3; )
alert tcp $HOME_NET 445 -> any any ( msg:"OS-WINDOWS Microsoft Windows SMB possible leak of kernel heap memory"; flow:to_client,established; content:"Frag",fast_pattern; content:"Free"; content:"|FA FF FF|"; content:"|F8 FF FF|",within 3,distance 5; content:"|F8 FF FF|",within 3,distance 5; metadata:policy balanced-ips alert,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; reference:cve,2017-0147; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-010; classtype:attempted-recon; sid:42339; rev:3; )
alert tcp any any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows SMB anonymous session IPC share access attempt"; flow:to_server,established; flowbits:isset,smb.null_session; content:"|FF|SMB|75 00 00 00 00|",depth 9,offset 4; content:"|00 5C 00|I|00|P|00|C|00|$|00 00 00|",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; reference:url,attack.mitre.org/techniques/T1077; reference:url,msdn.microsoft.com/en-us/library/ee441910.aspx; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-010; classtype:attempted-recon; sid:42340; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [995,80,53,443] ( msg:"MALWARE-CNC Win.Trojan.RedLeaves outbound connection"; flow:to_server,established; content:"856",depth 3,offset 1; content:"856|9A F3 EC 89|",within 7,distance 1; metadata:impact_flag red,ruleset community; reference:url,github.com/nccgroup/Cyber-Defence/blob/master/Technical%20Notes/Red%20Leaves/Red%20Leaves%20technical%20note%20v1.0.pdf; classtype:trojan-activity; sid:42398; rev:4; )
alert tcp any any -> $HOME_NET 445 ( msg:"OS-WINDOWS Microsoft Windows SMB remote code execution attempt"; flow:to_server,established; content:"|FF|SMB|A0 00 00 00 00|",depth 9,offset 4; content:"|01 00 00 00 00|",within 5,distance 59; byte_test:4,>,0x8150,-33,relative,little; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; reference:cve,2017-0144; reference:cve,2017-0146; reference:url,isc.sans.edu/forums/diary/ETERNALBLUE+Possible+Window+SMB+Buffer+Overflow+0Day/22304/; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-010; classtype:attempted-admin; sid:42944; rev:2; )
alert tcp any any -> $HOME_NET 445 ( msg:"PROTOCOL-OTHER NETBIOS SMB IPC share access attempt"; flow:to_server,established; content:"|FF|SMB|75 00 00 00 00|",depth 9,offset 4; content:"IPC$|00|",fast_pattern,nocase; flowbits:set,smb.tree.connect.ipc; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:netbios-ssn; reference:url,attack.mitre.org/techniques/T1077; classtype:misc-activity; sid:43002; rev:8; )
alert tcp any any -> $HOME_NET 445 ( msg:"PROTOCOL-OTHER NETBIOS SMB IPC share access attempt"; flow:to_server,established; content:"|FF|SMB|75 00 00 00 00|",depth 9,offset 4; content:"I|00|P|00|C|00|$|00 00 00|",fast_pattern,nocase; flowbits:set,smb.tree.connect.ipc; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:netbios-ssn; reference:url,attack.mitre.org/techniques/T1077; classtype:misc-activity; sid:43003; rev:8; )
alert tcp any any -> $HOME_NET 445 ( msg:"SERVER-SAMBA Samba is_known_pipe arbitrary module load code execution attempt"; flow:to_server,established; flowbits:isset,smb.tree.connect.ipc; content:"|FF|SMB|A2 00 00 00 00|",depth 9,offset 4; byte_test:2,=,0,1,relative,little,bitmask 0x8000; byte_extract:2,72,len,relative,little; content:"/",within 1; content:"/",within len,distance 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; reference:cve,2017-7494; reference:url,www.samba.org/samba/security/CVE-2017-7494.html; classtype:attempted-user; sid:43004; rev:5; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.HiddenCobra variant outbound connection"; flow:to_server,established; content:"|18 17 E9 E9 E9 E9|",fast_pattern,nocase; isdataat:!7; metadata:impact_flag red,ruleset community; reference:url,www.us-cert.gov/ncas/alerts/TA17-164A; classtype:trojan-activity; sid:43193; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.HiddenCobra variant outbound connection"; flow:to_server,established; content:"|1B 17 E9 E9 E9 E9|",depth 6; metadata:impact_flag red,ruleset community; reference:url,www.us-cert.gov/ncas/alerts/TA17-164A; classtype:trojan-activity; sid:43194; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:"SERVER-OTHER WSFTP IpSwitch custom SITE command execution attempt"; flow:to_server,established; content:"SITE SETC",nocase; metadata:policy max-detect-ips drop,ruleset community; service:ftp; reference:cve,2004-1885; classtype:attempted-admin; sid:43663; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9080 ( msg:"SERVER-WEBAPP Kaspersky Linux File Server WMC cross site request forgery attempt"; flow:to_server,established; http_uri; content:"/cgi-bin/cgictl?action=setTaskSettings",fast_pattern,nocase; http_client_body; content:"settings={|22|",nocase; content:"taskId="; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:bugtraq,99330; reference:cve,2017-9810; reference:url,coresecurity.com/advisories/Kaspersky-Anti-Virus-File-Server-Multiple-Vulnerabilities; classtype:web-application-attack; sid:43809; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9080 ( msg:"SERVER-WEBAPP Kaspersky Linux File Server WMC directory traversal attempt"; flow:to_server,established; http_uri; content:"/cgi-bin/cgictl",fast_pattern,nocase; content:"reportId=",nocase; content:"../"; pcre:"/[?&]reportId=[^&]*?\x2e\x2e\x2f/i"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:bugtraq,99330; reference:cve,2017-9812; reference:url,coresecurity.com/advisories/Kaspersky-Anti-Virus-File-Server-Multiple-Vulnerabilities; classtype:web-application-attack; sid:43810; rev:2; )
alert tcp $EXTERNAL_NET [443,447,449] -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Trickbot self-signed certificate exchange"; flow:to_client,established; content:"|16 03|"; content:"|30 82|",distance 13; content:"3t2t3rgeg"; content:"fg2eq34df",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:ssl; reference:url,virustotal.com/#/file/604bd405cf8edd910b25c52b63ab7e4b6c2242bc6eaf6eca4cccb718e1d291e2; classtype:trojan-activity; sid:44399; rev:2; )
alert tcp $EXTERNAL_NET [443,447,449] -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Trickbot self-signed certificate exchange"; flow:to_client,established; content:"|16 03|"; content:"|30 82|",distance 13; content:"f2tee4"; content:"rvgvtfdf",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:ssl; reference:url,virustotal.com/#/file/604bd405cf8edd910b25c52b63ab7e4b6c2242bc6eaf6eca4cccb718e1d291e2; classtype:trojan-activity; sid:44400; rev:2; )
alert tcp $EXTERNAL_NET [443,447,449] -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Trickbot self-signed certificate exchange"; flow:to_client,established; content:"|16 03|"; content:"|30 82|",distance 13; content:"|00 92 93 45 3A 42 8B 15 4C|",fast_pattern,nocase; content:"London"; content:"example.com"; metadata:impact_flag red,ruleset community; service:ssl; reference:url,malware-traffic-analysis.net/2017/08/12/index.html; classtype:trojan-activity; sid:44401; rev:2; )
alert tcp $EXTERNAL_NET [443,447,449] -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Trickbot self-signed certificate exchange"; flow:to_client,established; content:"|16 03|"; content:"|30 82|",distance 13; content:"|00 DC 5E AE E6 3E EC 78 EC|"; content:"Alaska"; content:"John_Alaska@gmail.com",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:ssl; reference:url,virustotal.com/en/file/70041c335a374d84f64c6c31d59ff09bd8473fd049cfcb46fe085d1eb92ac0b8/analysis/1502073944/; classtype:trojan-activity; sid:44402; rev:2; )
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.PandaZeus malicious certificate exchange"; flow:to_client,established; content:"|16 03|"; content:"|30 82|",within 2,distance 13; content:"Let's Encrypt"; content:"gloverkentok.us",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:ssl; reference:url,virustotal.com/#/file/220a2b2d7353a697496abcabf1b4c1990b8c9b7143e6dada17782ddd9ee2c232; classtype:trojan-activity; sid:44591; rev:2; )
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.PandaZeus self-signed certificate exchange"; flow:to_client,established; content:"|16 03|"; content:"|30 82|",within 2,distance 13; content:"My Company Name LTD."; content:"domain.com",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:ssl; reference:url,virustotal.com/#/file/00fa65c8fced0abfab3f544801014a349f7d960819d8d79c47abe090bd75ccfc; classtype:trojan-activity; sid:44592; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8291 ( msg:"SERVER-OTHER Mikrotik RouterOS denial of service attempt"; flow:to_server,established; content:"|12 02|",depth 2; content:"|FF ED 00 00 00 00|",distance 0; metadata:policy max-detect-ips drop,ruleset community; reference:cve,2012-6050; classtype:denial-of-service; sid:44643; rev:3; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1900 ( msg:"SERVER-OTHER libupnp command buffer overflow attempt"; flow:to_server; content:"NOTIFY ",depth 7; content:"|3A|device|3A|"; isdataat:180,relative; content:!"|3A|",within 180; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssdp; reference:cve,2012-5958; reference:cve,2012-5962; classtype:attempted-admin; sid:44743; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 9251 ( msg:"SERVER-OTHER QNAP transcode server command injection attempt"; flow:to_server,established; content:"|01 00 00 00|",depth 4; content:"|7C|",distance 0; content:"|09|",within 50; metadata:policy max-detect-ips drop,ruleset community; reference:url,www.qnap.com/en-us/; classtype:attempted-admin; sid:44971; rev:3; )
alert udp $EXTERNAL_NET any -> $HOME_NET 1900 ( msg:"SERVER-OTHER SSDP M-SEARCH ssdp-all potential amplified distributed denial-of-service attempt"; flow:to_server,no_stream; content:"M-SEARCH",depth 9; content:"ssdp:all",fast_pattern,nocase; detection_filter:track by_src,count 50,seconds 1; metadata:policy max-detect-ips drop,ruleset community; service:ssdp; reference:cve,2013-5211; reference:url,www.us-cert.gov/ncas/alerts/TA14-017A; classtype:attempted-dos; sid:45157; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 1025: ( msg:"MALWARE-CNC Vbs.Trojan.Agent outbound connection"; flow:to_server,established; content:"Content-Length: 0",fast_pattern,nocase; content:"User-Agent"; content:"|2D 7C 2D|",within 10; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html; reference:url,virustotal.com/en/file/15f5aaa71bfa3d62fd558a3e88dd5ba26f7638bf2ac653b8d6b8d54dc7e5926b/analysis/; classtype:trojan-activity; sid:45642; rev:3; )
alert tcp $EXTERNAL_NET 1025: -> $HOME_NET any ( msg:"MALWARE-CNC Vbs.Trojan.Agent inbound payload download"; flow:to_client,established; content:"s0|2D 7C 2D|",fast_pattern,nocase; content:"Content-Length"; content:"s0|2D 7C 2D|",within 200; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html; reference:url,virustotal.com/en/file/15f5aaa71bfa3d62fd558a3e88dd5ba26f7638bf2ac653b8d6b8d54dc7e5926b/analysis/; classtype:trojan-activity; sid:45643; rev:4; )
alert tcp $EXTERNAL_NET 1025: -> $HOME_NET any ( msg:"MALWARE-CNC Vbs.Trojan.Agent inbound payload download"; flow:to_client,established; content:"s1|2D 7C 2D|",fast_pattern,nocase; content:"Content-Length"; content:"s1|2D 7C 2D|",within 200; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html; reference:url,virustotal.com/en/file/15f5aaa71bfa3d62fd558a3e88dd5ba26f7638bf2ac653b8d6b8d54dc7e5926b/analysis/; classtype:trojan-activity; sid:45644; rev:3; )
alert tcp $EXTERNAL_NET 1025: -> $HOME_NET any ( msg:"MALWARE-CNC Vbs.Trojan.Agent inbound payload download"; flow:to_client,established; content:"s2|2D 7C 2D|",fast_pattern,nocase; content:"Content-Length"; content:"s3|2D 7C 2D|",within 200; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html; reference:url,virustotal.com/en/file/15f5aaa71bfa3d62fd558a3e88dd5ba26f7638bf2ac653b8d6b8d54dc7e5926b/analysis/; classtype:trojan-activity; sid:45645; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 1025: ( msg:"MALWARE-CNC Vbs.Trojan.Agent outbound system information disclosure"; flow:to_server,established; content:"POST /is-return ",depth 16,fast_pattern; content:"User-Agent"; content:"|2D 7C 2D|",within 10; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html; reference:url,virustotal.com/en/file/15f5aaa71bfa3d62fd558a3e88dd5ba26f7638bf2ac653b8d6b8d54dc7e5926b/analysis/; classtype:trojan-activity; sid:45646; rev:4; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Silverstar outbound connection"; flow:to_server,established; http_uri; content:"response=fallback",fast_pattern,nocase; content:"/api.php?",depth 9; content:"gpu=",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:url,www.virustotal.com/#/file/3f751799a501532f43ca5f12fe80aa0bad78f9f5d57e76bf49b401bb99f355df/detection; classtype:trojan-activity; sid:45960; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Revenge RAT initial outbound connection"; flow:to_server,established; content:"Information",depth 11; content:"false|2A 2D 5D|NK|5B 2D 2A|",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/en/file/518f7803ad1b8e630f50719d7cb3638ea5d67fa4d4387a55f44ddca4ef55a3ee/analysis/; reference:url,www.virustotal.com/en/file/79bdbf9ec639d5ccf3992e9c9fe9eeba21d191dc168194a80b50f3aa8068892a/analysis/; reference:url,www.virustotal.com/en/file/edb115dd5ca7c7f9dd069746daa0a4ee6298bf94de62510d3f8bebfa5f5a8bcd/analysis/; classtype:trojan-activity; sid:45961; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Revenge RAT inbound heartbeat check"; flow:to_client,established; content:"PNC|2A 2D 5D|NK|5B 2D 2A|",depth 11; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/en/file/518f7803ad1b8e630f50719d7cb3638ea5d67fa4d4387a55f44ddca4ef55a3ee/analysis/; reference:url,www.virustotal.com/en/file/79bdbf9ec639d5ccf3992e9c9fe9eeba21d191dc168194a80b50f3aa8068892a/analysis/; reference:url,www.virustotal.com/en/file/edb115dd5ca7c7f9dd069746daa0a4ee6298bf94de62510d3f8bebfa5f5a8bcd/analysis/; classtype:trojan-activity; sid:45962; rev:1; )
alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:"MALWARE-CNC Win.Trojan.UDPOS outbound system information disclousre"; flow:to_server; isdataat:150; content:"|0F|"; content:"|03|bin",within 4,distance 15,fast_pattern; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:dns; reference:url,blogs.forcepoint.com/security-labs/udpos-exfiltrating-credit-card-data-dns; reference:url,www.virustotal.com/#/file/62688903adfc719c5514f25a17563547aac4801959852f5d49faa93967ce86cf/detection; classtype:trojan-activity; sid:45964; rev:1; )
alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:"MALWARE-CNC Win.Trojan.UDPOS outbound heartbeat"; flow:to_server; isdataat:150; content:"|0F|"; content:"|04|ping",within 5,distance 15,fast_pattern; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:dns; reference:url,blogs.forcepoint.com/security-labs/udpos-exfiltrating-credit-card-data-dns; reference:url,www.virustotal.com/#/file/62688903adfc719c5514f25a17563547aac4801959852f5d49faa93967ce86cf/detection; classtype:trojan-activity; sid:45966; rev:1; )
alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:"MALWARE-CNC Win.Trojan.UDPOS outbound data exfiltration"; flow:to_server; isdataat:150; content:"|0F|"; content:"|03|trp",within 4,distance 15,fast_pattern; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:dns; reference:url,attack.mitre.org/techniques/T1020; reference:url,blogs.forcepoint.com/security-labs/udpos-exfiltrating-credit-card-data-dns; reference:url,www.virustotal.com/#/file/62688903adfc719c5514f25a17563547aac4801959852f5d49faa93967ce86cf/detection; classtype:trojan-activity; sid:45967; rev:2; )
alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:"MALWARE-CNC Win.Trojan.UDPOS outbound data exfiltration"; flow:to_server; isdataat:150; content:"|0F|"; content:"|04|note",within 5,distance 15,fast_pattern; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:dns; reference:url,attack.mitre.org/techniques/T1020; reference:url,blogs.forcepoint.com/security-labs/udpos-exfiltrating-credit-card-data-dns; reference:url,www.virustotal.com/#/file/62688903adfc719c5514f25a17563547aac4801959852f5d49faa93967ce86cf/detection; classtype:trojan-activity; sid:45968; rev:2; )
alert tcp $HOME_NET 445 -> any any ( msg:"OS-WINDOWS Microsoft Windows SMB kernel heap memory leak attempt"; flow:to_client,established; content:"|FF|SMB|A0|",depth 5,offset 4; isdataat:127; content:"|FF FF FF FF|",within 4,distance 123; byte_extract:4,28,ids; byte_test:4,=,ids,174,relative; byte_extract:2,0,uid,relative; byte_test:2,=,uid,172,relative; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; reference:cve,2017-0143; reference:cve,2017-0146; reference:cve,2017-0147; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-010; classtype:attempted-recon; sid:45977; rev:2; )
alert tcp $HOME_NET 445 -> any any ( msg:"OS-WINDOWS Microsoft Windows SMB kernel heap memory leak attempt"; flow:to_client,established; content:"|FF|SMB|A0|",depth 5,offset 4; isdataat:111; content:"|FA FF FF|",within 3,distance 108; content:"|FA FF FF|",distance 0; byte_extract:4,28,ids; byte_test:4,=,ids,242,relative; byte_extract:2,0,uid,relative; byte_test:2,=,uid,240,relative; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; reference:cve,2017-0143; reference:cve,2017-0146; reference:cve,2017-0147; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-010; classtype:attempted-recon; sid:45978; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC MultiOS.Trojan.OSCelestial variant outbound connection"; flow:to_server,established; content:"|72 00 17|com.net.LoginDataPacket",fast_pattern,nocase; content:"|74 00 13|Lcom/net/LoginData",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/en/file/9b4843ff0181af15a6c8478ca00aafd4296592a2985a480575810f4f64442742/analysis/; classtype:trojan-activity; sid:45979; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC MultiOS.Trojan.OSCelestial variant inbound connection"; flow:to_client,established; content:"|74 00 29|net.oscp.client.keylogger.KeystrokeLogger",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,attack.mitre.org/techniques/T1056; reference:url,www.virustotal.com/en/file/9b4843ff0181af15a6c8478ca00aafd4296592a2985a480575810f4f64442742/analysis/; classtype:trojan-activity; sid:45980; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.CrossRAT outbound connection attempt"; flow:to_server,established; content:"[^8]&&&",fast_pattern,nocase; content:"[^8]&&&"; isdataat:!0,relative; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/#/file/da81aec00b563123d2fbd14fb6a76619c90f81e83c5bd8aa0676922cae96b9ad/detection; classtype:trojan-activity; sid:46050; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Bandook/Anbacas outbound connection attempt"; flow:to_server,established; content:"QDAwMD",depth 6,fast_pattern; content:"&&&",within 200; isdataat:!0,relative; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,info.lookout.com/rs/051-ESQ-475/images/Lookout_Dark-Caracal_srr_20180118_us_v.1.0.pdf; reference:url,www.virustotal.com/#/file/bf600e7b27bdd9e396e5c396aba7f079c244bfb92ee45c721c2294aa36586206/detection; classtype:trojan-activity; sid:46051; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"NETBIOS MikroTik RouterOS buffer overflow attempt"; flow:to_server,established; content:"|81 00|",depth 2; byte_test:2,>,75,0,relative; byte_extract:2,0,len,relative; isdataat:!len,relative; isdataat:len; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; reference:bugtraq,103427; reference:cve,2018-7445; classtype:attempted-user; sid:46076; rev:2; )
alert tcp $EXTERNAL_NET 32764 -> $HOME_NET any ( msg:"PROTOCOL-OTHER use of undocumented ScMM test interface in Cisco small business devices detected"; flow:to_client,established; isdataat:6; content:"MMcS",depth 4; metadata:policy max-detect-ips drop,ruleset community; reference:cve,2014-0659; classtype:misc-activity; sid:46121; rev:3; )
alert tcp $EXTERNAL_NET 32764 -> $HOME_NET any ( msg:"PROTOCOL-OTHER use of undocumented ScMM test interface in Cisco small business devices detected"; flow:to_client,established; isdataat:6; content:"ScMM",depth 4; metadata:policy max-detect-ips drop,ruleset community; reference:cve,2014-0659; classtype:misc-activity; sid:46122; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 32764 ( msg:"PROTOCOL-OTHER use of undocumented ScMM test interface in Cisco small business devices detected"; flow:to_server,established; isdataat:6; content:"MMcS",depth 4; metadata:policy max-detect-ips drop,ruleset community; reference:cve,2014-0659; classtype:misc-activity; sid:46123; rev:3; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 32764 ( msg:"PROTOCOL-OTHER use of undocumented ScMM test interface in Cisco small business devices detected"; flow:to_server,established; isdataat:6; content:"ScMM",depth 4; metadata:policy max-detect-ips drop,ruleset community; reference:cve,2014-0659; classtype:misc-activity; sid:46124; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.Cidox variant outbound connection attempt"; flow:to_server,established; content:"POST /b/req/",depth 12; content:" HTTP/1.1|0D 0A|Accept: */*|0D 0A|Content-Type: application/octet-stream|0D 0A|Connection: Close|0D 0A|User-Agent: Mozilla/",within 103,distance 24; content:")|0D 0A|Host: ",distance 0; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; classtype:trojan-activity; sid:46137; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 23 ( msg:"SERVER-OTHER NETGEAR TelnetEnable attempt"; flow:to_server,established; content:"|C0 F3 AC 2A 40 79 49 0C A3 6E 89 64 73 66 0F 0B|"; content:"|5D FC 67 3A 16 DC 00 56 A3 6E 89 64 73 66 0F 0B|"; metadata:policy max-detect-ips drop,ruleset community; classtype:attempted-admin; sid:46317; rev:3; )
alert udp $EXTERNAL_NET any -> $HOME_NET 23 ( msg:"SERVER-OTHER NETGEAR TelnetEnable attempt"; flow:to_server; content:"|59 0D B1 E7 67 23 51 BA 5B 5D 52 33 91 0D 09 7F|"; content:"|09 44 80 0E DE B6 FA 3B 5B 5D 52 33 91 0D 09 7F|"; metadata:policy max-detect-ips drop,ruleset community; classtype:attempted-admin; sid:46318; rev:3; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.Ammy heartbeat"; flow:to_server,established; content:"id=",depth 3,offset 5; content:"&os=",within 4,distance 8; content:"&priv=",distance 0; content:"&cred=",distance 0; content:"&pcname=",distance 0; content:"&build_time=",distance 0,fast_pattern; content:"&card=",distance 0; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:46487; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Qarallax outbound connection"; flow:to_server,established; content:"|00 07|nemesis",depth 10; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/en/file/658f67dbf509fc017ace6db7ed38b3591fe72b9ba950a59054869cd718b4da2b/analysis; classtype:trojan-activity; sid:46747; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Qarallax outbound connection"; flow:to_server,established; content:"|00 05|child|01 00 16|",depth 11; content:"|22|magic|22|",within 100; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/en/file/658f67dbf509fc017ace6db7ed38b3591fe72b9ba950a59054869cd718b4da2b/analysis; classtype:trojan-activity; sid:46748; rev:1; )
alert tcp $EXTERNAL_NET [443,8443] -> $HOME_NET any ( msg:"MALWARE-CNC Unix.Trojan.Vpnfilter variant SSL connection attempt"; flow:to_client,established; content:"|09 4D 69 63 72 6F 73 6F 66 74 31 10 30 0E 06 03 55 04 0B 13 07 53 75 70 70 6F 72 74 31 0B 30 09 06 03 55 04 03 13 02 63 61|",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:url,blog.talosintelligence.com/2018/05/VPNFilter.html; classtype:trojan-activity; sid:46782; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [443,8443] ( msg:"MALWARE-CNC Unix.Trojan.Vpnfilter variant SSL connection attempt"; flow:to_server,established; content:"|09 4D 69 63 72 6F 73 6F 66 74 31 10 30 0E 06 03 55 04 0B 13 07 53 75 70 70 6F 72 74 31 0B 30 09 06 03 55 04 03 13 02 63 61|",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:url,blog.talosintelligence.com/2018/05/VPNFilter.html; classtype:trojan-activity; sid:46783; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Dunihi outbound connection"; flow:to_server,established; content:"|00 00 A2 30 81 9F 30 0D 06 09 2A 86 48 86 F7 0D 01 01 01 05 00 03 81 8D 00 30 81 89 02 81 81 00|",depth 32; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/en/file/be442a5f8be3bf720236f71a613a534b8aa82b16b0daf8ff84a59bcb92e19e7d/analysis/; classtype:trojan-activity; sid:46827; rev:2; )
alert udp any 67 -> $HOME_NET 68 ( msg:"OS-LINUX Red Hat NetworkManager DHCP client command injection attempt"; content:"|63 82 53 63 35|"; content:"|FC|",within 50; pcre:"/([\xfc]).{0,50}([\x27])([\x20\x26\x3b\x7c]|[\x3c\x3e\x24]\x28)+/i"; metadata:policy max-detect-ips drop,ruleset community; service:dhcp; reference:cve,2018-1111; reference:url,access.redhat.com/security/cve/cve-2018-1111; classtype:attempted-user; sid:46847; rev:1; )
alert tcp $EXTERNAL_NET 20480 -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.CowerSnail command and control response detected"; flow:to_client,established; content:"pk",depth 2; content:"R|00|e|00|q|00|u|00|e|00|s|00|t|00|",fast_pattern,nocase; content:"|00|a|00|r|00|g|00|"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:irc; reference:url,www.virustotal.com/#/file/3fb8a4d2ed4f662a4cb4270bb5f488b79c8758aa6fc5c8b119c78fba38d6b7d1/detection; classtype:trojan-activity; sid:46872; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 20480 ( msg:"MALWARE-CNC Win.Trojan.CowerSnail initial outbound connection attempt"; flow:to_server,established; content:"+CHANNEL|0B|",fast_pattern,nocase; content:"line-client"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:irc; reference:url,www.virustotal.com/#/file/3fb8a4d2ed4f662a4cb4270bb5f488b79c8758aa6fc5c8b119c78fba38d6b7d1/detection; classtype:trojan-activity; sid:46873; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:"MALWARE-CNC Win.Trojan.Joanap variant outbound connection"; flow:to_server,established; content:"TO: Joana <xiake722@gmail.com>",fast_pattern,nocase; content:"SUBJECT: |5B|T|5D|"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:smtp; reference:url,www.virustotal.com/#/file/077d9e0e12357d27f7f0c336239e961a7049971446f7a3f10268d9439ef67885/detection; reference:url,www.virustotal.com/#/file/4c5b8c3e0369eb738686c8a111dfe460e26eb3700837c941ea2e9afd3255981e/detection; classtype:trojan-activity; sid:46885; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.Orcus RAT inbound SSL certificate"; flow:to_client,established; content:"|16 03|",depth 2; content:"|02|",within 1,distance 3; content:"|0C|Orcus Server",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:url,virustotal.com/en/file/8d880758549220154d2ff4ee578f2b49527c5fb76a07d55237b61e30bcc09e3a/analysis/; classtype:trojan-activity; sid:46981; rev:1; )
alert tcp $HOME_NET !21:23 -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE Microsoft cmd.exe banner"; flow:established; content:"Microsoft Windows",depth 18; content:"Microsoft Corp",within 250; metadata:policy max-detect-ips drop,ruleset community; reference:nessus,11633; classtype:successful-admin; sid:46983; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.NukeSped RAT variant outbound communication"; flow:to_server,established; content:"|B0 00 B0 00 B0 00 B0 00 26 00 26 00 26 00|",depth 15; metadata:impact_flag red,ruleset community; reference:url,www.virustotal.com/#/file/4a740227eeb82c20286d9c112ef95f0c1380d0e90ffb39fc75c8456db4f60756/; classtype:trojan-activity; sid:47177; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [9000:] ( msg:"MALWARE-CNC Win.Trojan.NukeSped RAT variant outbound connection"; flow:to_server,established; isdataat:83; isdataat:!84; content:"|50 00 00 00|",depth 4; byte_test:1,>,2,0,relative; content:!"|0A|",within 1,distance 1; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; reference:url,www.virustotal.com/#/file/4a740227eeb82c20286d9c112ef95f0c1380d0e90ffb39fc75c8456db4f60756/; classtype:trojan-activity; gid:1; sid:47178; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Unix.Trojan.Vpnfilter plugin variant connection attempt"; flow:to_client,established; content:"|00 AC D3 62 78 26 76 31 E5 E7 E5 1D C2 3C 15 40 25 2F 90 BD 1F 7F 0E 5E 33 77 EC 0C 1E 6B 61 47|",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,attack.mitre.org/techniques/T1176; reference:url,blog.talosintelligence.com/2018/05/VPNFilter.html; classtype:trojan-activity; sid:47377; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 ( msg:"SERVER-WEBAPP Oracle WebLogic Server unauthenticated modified JSP access attempt"; flow:to_server,established; http_uri; content:"/ws_utc/css/config/keystore/",fast_pattern,nocase; content:".jsp"; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,104763; reference:cve,2018-2894; reference:url,www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html; classtype:attempted-recon; sid:47386; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 ( msg:"SERVER-WEBAPP Oracle WebLogic Server potential unauthenticated reconnaissance attempt"; flow:to_server,established; http_uri; content:"/ws_utc/resources/setting/options/general",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,104763; reference:cve,2018-2894; reference:url,www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html; classtype:attempted-recon; sid:47387; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 ( msg:"SERVER-WEBAPP Oracle WebLogic Server potential precursor to keystore attack attempt"; flow:to_server,established; http_uri; content:"/ws_utc/resources/setting/keystore",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; reference:bugtraq,104763; reference:cve,2018-2894; reference:url,www.oracle.com/technetwork/security-advisory/cpujul2018-4258247.html; classtype:attempted-recon; sid:47388; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Mapoyun variant outbound connection attempt"; flow:to_server,established; http_header; content:"Connection:Close|3B|",fast_pattern,nocase; content:"X-CA-",nocase; content:!"User-Agent|3A|",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:url,virustotal.com/en/file/34cbcbbbc4b538f30bc3d57dd587f1b604d29f113c149bf1ab53898464ad9c80/analysis/; classtype:trojan-activity; sid:47427; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.PLEAD downloader outbound connection"; flow:to_server,established; content:"GET /logo.png HTTP/1.1|0D 0A|",depth 24; content:"User-Agent: Mozilla/4.0 (compatible|3B| MSIE 8.0)|0D 0A|",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,blog.jpcert.or.jp/2018/06/plead-downloader-used-by-blacktech.html; classtype:trojan-activity; sid:47556; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.PLEAD downloader outbound connection"; flow:to_server,established; content:"GET /index.php?id=",depth 18; content:"HTTP/1.1|0D 0A|",within 10,distance 11,nocase; content:"Cookie:"; isdataat:50,relative; content:!"=",within 50; content:!"|3B|",within 50; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,blog.jpcert.or.jp/2018/06/plead-downloader-used-by-blacktech.html; classtype:trojan-activity; sid:47557; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.Zegost variant outbound connection"; flow:to_server,established; content:"|2A 00 00 00|",depth 4; isdataat:37,relative; isdataat:!38,relative; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/#/file/108bbc4ff7b7da4f0de1225094964d03b19fc38b93933f739c475f08ae17915e/detection; classtype:trojan-activity; sid:47567; rev:2; )
alert udp $EXTERNAL_NET 53 -> $HOME_NET any ( msg:"INDICATOR-OBFUSCATION DNS TXT response record tunneling"; flow:to_client; dsize:>300; content:"|00 10 00 01 00 00 00 00 01 00 FF|",fast_pattern,nocase; detection_filter:track by_src,count 25,seconds 1; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:url,attack.mitre.org/techniques/T1048; classtype:misc-activity; sid:47639; rev:3; )
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:"SERVER-WEBAPP SSL certificate with null issuer rdnSequence fields detected"; flow:to_client,established; ssl_state:server_hello; content:"|30 07 06 03 55 04 06 13 00 31 09 30 07 06 03 55 04 08 13 00 31 09 30 07 06 03 55 04 07 13 00 31 09 30 07 06 03 55 04 0A 13 00 31 09 30 07 06 03 55 04 0B 13 00 31 09 30 07 06 03 55 04 03 13 00|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:ssl; classtype:misc-activity; sid:47640; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Identification ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"ID",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48984; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Init Device ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"CCI",depth 3,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-dos; sid:48985; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Set UnitID ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"US",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48986; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Get UnitID ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"UG",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48987; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Read Inputs ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"RE",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48988; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Set RTC ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"SC",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48989; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Read Ouputs ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"RA",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48990; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Read System Bits ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"GS",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48991; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Read Memory Integers ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"RW",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48992; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Read Memory Longs ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"RNL",depth 3,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48993; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Write System Integers ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"SF",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48994; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Write System Bits ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"SS",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48995; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Read System Longs ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"RNH",depth 3,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48996; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Read System Integers ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"GF",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48997; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Read Memory Bits ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"RB",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48998; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Write Ouputs ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"SA",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:48999; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Stop Device ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"CCS",depth 3,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-dos; sid:49000; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Start Device ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"CCR",depth 3,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-dos; sid:49001; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Write System Longs ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"SNH",depth 3,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49002; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Get RTC ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"RC",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49003; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Write Memory Bits ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"SB",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49004; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Reset Device ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"CCE",depth 3,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-dos; sid:49005; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Write Memory Longs ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"SNL",depth 3,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49006; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Write Memory Integers ASCII request "; flow:to_server,established; byte_test:1,=,101,2; content:"SW",depth 2,offset 9; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49007; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Read Operands binary request"; flow:to_server,established; byte_test:1,=,102,2; content:"|4D|",depth 1,offset 18; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49008; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Set UnitID ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"US",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49009; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Get RTC ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"RC",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49010; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Identification ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"ID",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49011; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Write Data Table binary request"; flow:to_server,established; byte_test:1,=,102,2; content:"|44|",depth 1,offset 18; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49012; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Get UnitID ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"UG",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49013; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Read Data Table binary request"; flow:to_server,established; byte_test:1,=,102,2; content:"|04|",depth 1,offset 18; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49014; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20256 ( msg:"PROTOCOL-SCADA PCOM Get PLC Name binary request"; flow:to_server,established; byte_test:1,=,102,2; content:"|0C|",depth 1,offset 18; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49015; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Set RTC ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"SC",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49016; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Read Inputs ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"RE",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49017; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Read System Bits ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"GS",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49018; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Read Longs ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"RN",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49019; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Read System Integers ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"GF",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49020; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Read Ouputs ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"RA",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49021; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Read Memory Bits ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"RB",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49022; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Read Memory Integers ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"RW",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49023; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Write Memory Bits ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"SB",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49024; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Write System Integers ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"SF",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49025; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Write System Bits ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"SS",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49026; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Write Ouputs ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"SA",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49027; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Write Memory Integers ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"SW",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49028; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Write Longs ASCII reply"; flow:to_client,established; byte_test:1,=,101,2; content:"SN",depth 2,offset 10; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49029; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Read Operands binary reply"; flow:to_client,established; byte_test:1,=,102,2; content:"|CD|",depth 1,offset 18; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49030; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Get PLC Name binary reply"; flow:to_client,established; byte_test:1,=,102,2; content:"|8C|",depth 1,offset 18; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49031; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Write Data Table binary reply"; flow:to_client,established; byte_test:1,=,102,2; content:"|C4|",depth 1,offset 18; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49032; rev:2; )
alert tcp $HOME_NET 20256 -> $EXTERNAL_NET any ( msg:"PROTOCOL-SCADA PCOM Read Data Table binary reply"; flow:to_client,established; byte_test:1,=,102,2; content:"|84|",depth 1,offset 18; metadata:policy max-detect-ips drop,ruleset community; reference:url,unitronicsplc.com; classtype:attempted-recon; sid:49033; rev:2; )
alert tcp any any -> $HOME_NET 445 ( msg:"SERVER-SAMBA Samba is_known_pipe arbitrary module load code execution attempt"; flow:to_server,established; flowbits:isset,smb.tree.connect.ipc; content:"|FF|SMB|A2 00 00 00 00|",depth 9,offset 4; byte_test:2,=,1,1,relative,little,bitmask 0x8000; byte_extract:2,72,len,relative,little; content:"/",within 2; content:"/",within len,distance 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; reference:cve,2017-7494; reference:url,www.samba.org/samba/security/CVE-2017-7494.html; classtype:attempted-user; sid:49090; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] ( msg:"MALWARE-CNC Win.Trojan.Zebrocy variant outbound connection"; flow:to_server,established; content:"S|00|e|00|m|00|i|00|n|00|a|00|r|00|_|00|2|00|0|00|1|00|8|00|_|00|1|00|.|00|A|00|O|00|-|00|A|00|",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; reference:url,virustotal.com/#/file/573ea78afb50100f896185164da3b8519e2e0f609a34a7c70460eca5b4ae640d; classtype:trojan-activity; sid:49398; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:"MALWARE-CNC Win.Trojan.TSCookie variant outbound connection"; flow:to_server,established; content:"User-Agent: Mozilla/4.0 (compatible|3B| MSIE 8.0|3B| Win32)|0D 0A|",fast_pattern,nocase; content:"|20|/t",depth 4,offset 3; content:".aspx?m=",within 20; content:!"Referer"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,blogs.jpcert.or.jp/en/2018/11/tscookie2.html; classtype:trojan-activity; sid:49664; rev:1; )
alert tcp any any -> $HOME_NET 3389 ( msg:"OS-WINDOWS Microsoft Windows RDP MS_T120 channel bind attempt"; flow:to_server,established; content:"MS_T120|00|",fast_pattern,nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:rdp; reference:cve,2019-0708; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2019-0708; classtype:attempted-admin; sid:50137; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 65314 ( msg:"MALWARE-CNC Unix.Backdoor.Godlua variant outbound connection"; flow:to_server,established; content:"|01 00 10|",depth 3; content:"|00 12 5C|",within 3,distance 9; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,virustotal.com/gui/file/bd8b1bd06817772af89d93a1789d5df13e15136e53a6af60be0900986c56234f/detection; classtype:trojan-activity; sid:50811; rev:1; )
alert udp $EXTERNAL_NET any -> $HOME_NET 500 ( msg:"SERVER-OTHER OpenBSD ISAKMP denial of service attempt"; flow:to_server; content:"|6C 6A CD CF B8 41 3F F8 00 00 00 00 00 00 00 00 01 10 04 01 00 00 00 00 00 00 00 1C|",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; reference:cve,2004-0222; classtype:denial-of-service; sid:50901; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.BlackRAT variant outbound connection"; flow:to_server,established; content:"ProClient.Data",fast_pattern,nocase; content:"Clientx|2C 20|Version=",nocase; content:"data|05|bytes",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/gui/file/6610e632758a0ae2ab9b259fe1f83236aff6b5bd485c3d4e3fd4995be68535bf/detection; classtype:trojan-activity; sid:51532; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.BlackRAT variant inbound connection"; flow:to_client,established; content:"BlackRAT.Data",fast_pattern,nocase; content:"|2C 20|Version=",nocase; content:"data|05|bytes",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/gui/file/6610e632758a0ae2ab9b259fe1f83236aff6b5bd485c3d4e3fd4995be68535bf/detection; classtype:trojan-activity; sid:51533; rev:1; )
alert udp any 67 -> $HOME_NET 68 ( msg:"OS-LINUX Red Hat NetworkManager DHCP client command injection attempt"; content:"|63 82 53 63|"; content:"|27|",distance 0; content:"|23|",within 254; pcre:"/\x63\x82\x53\x63.+?[\x0c-\xfe][\x05-\xff][\x20-\x7f]{0,250}\x27[\x20-\x7f]{3,250}\x23/s"; metadata:policy max-detect-ips drop,ruleset community; service:dhcp; reference:cve,2018-1111; reference:url,access.redhat.com/security/cve/cve-2018-1111; classtype:attempted-user; sid:52022; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.XpertRAT inbound connection"; flow:to_client,established; isdataat:!12; content:"|7C 30 7C A1 40 23 40 21|",depth 8,offset 3; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/gui/file/064d1d9a20f737679bb7ce912854c7ab29f78a0716ee8bc8dc69ade02acdca5a/detection; classtype:trojan-activity; sid:52548; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.XpertRAT outbound connection"; flow:to_server,established; isdataat:!11; content:"|7C|root|7C|",depth 6,offset 3; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,www.virustotal.com/gui/file/064d1d9a20f737679bb7ce912854c7ab29f78a0716ee8bc8dc69ade02acdca5a/detection; classtype:trojan-activity; sid:52549; rev:1; )
alert tcp any any -> $HOME_NET 8009 ( msg:"SERVER-APACHE Apache Tomcat AJP connector arbitrary file access attempt"; flow:to_server,established; content:"|12 34|",depth 2; content:"|02|",within 1,distance 2; byte_test:1,!&,0xF9,0,relative; byte_extract:2,1,protocol_len,relative; content:"HTTP",within protocol_len,nocase; content:"javax.servlet.include.request_uri|00|",fast_pattern,nocase; content:"javax.servlet.include.servlet_path|00|",nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; reference:cve,2020-1938; classtype:attempted-user; sid:53341; rev:2; )
alert tcp any any -> any any ( msg:"MALWARE-CNC Unix.Malware.Drovorub cnc inbound connection attempt"; flow:established; content:"{|22|children|22|:[{|22|name|22|:",fast_pattern,nocase; content:"|81|",depth 1; content:"|22 2C 22|value|22 3A|",distance 0,nocase; pcre:"/^\x81.{1,9}\x7b\x22children\x22\x3a\x5b\x7b\x22name\x22\x3a\x22[a-z0-9_\x2e]+\x22\x2c\x22value\x22\x3a\x22[a-z0-9\x2b\x2f]+={0,2}\x22\x7d/ims"; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:url,media.defense.gov/2020/Aug/13/2002476465/-1/-1/0/CSA_DROVORUB_RUSSIAN_GRU_MALWARE_AUG_2020.PDF; classtype:trojan-activity; sid:54793; rev:1; )
alert tcp any any -> any 88 ( msg:"MALWARE-TOOLS GhostPack Rubeus kerberos request attempt"; flow:to_server,established; content:"|05|",depth 30; content:"|0A|",within 1,distance 4; content:"Z"; content:"|A7 06 02 04 6C 69 6C 00|",within 25; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:kerberos; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,www.fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; gid:1; sid:56583; rev:2; )
alert udp any any -> any 88 ( msg:"MALWARE-TOOLS GhostPack Rubeus kerberos request attempt"; flow:to_server; content:"|05|",depth 30; content:"|0A|",within 1,distance 4; content:"Z"; content:"|A7 06 02 04 6C 69 6C 00|",within 25; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:kerberos; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,www.fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; gid:1; sid:56584; rev:2; )
alert tcp any any -> any any ( msg:"MALWARE-TOOLS GhostPack Rubeus kerberos request attempt"; flow:to_server,established; content:"User32LogonProcesss",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:kerberos; reference:url,github.com/fireeye/red_team_tool_countermeasures; reference:url,www.fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; gid:1; sid:56585; rev:2; )
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:"MALWARE-CNC Win.Backdoor.SSLBeacon variant certificate exchange attempt"; flow:to_client,established; ssl_state:server_hello; content:"ajax.microsoft.com",fast_pattern,nocase; content:"Information Technologies",nocase; content:"Microsoft",nocase; content:"Seattle",nocase; content:"WA",nocase; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:ssl; reference:url,fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; sid:56587; rev:1; )
alert udp $EXTERNAL_NET 53 -> $HOME_NET any ( msg:"MALWARE-CNC Cobalt Strike DNS beacon inbound TXT record"; flow:to_client; content:"|00 01 00 01|",depth 4,offset 4; content:"|0A|_domainkey",distance 0; content:"|00 00 10 00 01 C0 0C 00 10 00 01 00 00 00 02 01 00 FF|v=DKIM1|5C 3B| p=",distance 0; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:dns; reference:url,www.fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; sid:56592; rev:1; )
alert udp $EXTERNAL_NET 53 -> $HOME_NET any ( msg:"MALWARE-CNC Cobalt Strike DNS beacon inbound TXT record"; flow:to_client; content:"|00 01 00 01|",depth 4,offset 4; content:"|03|",within 15; content:"|0A|_domainkey",within 11,distance 3; content:"|00 00 10 00 01 C0 0C 00 10 00 01 00 00 00 02 01 00 FF|v=DKIM1|5C 3B| p="; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:dns; reference:url,www.fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; sid:56593; rev:1; )
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:"MALWARE-CNC MultiOS.Malware.GORAT command and control SSL certificate"; flow:to_client,established; ssl_state:server_hello; content:"|16 03 03|",depth 3; content:"ACME Shell Co.0"; content:"Z",distance 0; content:"ACME Shell Co.0",distance 0; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; reference:url,fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; sid:56864; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"MALWARE-CNC Win.Trojan.BasicPipeShell variant communication attempt"; flow:to_server,established; content:"|FE|SMB",depth 4,offset 4; content:"|0B 00|",within 2,distance 8; content:"|70 00 69 00 70 00 65 00 73 00 68 00 65 00 6C 00 6C 00 2D 00 70 00 69 00 70 00 65 00 6E 00 61 00 6D 00 65 00|"; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ssn; reference:url,www.fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; sid:56891; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:"MALWARE-CNC Win.Trojan.BasicPipeShell variant communication attempt"; flow:to_server,established; content:"|FE|SMB",depth 4,offset 4; content:"|05 00|",within 2,distance 8; content:"|70 00 69 00 70 00 65 00 73 00 68 00 65 00 6C 00 6C 00 2D 00 70 00 69 00 70 00 65 00 6E 00 61 00 6D 00 65 00|"; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ssn; reference:url,www.fireeye.com/blog/threat-research/2020/12/unauthorized-access-of-fireeye-red-team-tools.html; classtype:trojan-activity; sid:56892; rev:1; )
alert tcp $EXTERNAL_NET [389,1389] -> $HOME_NET any ( msg:"INDICATOR-COMPROMISE JNDI LDAP searchResEntry dynamic code download attempt"; flow:to_client,established; content:"javaClassName",fast_pattern,nocase; content:"javaCodeBase"; content:"objectClass"; content:"javaFactory"; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ldap; reference:cve,2021-4104; reference:cve,2021-44228; reference:cve,2021-44832; reference:cve,2021-45046; reference:cve,2021-45105; reference:url,blog.talosintelligence.com/2021/12/apache-log4j-rce-vulnerability.html; classtype:trojan-activity; sid:58801; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 ( msg:"OS-WINDOWS Microsoft Windows Server 2003 smart card authentication buffer overflow attempt"; flow:to_server,established; content:"|03 00|"; content:"|02 F0|",distance 0; content:"|64|",distance 0; content:"|72 44 43 49|"; byte_extract:4,12,msg_size,relative,little; content:"|DC 90 01 08|",within msg_size,fast_pattern; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:rdp; reference:cve,2017-0176; reference:cve,2017-9073; reference:url,www.securitytracker.com/id/1038264; classtype:attempted-admin; sid:59502; rev:1; )
alert ssl ( msg:"SERVER-OTHER OpenSSL x509 crafted email address buffer overflow attempt"; flow:established; content:"|06 03 55 1D 1E|"; ber_skip:0x01,optional; ber_data:0x04; ber_data:0x30; ber_data:0xa1; ber_data:0x30; content:"|81 82|",within 2; byte_test:2,>,500,0,relative; content:"xn--",within 4,distance 2,fast_pattern; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:cve,2022-3602; reference:cve,2022-3786; reference:url,blog.talosintelligence.com/openssl-vulnerability/; classtype:attempted-user; gid:1; sid:300306; rev:3; )
alert ssl ( msg:"SERVER-OTHER OpenSSL x509 crafted email address buffer overflow attempt"; flow:established; content:"|06 03 55 1D 1E|"; ber_skip:0x01,optional; ber_data:0x04; ber_data:0x30; ber_data:0xa0; ber_data:0x30; content:"|81 82|",within 2; byte_test:2,>,500,0,relative; content:"xn--",within 4,distance 2,fast_pattern; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; reference:cve,2022-3602; reference:cve,2022-3786; reference:url,blog.talosintelligence.com/openssl-vulnerability/; classtype:attempted-user; gid:1; sid:300307; rev:3; )

alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"icmp alert HOME_NET"; sid:1000001; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"tcp alert HOME_NET"; sid:1000002; rev:1;)
alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"udp alert HOME_NET"; sid:1000003; rev:1;)
